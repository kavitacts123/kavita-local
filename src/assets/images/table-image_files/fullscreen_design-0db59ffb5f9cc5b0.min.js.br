"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="4452aa52-0f65-5656-86bd-6905d0a6e027")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[1085],{444576:(e,t,n)=>{n.d(t,{A7:()=>i,i4:()=>l,nt:()=>r});var a=n(302245),o=n(333370);let r=e=>e.library.localStyleSelection,l=(0,a.Mz)([r,(e,t)=>t],(e,t)=>e?.type===t?e:null),i=(0,a.Mz)([l,(e,t,n)=>n],(e,t)=>{if(!e)return null;let n=new Set,a=new Set;return e.folderNames.forEach(e=>{let r=t.find(t=>"STYLE_FOLDER"===t.type&&t.name===e);r&&((0,o.KU)(r).forEach(e=>{n.add(e.name)}),(0,o.dm)(r).forEach(e=>{a.add(e.node_id)}))}),{type:e.type,folderNames:n,styleIds:a}})},860260:(e,t,n)=>{let a;n.r(t),n.d(t,{DesignView:()=>pS});var o=n(411855),r=n(188507),l=n(786013),i=n(299321),s=n(966712),c=n(192437),d=n(392592),p=n(161160),m=n(818194),u=n(463033),E=n(181912),y=n(374626),_=n(939863),g=n(256975),h=n(21584),v=n(88918),f=n(349410),S=n(101505),b=n(251960),T=n(456104),N=n(594524),I=n(683694),P=n(723239),C=n(29680),A=n(100197),k=n(397065),w=n(916108),O=n(147829),x=n(147723),D=n(340514),R=n(463546);function M(){let e=(0,f.Ps)(),t=(0,v.w_)(),n=(0,A.J2)(i.Ez5.currentSceneState().nodesWithStatusForFile).filter(e=>e.status===i.zIx.BUILD&&(0,E.A)(e.updatedAt).isAfter((0,E.A)().subtract(60,"day"))),a=(0,y.md)(I.LZ),r=(0,C.aV)(),l=(0,g._I)(),s=(0,g.U4)(),c=(0,y.md)(P.NT),d=(0,h.J)(),{show:p,complete:M,isShowing:L,uniqueId:V}=(0,T.e)({overlay:R.koo,priority:k.N.DEFAULT_MODAL,experiment:{check:e,predicate:e=>e,postCheck:()=>!0}},[c]),K=(0,N.A)({numSteps:2,onComplete:M});return(0,o.useEffect)(()=>{p({canShow:e=>"developer"===e&&d&&a&&!l&&!t&&n.length>0&&s&&!r})},[p,l,s,a,r,c,d,t,n]),(0,b.E)(V,"Enter Inspect Mode",()=>{L&&M()}),o.createElement(w.U,{isShowing:L,currentStep:K.currentStep},o.createElement(O.M,{testId:"rfd-upsell-upsell",isShowing:L},o.createElement(u.$n,{onClick:K.next},(0,_.tx)("general.next"))),o.createElement(D.rq,{testId:"rfd-upsell-callout",isShowing:L,targetKey:x.o5,title:(0,_.tx)("dev_mode.onboarding_callout.find_what_you_need_in_dev_mode"),description:(0,_.tx)("dev_mode.onboarding_callout.find_what_you_need_in_dev_mode"),onClose:M,trackingContextName:"Dev Mode Onboarding Tooltip",primaryCta:{label:(0,_.tx)("general.done"),onClick:M,ctaTrackingDescriptor:S.c.DONE,type:"button"},secondaryCta:{label:(0,_.tx)("dev_mode.onboarding_callout.read_the_guide"),type:"link",href:m.z,ctaTrackingDescriptor:S.c.LEARN_MORE}}))}var L=n(964881),V=n(632430),K=n(285381),F=n(843495),U=n(441088),B=n(737499),G=n(830646);function z(e){let t=e.search(/</),n=e.search(/>/);return e.substring(t,n+1)}var Y=n(698993),W=n(170960),H=n(338400),$=n(680760),X=n(402609),Q=n(720750),J=n(293017),q=n(931828),j=n(226055),Z=n(696673),ee=n(335682),et=n(309798),en=n(833629),ea=n(740280),eo=n(864114),er=n(756159),el=n(455263);function ei(){let e=(0,j.GS)(),{isShowing:t,complete:n,show:a}=(0,T.e)({overlay:R.N5c,priority:k.N.SECONDARY_MODAL}),l=(0,r.wA)(),s=(0,C.aV)(),c=!!(0,et.f)("ui_kits_intro_tooltip"),d=!!(0,et.f)("seen_explore_ui_kits_blue_tooltip"),{hasAnyUiKit:p}=(0,Z.I7)(),m=(0,y.md)(er.Cl),u=(0,en.jO)(),E=(0,el.t)(),g=ee.q5()?.canEdit,h=(0,r.d4)(e=>e.leftPanel.activeTab===i.xae.LAYERS);return(o.useEffect(()=>{!g||!p||m||c||d||!u||s||E||!h||t||a()},[a,g,p,c,d,u,s,E,t,m,h]),o.useEffect(()=>{!h&&t&&n()},[h,t,n]),t)?o.createElement(ea.X,{isShowing:t,title:(0,_.tx)("rcs.ui_kits.jump_start_your_designs_with_ui_kits"),description:(0,_.tx)("rcs.ui_kits.grab_pre_built_ui",{strongAssets:o.createElement("strong",{style:{display:"contents"}},(0,_.tx)("design_systems.assets_panel.assets"))}),primaryCta:{label:(0,_.tx)("rcs.presets_baseline.try_it"),type:"button",onClick:()=>{l(J.FP({tab:i.xae.ASSETS})),n()},ctaTrackingDescriptor:S.c.PRESETS_TRY_IT},position:e?eo.Q.UI3_EDITOR_TOP_LEFT:eo.Q.EDITOR_TOP_LEFT,trackingContextName:"UI Kits Intro Tooltip",userFlagOnShow:"ui_kits_intro_tooltip",onClose:()=>{l(q.b({seen_explore_ui_kits_blue_tooltip:!0})),n()}}):null}var es=n(129318),ec=n(582947),ed=n(106757),ep=n(860178),em=n(788256),eu=n(601538),eE=n(776250),ey=n(646240),e_=n(752553),eg=n(864089),eh=n(799569),ev=n(135876),ef=n(47506),eS=n(340159),eb=n(672517),eT=n(777078),eN=n(373119),eI=n(106112),eP=n(239177),eC=n(666456);let eA="starting_points_templates_modal--templateOption--qYXkm",ek="starting_points_templates_modal--templateOptionTitle--DmVPR",ew="starting_points_templates_modal--verticalTemplateImage--kAzQz";var eO=n(630834),ex=(e=>(e.DESKTOP="desktop",e.MOBILE="mobile",e.WEBSITE="website",e))(ex||{});let eD={x:0,y:0},eR={website:{x:0,y:1600},mobile:{x:0,y:300},desktop:{x:0,y:300}},eM={website:.1,mobile:.225,desktop:.1},eL=e=>{let t=(0,s.Ay)().starting_points;switch(e){case"basics":return t?.figma_basics_hub_file_id;case"desktop":return t?.desktop_templates_hub_file_id;case"mobile":return t?.mobile_templates_hub_file_id;case"website":return t?.website_templates_hub_file_id}};function eV({onClose:e}){let t=(0,r.wA)(),[n,a]=o.useState(!1),[l,c]=o.useState(!1),d=(0,eN.q)(),p=(0,ee.tS)(),m=(0,r.d4)(e=>e.fileVersion),u=(0,r.d4)(e=>e.mirror.sceneGraph),E=d&&(0,em.Qf)(u),g=!!E&&0===E.childrenGuids.length,[h]=(0,e_.IT)((0,eS.tH)({})),v=!!(0,s.kc)().starting_points_ghost_previews,{insertTemplate:f}=(0,eT.Fz)(),b=(0,eP.g)(),T=(0,ey.Xr)(eC.Yq),N=(0,ey.Xr)(eC.bj),[I,P]=o.useState(!1),C=o.useCallback(()=>{if(!v||"loaded"!==h.status||!h.data)return;let e=[];for(let t of Object.values(ex)){let n=eL(t);if(!n)return;let a=h.data[n];if(!a)return;let o={type:eI.n.HubFile,template:a};e.push(o)}Promise.all(e.map(e=>y.zl.get((0,eC.Re)({fileKey:p,fileVersion:m,template:e})))).then(()=>{P(!0)}).catch(e=>{console.error("Failed to load template buffers",e),P(!0)})},[p,m,h,v]);if(o.useEffect(()=>{"loaded"!==h.status||I||C()},[h,I,C]),o.useEffect(()=>{d&&E&&!g&&!l&&e()},[d,E,g,l,e]),!(0,s.kc)().starting_points_modal)return null;let A=async n=>{if("loaded"!==h.status)return;a(!0);let o=eL(n);if(!o)return;let r=h.data[o];r&&(v&&"basics"!==n?await (0,eT.Zg)({insert:()=>N({selectTemplateAfterCommit:!1,moveViewportAfterCommit:!1,priority:"user-visible",editScopeType:i.zkO.USER}),template:{template:r,type:eI.n.HubFile},fileKey:p,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1}):await f({template:{template:r,type:eI.n.HubFile},userTriggered:!1,editScopeType:i.zkO.ONBOARDING,triggeredFrom:"starting-points",templateInsertionDirection:i.hKj.RIGHT}),"basics"===n?(0,ef.YQ)({id:"starting_points_basics_template_inserted"}):(0,ef.YQ)({id:"starting_points_template_inserted"}),e(),a(!1))},k=o.createElement(eb.$z,{onClick:()=>A("basics"),trackingProperties:{trackingDescriptor:S.c.LEARN_THE_BASICS}},(0,_.tx)("starting_points.learn_the_basics")),w=e=>{if((0,eE.sx)("Starting Points Template Option Hover",{template:e}),!v)return;let n=eL(e);if(!n||!h.data)return;let a=h.data[n];if(!a)return;let o={type:eI.n.HubFile,template:a},r=eM[e];window.innerWidth>1700&&(r*=1.5),(0,eT.Zg)({insert:()=>b(o,{moveViewportAfterPreview:!0,priority:"user-visible",previewManager:{nodeType:i.Z6A.CANVAS},position:eD,viewportOptions:{position:eR[e],scale:r,duration:0}}),template:o,fileKey:p,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1,isPreview:!0})},O=()=>{v&&T()};return o.createElement(eb.fu,{name:"Starting Points Modal"},o.createElement("div",{className:"starting_points_templates_modal--startingPointsTemplatesModalPositioner--R8g3u"},o.createElement(ev.x,{isLoading:n,className:"starting_points_templates_modal--loadingSpinner--UOrjg"},()=>o.createElement("div",{className:"starting_points_templates_modal--startingPointsTemplatesModal--dUQte",onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1)},o.createElement("div",{className:"starting_points_templates_modal--modalInstructions--ZtdTL"},o.createElement("div",{className:"starting_points_templates_modal--modalTitle--HT3eZ"},(0,_.t)("starting_points.what_do_you_want_to_make_today")),o.createElement("div",{className:"starting_points_templates_modal--modalLearnMore--g-GWo"},(0,_.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:k}))),o.createElement("div",{className:"starting_points_templates_modal--optionContainer--mYEsG"},o.createElement(eb.$z,{className:eA,onClick:()=>A("website"),onMouseEnter:()=>w("website"),onMouseLeave:O,trackingProperties:{trackingDescriptor:S.c.WEBSITE_TEMPLATES}},o.createElement("div",{className:ek},(0,_.t)("starting_points.website")),o.createElement(eg.oW,{className:ew,src:"https://static.figma.com/uploads/9b8475fdab7c1ed3cd1c0d16b957d65a80840b74",alt:"Website template"})),o.createElement(eb.$z,{className:eA,onClick:()=>A("mobile"),onMouseEnter:()=>w("mobile"),onMouseLeave:O,trackingProperties:{trackingDescriptor:S.c.MOBILE_APP_TEMPLATES}},o.createElement("div",{className:ek},(0,_.t)("starting_points.mobile_app")),o.createElement(eg.oW,{className:ew,src:"https://static.figma.com/uploads/b262e57bed515b9f0da45ae54fa43824d9704c14",alt:"Mobile app template"})),o.createElement(eb.$z,{className:eA,onClick:()=>A("desktop"),onMouseEnter:()=>w("desktop"),onMouseLeave:O,trackingProperties:{trackingDescriptor:S.c.DESKTOP_APP_TEMPLATES}},o.createElement("div",{className:ek},(0,_.t)("starting_points.desktop_app")),o.createElement(eg.oW,{className:"starting_points_templates_modal--desktopTemplateImage--3kplg",src:"https://static.figma.com/uploads/cb2f715253dacb4e7d3fb211ff2792fc28a38832",alt:"Desktop app template"}))),o.createElement("div",{className:"starting_points_templates_modal--modalLearnMoreFooter--pSvfX"},(0,_.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:k})),o.createElement(eh.Jn,{className:"starting_points_templates_modal--closeButton--io-14",onClick:e,innerText:"close",svg:eO.default})))))}let eK=(0,ec.r1)("dismissed_starting_points_templates_modal");function eF(){let e=(0,r.wA)(),t=!!(0,s.kc)().starting_points_modal,n=(0,f.GM)(),a=(0,es.QL)(eu.E_.key)===eu.E_.value,l=(0,C.aV)(),i=(0,r.d4)(e=>e.mirror.sceneGraph),c=!em.Qf(i)?.childrenNodes?.length,d=(0,ee.q5)(),p=(0,ep.TA)(),m=d?.creatorId===p,u=(0,y.md)(P.Fy),E=(0,y.md)(ed.UQ),_=!(0,et.f)("not_gen_0"),g=(0,j.GS)(),h=(0,y.md)(eK),v=(0,s.Ay)().starting_points,{show:S,isShowing:b,complete:N}=(0,T.e)({overlay:R.EYw,priority:k.N.OVERRIDING_MODAL+1,experiment:{check:n,predicate:e=>e,postCheck:(e,t)=>!t}},[u,h]);return(o.useEffect(()=>{t&&m&&!l&&c&&!b&&(a?S():_&&E&&g&&v&&S({canShow:e=>!e}))},[t,m,l,c,b,a,_,E,g,v,S]),b)?o.createElement(eV,{onClose:()=>{h.data||e(q.b({dismissed_starting_points_templates_modal:!0})),N()}}):null}var eU=n(904669),eB=n(394828),eG=n(152202),ez=n(699857),eY=n(433195);let eW=(0,ec.r1)(eY.WX),eH=(0,ec.r1)(eY.b6),e$=!1;function eX(){let e=(0,r.wA)(),t=(0,y.md)(I.wg),n=(0,C.aV)(),a=(0,y.md)(P.mp),l=(0,g._I)(),i=(0,j.GS)(),s=(0,y.md)(eH),c=(0,y.md)(eW),{uniqueId:d,show:p,complete:m,isShowing:u}=(0,T.e)({overlay:R.kc4,priority:k.N.SECONDARY_MODAL},[c,s,a]),E=(0,ez.U)("modal"),h=o.useCallback(()=>{!n&&!e$&&t&&l&&(0!==(eU.q.instance.getCurrentPage()?.childrenGuids.length||0)&&p({canShow:(e,t,n)=>!e&&!t&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),e$=!0)},[p,l,t,n]);function v(){e(q.b({[eY.WX]:!0})),m()}o.useEffect(()=>{i||h()},[h,i]),(0,b.E)(d,(0,eG.w)("design"),()=>{h()}),o.useEffect(()=>{"loaded"===c.status&&c.data&&m()},[c,m]),(0,b.E)(d,"Enter Inspect Mode",()=>{u&&v()});let f=(0,j.GS)()?eu.ON:eu.JN;return o.createElement(D.rq,{isShowing:u,trackingContextName:eY.WX,onClose:v,targetKey:f,title:(0,_.tx)("dev_handoff.annotations_introduction_overlay.title"),media:o.createElement(eB.y,{src:"https://static.figma.com/uploads/5b9addc96424c11577a1ec91e1bbadcd786fe343",alt:(0,_.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,_.tx)("dev_handoff.annotations_introduction_overlay.description"),primaryCta:{label:(0,_.tx)("dev_handoff.annotations_introduction_overlay.primary_cta"),type:"button",onClick:function(){E("handoff")},ctaTrackingDescriptor:S.c.SHOW_ME}})}var eQ=n(502665);let eJ=(0,ec.r1)(eY.b6),eq=(0,ec.r1)(eY.WX),ej=!1,eZ=!1;function e0(){let e=(0,r.wA)(),t=(0,C.aV)(),n=(0,y.md)(P.mp),a=(0,y.md)(eQ.N),l=(0,A.J2)(i.Ez5.annotationObserver().annotationInfoByTlf),s=y.md(ee.yV)?.creatorId,c=(0,y.md)(eJ),d=(0,y.md)(eq),{uniqueId:p,show:m,complete:u,isShowing:E}=(0,T.e)({overlay:R.kc4,priority:k.N.SECONDARY_MODAL},[c,d,n,a]),g=(0,ez.U)("modal"),h=l.size>0;function v(){e(q.b({[eY.b6]:!0})),u()}o.useEffect(()=>{t&&(eZ=!0),!t&&!ej&&eZ&&h&&(m({canShow:(e,t,n,a)=>!e&&!t&&s!==a&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),ej=!0)},[h,t,s,m]),o.useEffect(()=>{"loaded"===c.status&&c.data&&u()},[c,u]),(0,b.E)(p,"Enter Inspect Mode",()=>{E&&v()});let f=(0,j.GS)()?eu.ON:eu.JN;return o.createElement(D.rq,{isShowing:E,trackingContextName:eY.b6,onClose:v,targetKey:f,title:(0,_.tx)("dev_handoff.annotations_upsell_overlay.title"),media:o.createElement(eB.y,{src:"https://static.figma.com/uploads/e84a2faeb510847abd7bfb9c15a74ef974bb4c13",alt:(0,_.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,_.tx)("dev_handoff.annotations_upsell_overlay.description"),primaryCta:{label:(0,_.tx)("dev_handoff.annotations_upsell_overlay.primary_cta"),type:"button",onClick:function(){g("handoff")},ctaTrackingDescriptor:S.c.OPEN_DEV_MODE},secondaryCta:{label:(0,_.tx)("dev_handoff.annotations_upsell_overlay.secondary_cta"),type:"button",onClick:u,ctaTrackingDescriptor:S.c.NOT_NOW}})}var e1=n(152811),e2=n(363668),e8=n(622901),e4=n(344076),e3=n(54900),e5=n(582828),e7=n(199465);function e6({children:e}){return o.createElement(e7.G.Provider,{value:{loggerEventName:"design_navigate"}},e)}var e9=n(30637),te=n(138369),tt=n(125708),tn=n(809831),ta=n(818),to=n(617453),tr=n(213190),tl=n(336599),ti=n(428467),ts=n(939562),tc=n(239671),td=n(7860),tp=n(716622),tm=n(697551),tu=n(914905),tE=n(759096),ty=n(270296),t_=n(7674),tg=n(69814),th=n(776621),tv=n(316081),tf=n(215122),tS=n(331596),tb=n(848661),tT=n(618056),tN=n(279145),tI=n(291251),tP=n(67151),tC=n(424587),tA=n(388393),tk=n(275556),tw=n(297666),tO=n(358145),tx=n(886653),tD=n(153234),tR=n(437304),tM=n(286640),tL=n(763658),tV=n(738269),tK=n(395281),tF=n(452246),tU=n(906899),tB=n(798099),tG=n(356390),tz=n(416095),tY=n(237929),tW=n(444576),tH=n(945020),t$=n(173454),tX=n(922358),tQ=n(602029),tJ=n(7959),tq=n(109388),tj=n(463420),tZ=n(96796),t0=n(932345),t1=n(46481),t2=n(498606),t8=n(629019),t4=n.n(t8),t3=n(498750),t5=n(255942),t7=n(837746);let t6="styles--contextMenu--C-hVT",t9="styles--showOnRowHover--OUqRT",ne="styles--showOnSelectedRowHover--Lcf7e styles--showOnRowHover--OUqRT",nt="styles--caret--DZmzh",nn="styles--rowSelectedExpanded--MGvUV",na="styles--rowSelectedSecondaryLightBlue--S-zy- draggable_list--rowSelectedSecondary--yOI1g raw_components--rowSelectedSecondary---U7Us raw_components--rowSelected--M2Eip";function no({childLeft:e,childRight:t,deleteSelectedItems:n,forceShowHoverBorder:a,hideStylePreview:r,index:l,inspectStyleSelected:i,isDragging:s,isEditable:c,isRenaming:d,isCollapsed:p=!0,isLastChildOfSelection:m=!1,isFirstChildOfSelection:u=!1,isFolder:E,level:y,name:_,nameRef:g,onChildLeftClick:h,onContextMenu:v,onCreateFolder:f,onDoubleClick:S,onHoverChange:b,onMouseDown:T,onMouseMove:N,recordingKey:I,rowRef:P,secondaryName:C,selected:A,selectedSecondary:k,stopRenamingItem:w,tooltipData:O}){let x=o.useRef(null),[D,R]=o.useState(_),[M,L]=o.useState(!1),V=(0,j.GS)(),K=o.useCallback(e=>{if(e){let t=tq.findDOMNode(e);t&&t.select()}},[]);o.useEffect(()=>{R(_)},[_]);let F=o.useCallback(e=>{""===e.trim()?(w(l,_),R(_)):w(l,e)},[l,_,w]),U=(0,tD.AF)((0,tD.Pt)(I,"text-input"),"change",o.useCallback(e=>{R(e.currentTarget.value)},[R])),B=(0,tD.v_)((0,tD.Pt)(I,"text-input"),"keydown",e=>{e.keyCode===t3.Uz.ESCAPE?(w(l,_),R(_)):e.keyCode===t3.Uz.ENTER&&F(e.currentTarget.value)},{recordMetadata:e=>({inputValue:e.currentTarget.value}),playbackMetadata:e=>({currentTarget:{value:e.inputValue}})}),G=(0,tD.v_)(I,"keydown",e=>{c&&!d&&(e.keyCode===t3.Uz.BACKSPACE||e.keyCode===t3.Uz.DELETE)?n():c&&!d&&e.keyCode===t3.Uz.G&&(0,t3.Fo)(e)?(f(),e.preventDefault()):!d&&e.nativeEvent&&tG.Y5.forwardKeyboardEvent(e.nativeEvent)}),z=o.useCallback(()=>{F(D)},[F,D]),Y=(0,tD.rf)(I,"contextmenu",e=>{v(e)}),W=(0,tD.rf)(I,"mousemove",e=>{N(e)},{recordMetadata:e=>({bounds:e.currentTarget.getBoundingClientRect(),pageX:e.pageX,pageY:e.pageY}),playbackMetadata:e=>({currentTarget:{getBoundingClientRect:()=>e.bounds},pageX:e.pageX,pageY:e.pageY})}),H=(0,tD.rf)(I,"mousedown",e=>{T(e),r()}),$=(0,tD.rf)(I,"mouseenter",o.useCallback(()=>{L(!0),b?.(!0)},[L,b])),X=o.useCallback(()=>{L(!1),b?.(!1)},[L,b]),Q=(0,tD.rf)(I,"dblclick",o.useCallback(e=>{S(e)},[S])),J=Math.min((y-1)*3,18),q=t7.jNX-4-J,Z=q-(V?7:5),ee=M&&!d||i?Z:q,et=A||k,en=t4()({[nn]:!p&&et,"styles--folderSecondarySelected--SL0JY":k||A&&!u,[na]:k&&!V}),ea=t4()({[na]:et,[nn]:!m&&et}),eo=t4()("styles--rowWithBorder--bphZ-",{[en]:E,[ea]:!E,"styles--rowWithHover--RWNMH":!et&&(a||M&&!s)}),er=o.createElement("div",{className:d?"styles--rowContentsRenaming--oDTtO styles--rowContents--37JBy":"styles--rowContents--37JBy",key:_,style:V?{width:"100%"}:{gridColumnEnd:`span ${ee}`}},d?o.createElement(tJ.ks,{autoCapitalize:"off",autoCorrect:"off",autoFocus:!0,className:"styles--input--LbjR0",onBlur:z,onChange:U,onKeyDown:B,ref:K,spellCheck:!1,value:D}):o.createElement(o.Fragment,null,o.createElement("div",{className:"styles--name--KWZ8d ellipsis--ellipsis--Tjyfa",ref:g,...O},_),C&&o.createElement("div",{className:"styles--textStyle--DiUv4"},C)));return o.createElement(tQ.e,{className:eo,dragging:s,hideGrabber:!0,onContextMenu:Y,onKeyDown:G,onMouseDown:H,onMouseEnter:$,onMouseLeave:X,onMouseMove:W,onDoubleClick:Q,ref:(0,t5.A)(x,P),selected:A,selectedSecondary:!1,tabIndex:0},J>0&&o.createElement("span",{style:{gridColumnEnd:`span ${J}`}}),o.createElement("div",{className:"styles--childLeftContainer--Hu61K",style:V?{gridColumnEnd:`span ${ee}`}:void 0},o.createElement("div",{onMouseDown:h&&tB.dG,onClick:h},e),V&&er),!V&&er,t)}var nr=n(949207),nl=n(432023),ni=n(501191),ns=n(660164);function nc({deleteSelectedItems:e,folder:t,folderNameToNestUnder:n,hideStylePreview:a,index:l,isCollapsed:i,isDragging:s,isEditable:c,isRenaming:d,isTemporarilyExpanded:p,isFirstChildOfSelection:m,level:u,onContextMenu:E,onCreateFolder:y,onMouseDown:g,onMouseMove:h,onRenameItem:v,recordingKey:f,selected:S,selectedSecondary:b,stopRenamingItem:T,temporarilyExpandFolder:N,toggleFolder:I}){let P=(0,r.wA)(),[C,A]=o.useState(!1),k=o.useRef(null),w=C&&!d&&c;o.useEffect(()=>{if(C&&s&&i){let e=setTimeout(()=>{N(t.name)},1e3);return()=>clearTimeout(e)}},[C,s,i,N,t]);let O=o.useCallback(()=>{let e=(0,t0.Zk)(t.styleTypeSection),n=k.current?.getBoundingClientRect();e&&n&&P(tU.Zs({rowLeft:n.left,rowTop:n.top,styleType:t.styleTypeSection,styleNameInputPrefix:`${t.name}/`,inheritStyleKeyField:e}))},[k,t.name,t.styleTypeSection,P]);return o.createElement(no,{deleteSelectedItems:e,forceShowHoverBorder:n===t.name,hideStylePreview:a,index:l,isDragging:s,isEditable:c,isRenaming:d,isCollapsed:i,isFolder:!0,isFirstChildOfSelection:m,level:u,name:(0,tY.kH)(t.name),onChildLeftClick:function(){I(!i)},onContextMenu:E,onCreateFolder:y,onDoubleClick:function(){t.styleTypeSection&&v(t.name,!1,t.styleTypeSection)},onHoverChange:A,onMouseDown:g,onMouseMove:h,onRenameItem:v,recordingKey:f,selected:S,selectedSecondary:b,stopRenamingItem:T,rowRef:e=>{e&&(k.current=tq.findDOMNode(e))},childLeft:o.createElement(t1.U,{svg:i&&!p?nl.A:nr.A,className:nt},i&&!p?o.createElement(tj.k,{className:nt}):o.createElement(tZ.O,{className:nt})),childRight:w&&o.createElement(tJ.$4,null,o.createElement(tJ.K0,{className:S?ne:t9,recordingKey:tD.Pt(f,"addButton"),"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("design_systems.styles.tooltips.create"),svg:ni.A,fallbackSvg:ns.A,onClick:O}))})}var nd=n(221768),np=n(91408),nm=n(378905),nu=n(44892),nE=n(227795),ny=n(137906),n_=n(720384),ng=n(162502);function nh({deleteSelectedItems:e,hideStylePreview:t,index:n,isDragging:a,isEditable:l,isRenaming:i,isLastChildOfSelection:s,level:c,onContextMenu:d,onCreateFolder:p,onInspectStyle:m,onMouseDown:u,onMouseMove:E,onRenameItem:y,recordingKey:g,selected:h,selectedSecondary:v,stopRenamingItem:f,dsStyle:S,stylePreviewShown:b,updateContextMenuStyleRef:T,updateSelection:N,updateFocusRowRef:I}){let[P,C]=o.useState(!1),A=(0,r.wA)(),k=o.useRef(null),w=o.useRef(null),O=o.useCallback(()=>{l&&y(S.node_id,!0,S.style_type)},[y,S.node_id,S.style_type,l]),x=b.isShown&&!b.isCreating&&b.style.node_id===S.node_id&&(0,nm.EF)(b.style,S),D=P&&!i||x,R=o.useCallback(function(){let e=w.current;if(e){let t=e.getBoundingClientRect();x?A(tU.sw()):(A(tU.rk({style:S,rowTop:t.top,rowLeft:t.left})),m(S),N({type:S.style_type,folderNames:new Set,styleIds:new Set(S.node_id)}))}A(J.XE())},[A,m,N,S,x]),M=o.useCallback(e=>{(2===e.button||e.ctrlKey)&&T(w.current),u(e),x&&R()},[R,u,x,T]),L=k.current,V=!!L&&L.offsetWidth<L.scrollWidth,K=o.useMemo(()=>!a&&S.description&&V?{"data-tooltip-type":t2.Ib.SPECIAL,"data-tooltip":n_.Z,"data-tooltip-style-name":(0,tY.kH)(S.name),"data-tooltip-style-description":S.description,"data-tooltip-max-width":t7.jNX*(0,np.hG)(t7.dGl)}:null,[V,a,S.name,S.description]),F="TEXT"===S.style_type&&S.meta?.style_thumbnail?S.meta.style_thumbnail:null;return o.createElement(no,{deleteSelectedItems:e,hideStylePreview:t,index:n,inspectStyleSelected:x,isDragging:a,isEditable:l,isRenaming:i,isFolder:!1,isLastChildOfSelection:s,level:c,name:(0,tY.kH)(S.name),nameRef:k,onContextMenu:d,onCreateFolder:p,onDoubleClick:O,onHoverChange:C,onMouseDown:M,onMouseMove:E,onRenameItem:y,recordingKey:g,rowRef:e=>{if(e){let t=tq.findDOMNode(e);I&&I(t),w.current=t}},secondaryName:F&&(0,nu.P$)(F),selected:h,selectedSecondary:v,stopRenamingItem:f,tooltipData:K,childLeft:o.createElement(o.Fragment,null,o.createElement(ny.zi,{dsStyle:S,disableTooltip:!0}),h&&"FILL"===S.style_type&&o.createElement("div",{className:"styles--selectedRing--UniEc"})),childRight:D&&o.createElement(tJ.$4,null,o.createElement("div",{style:{gridColumnEnd:"span 1"}}),o.createElement(nE.YW,{className:h?ne:t9,recordingKey:tD.Pt(g,"customButton"),"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":l?(0,_.t)("design_systems.styles.edit_style"):(0,_.t)("design_systems.styles.view_style"),selected:x,onMouseDown:tB.dG,onClick:R},o.createElement(t1.U,{svg:ng.A},o.createElement(nd.A,null))))})}var nv=n(522739);function nf({styleType:e,children:t}){let n=!(0,C.p8)("isReadOnly");return o.createElement("div",{className:"styles--styleTypeSection--jPjTq component_tiles--section--qMua7"},n?o.createElement(nS,{styleType:e,recordingKey:`style-section-header-${e}`}):o.createElement("div",{className:"styles--styleTypeSectionHeader--224lA component_tiles--sectionHeader--eEC6d raw_components--panelTitle--VAQQA"},(0,tz.QT)(e)),t)}function nS({styleType:e,recordingKey:t}){let[n,a]=o.useState(!1),l=(0,r.wA)(),i=o.useRef(null),s=o.useCallback(()=>{let t=(0,t0.Zk)(e),n=i.current?.getBoundingClientRect();t&&n&&l(tU.Zs({rowLeft:n.left,rowTop:n.top,styleType:e,inheritStyleKeyField:t}))},[i,e,l]);return o.createElement(nv.D8,{className:"styles--styleTypeSectionRow--wVTIO",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),recordingKey:t,forwardedRef:i},o.createElement(tJ.JU,{className:"styles--styleTypeSectionRowLabel--PrKm-"},(0,tz.QT)(e)),n&&o.createElement(nE.K0,{className:"styles--styleTypeSectionRowButton--V4Co2 styles--showOnRowHover--OUqRT",recordingKey:tD.Pt(t,"addButton"),"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("design_systems.styles.tooltips.create_style_from_section",{kind:(0,tz.XV)(e).toLowerCase()}),svg:ni.A,fallbackSvg:ns.A,onClick:s}))}nf.displayName="StyleTypeSection";var nb=n(268537),nT=n(318812),nN=n(333370);let nI=nb.ms,nP=nb.c$,nC=nb.wv,nA="styles-by-type-context-menu",nk=.75*(0,np.hG)(t7.uj0);function nw({styleRowRef:e,onEditStyle:t,onRenameItem:n,onCreateFolder:a,onDeleteItems:l,onCutItems:i,onPasteItems:s,styleType:c}){let d=(0,nT.Um)(),p=(0,r.d4)(e=>e.library.localStyleSelection),m=o.useMemo(()=>p&&p.type===c&&d?.type===nA?(0,nN.QA)(p,d.data.uiList):[],[p,d,c]),u=o.useMemo(()=>(0,nN.Ug)(m).map(e=>e.node_id),[m]),E=u.length;return d&&u.length?o.createElement(nO,{styleRowRef:e,selectedItems:m,numStyles:E,dropdownShown:d,onEditStyle:t,onRenameItem:n,onCreateFolder:a,onDeleteItems:l,onCutItems:i,onPasteItems:s}):o.createElement("div",null)}function nO({styleRowRef:e,selectedItems:t,numStyles:n,dropdownShown:a,onEditStyle:l,onRenameItem:s,onCreateFolder:c,onDeleteItems:d,onCutItems:p,onPasteItems:m}){let u=(0,r.wA)();o.useEffect(()=>(i.glU.computePastableStyleCount(),()=>{i.glU.clearPastableStyleCount()}),[]);let E=(0,r.d4)(e=>e.mirror.appModel.pastableStyleCount),y=!!ee.q5()?.canEdit,g=o.useCallback(()=>{if(!t.length||t[0].type!==t$.PW.STYLE)return;let n=t[0];if(e){let t=e.getBoundingClientRect();u(tU.rk({style:n,rowTop:t.top,rowLeft:t.left})),u(J.XE())}l(n)},[u,t,l,e]),h=o.useCallback(()=>{if(!t.length||t[0].type===t$.PW.STYLE)return;let e=t[0];s(e.name,!1,e.styleTypeSection)},[s,t]);if(-1===E)return o.createElement("div",null);if(!y)return n>1?o.createElement("div",null):o.createElement(nI,{style:a.data.position,className:t6},o.createElement(nP,{recordingKey:"edit-style-option",onClick:g},(0,_.tx)("design_systems.styles.view_style")));let v=1===n&&(t[0].type===t$.PW.STYLE?o.createElement(nP,{recordingKey:"edit-style-option",onClick:g},(0,_.tx)("design_systems.styles.edit_style")):o.createElement(nP,{recordingKey:"rename-folder-option",onClick:h},(0,_.tx)("design_systems.styles.rename_folder")));return o.createElement(nI,{style:a.data.position,className:t6},o.createElement(nP,{recordingKey:"create-folder-option",onClick:c},(0,_.tx)("design_systems.styles.add_new_folder")),v,o.createElement(nP,{recordingKey:"delete-style-option",onClick:d},(0,_.tx)("design_systems.styles.delete_styles",{numStyles:n})),o.createElement(nC,null),o.createElement(nP,{recordingKey:"cut-style-option",onClick:p},(0,_.tx)("design_systems.styles.cut_styles",{numStyles:n})),!!E&&o.createElement(nP,{recordingKey:"paste-style-option",onClick:m},(0,_.tx)("design_systems.styles.paste_styles",{numStyles:E})))}var nx=n(927457),nD=n(710752),nR=n(582288),nM=n(884909),nL=n(304173),nV=n(405206),nK=n(298543),nF=n(184027),nU=n(608974),nB=n(257812),nG=n(319431),nz=n(914110);let nY="local-style-creation-dropdown";function nW(){let e=(0,r.wA)(),t=(0,o.useContext)(nF.lk),n=!(0,C.p8)("isReadOnly"),a=o.useRef(null),l=o.useRef(null),i=a.current,s=(0,nT.Um)(),c=s?.type===nY,d=s?.data?.targetRect,p="localStyleHeader",m=0===(0,tE.Bs)().length,u=(0,r.d4)(e=>e.stylePreviewShown.isShown&&e.stylePreviewShown.isCreating),E=o.useMemo(()=>d||(c&&i?i.getBoundingClientRect():null),[d,i,c]),y=()=>{e(tV.oB())},g=()=>{e(tV.j7({type:nY}))},h=t=>{t.stopPropagation(),e(tU.YG());let n=a.current;c?y():n&&((0,eE.sx)("editor-local-styles-dropdown-show"),g())},v=e=>{y();let n=(0,t0.Zk)(e),a=l.current?.getBoundingClientRect();n&&a&&t({styleType:e,inheritStyleKeyField:n,rowLeft:a.left,rowTop:a.top})},f=m&&!c&&!u;return o.createElement(tJ.fI,{className:f?"styles--panelHeaderRowFaded--pfgKz styles--panelHeaderRow--Kxqgo styles--styleTypeSectionRow--wVTIO draggable_list--panelHeaderRowFaded--kETRR":"styles--panelHeaderRow--Kxqgo styles--styleTypeSectionRow--wVTIO",forwardedRef:l},o.createElement(tJ.xZ,{className:"styles--panelTitleText--v7gXm draggable_list--panelTitleText--SwKez",onMouseDown:e=>f&&h(e),onClick:e=>e.stopPropagation()},(0,_.tx)("design_systems.styles.local_styles")),n&&o.createElement(o.Fragment,null,o.createElement(tJ.K0,{ref:a,onMouseDown:h,onClick:e=>e.stopPropagation(),className:c?"styles--stylesHeaderButtonHighlight--WTeWy raw_components--iconButtonSelected--bJibL raw_components--_iconButton---ybo6":"styles--stylesHeaderButton--jhpA5 draggable_list--addButton--D0q--","data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("design_systems.create_style.create_style"),recordingKey:tD.Pt(p,"addButton")},o.createElement(t1.U,{svg:ni.A,fallbackSvg:ns.A},o.createElement(nx.e,null))),c&&E&&o.createElement(nK.Cf,{targetRect:E,minWidth:128,disableDropdownScrollContainer:!0,propagateCloseClick:!0},tz.og.map(e=>{let{icon:t,label:n}=function(e){switch(e){case"TEXT":return{icon:o.createElement(t1.U,{svg:nz.A},o.createElement(nD.e,null)),label:(0,_.t)("design_systems.styles.dropdown.text")};case"FILL":return{icon:o.createElement(t1.U,{svg:nB.A},o.createElement(nR.G,null)),label:(0,_.t)("design_systems.styles.dropdown.fill")};case"GRID":return{icon:o.createElement(t1.U,{svg:nG.A},o.createElement(nM.E,null)),label:(0,_.t)("design_systems.styles.dropdown.grid")};case"EFFECT":return{icon:o.createElement(t1.U,{svg:nU.A},o.createElement(nL.n,null)),label:(0,_.t)("design_systems.styles.dropdown.effect")};default:throw(0,tP.j)(e),Error(`Invalid style type: ${e}`)}}(e),a=t=>{t.stopPropagation(),v(e)};return o.createElement(nb.c$,{key:e,className:"styles--createStyleDropdownRow--7iCXQ",onClick:a,onPointerUp:a,recordingKey:tD.Pt(p,`dropdown-option-${e}`)},o.createElement(nV.Nu,null,t),n)}))))}let nH="collapsed-style-folders";function n$({scrollContainer:e,recordingKey:t}){let n=(0,tE.Bs)(),a=(0,C.p8)("isReadOnly");return 0===n.length&&a?null:o.createElement(tL.k,{name:"local_styles_panel"},o.createElement(tJ.Zk,null,o.createElement(nX,{scrollContainer:e,recordingKey:t})))}function nX({scrollContainer:e,recordingKey:t}){let n=(0,r.wA)(),a=(0,r.d4)(e=>e.stylePreviewShown),l=(0,r.d4)(e=>e.mirror.appModel.activeCanvasEditModeType),s=(0,r.d4)(e=>e.mirror.appModel.currentTool),c=o.useRef(null),d=(0,tE.Bs)(),p=(0,r.d4)(e=>e.library.localStyleSelection),[m,u]=o.useState(null),[E,y]=o.useState(null),_=o.useRef(null),[g,h]=o.useState(!1),v=l===i.m1T.GRADIENT||l===i.m1T.RASTER||s===i.NLJ.DROPPER_COLOR;o.useEffect(()=>{let e=()=>{!v&&(n(tK.Bn(null)),a.isShown&&(n(tU.sw()),i.glU.selectStyle(tA.n3.INVALID,tA.IA.INVALID)))},t=(0,tB.ft)();return t?window.addEventListener("pointerdown",e):window.addEventListener("mousedown",e),()=>{t?window.removeEventListener("pointerdown",e):window.removeEventListener("mousedown",e)}},[n,a.isShown,v]);let{stylesByType:f,foldersAndStylesByType:S}=o.useMemo(()=>{let e=(0,tz.Kw)(d),t=new Map;return tz.og.map(n=>{let a=e.get(n);if(a){(0,tz.LX)(a);let e=(0,nN.lM)(a,n),o=(0,nN.l0)(e);t.set(n,o)}}),{stylesByType:e,foldersAndStylesByType:t}},[d]),b=o.useCallback(e=>{(0,tP.KF)(null!=e.content_hash,"style does not have a hash"),i.glU.selectStyleByGuid(e.node_id),n(tK.ay({isRenaming:!1})),(0,eE.sx)("Style Inspected",{styleType:e.style_type,from:"styleListClick"})},[n]),T=o.useCallback((e,t,n)=>{u(t?e:null),y(t?null:{name:e,styleTypeSection:n})},[]),N=o.useCallback(e=>{if(!e){n(tK.Bn(null));return}let t=new Set;e.styleIds.forEach(n=>{let a=d.find(e=>e.type===t$.PW.STYLE&&e.node_id===n);if(!a)return;let o=(0,tY.In)(a.name);e.folderNames.has(o)||t.add(n)});let a={type:e.type,folderNames:e.folderNames,styleIds:t};n(tK.Bn(a))},[n,d]),I=o.useCallback((e,t,n)=>{if(!p)return;let a=e[t],o=(e,t)=>{let a=(0,tY.ke)(e.name),o=null!=t?t:a.length-1;a[o]=n;let r=(0,nN.Pc)(a.join("/"));tk.l7.user("rename-style",()=>i.glU.renameNode(e.node_id,r))};if(a.name!==n){if(a.type===t$.PW.STYLE)o(a);else{(0,nN.mx)(t,e).forEach(t=>{let n=e[t];n.type===t$.PW.STYLE&&o(n,a.level-1)});let r=new Set(p.folderNames);r.delete(a.name);let l=(0,tY.In)(a.name)+"/"+n;r.add(l),N({type:p.type,folderNames:r,styleIds:p.styleIds})}}tG.Y5.triggerAction("commit"),u(null),y(null)},[p,N]),P=o.useCallback((e,t)=>{t.preventDefault(),t.stopPropagation(),n(tV.j7({type:nA,data:{uiList:e,position:{top:t.clientY,left:Math.min(t.clientX,window.innerWidth-nk)}}}))},[n]),C=o.useCallback(e=>{_.current=e},[]),A=o.useCallback(()=>{h(!0)},[]),k=o.useCallback(()=>{h(!1)},[]);return o.createElement("div",{className:"styles--localStylesPanel--T4Gqs",ref:c},o.createElement(nW,null),tz.og.map(n=>{let a=f.get(n);if(!a)return;let r=S.get(n);if(r)return o.createElement(nQ,{key:n,recordingKey:tD.Pt(t,`style-section-${n}`),styleType:n,storedStyleList:a,styleList:r,updateSelection:N,isDragging:g,onDragStart:A,onDragEnd:k,onInspectStyle:b,onContextMenu:P,updateContextMenuStyleRef:C,renamingStyleID:m,renamingFolder:E,onRenameItem:T,stopRenamingItem:I,styleRowRef:_.current,onEditStyle:b,scrollContainer:e})}))}function nQ({styleType:e,storedStyleList:t,styleList:n,renamingStyleID:a,renamingFolder:l,onRenameItem:s,stopRenamingItem:c,onDragStart:d,onDragEnd:p,onInspectStyle:m,onContextMenu:u,updateContextMenuStyleRef:E,updateSelection:y,styleRowRef:g,scrollContainer:h,recordingKey:v}){let f=(0,ee.q5)(),S=!(0,C.p8)("isReadOnly"),b=(0,r.wA)(),T=(0,r.d4)(e=>e.stylePreviewShown),N=(0,j.GS)(),I=(0,r.d4)(t=>(0,tW.i4)(t,e)),P=(0,r.d4)(t=>(0,tW.A7)(t,e,n)),[A,k]=o.useState(()=>{if(tM.x4&&f){let t=JSON.parse(tM.x4.getItem(nH)||"{}");if(f.key in t){let n=t[f.key];if(e in n)return new Set(n[e])}else t[f.key]={},tM.x4.setItem(nH,JSON.stringify(t))}return new Set(n.filter(e=>"STYLE_FOLDER"===e.type).map(e=>e.name))}),[w,O]=o.useState([]),[x,D]=o.useState(null),[R,M]=o.useState(null),L=o.useMemo(()=>(0,tw.s)(()=>{b(tF.GT({styleType:e}))},200),[b,e]);o.useEffect(()=>{L()},[L,n]);let V=(0,tO.ZC)(A);o.useEffect(()=>{if(!V||!tM.x4||!f||(0,tR._f)(V,A))return;let t=JSON.parse(tM.x4.getItem(nH)||"{}"),n=t[f.key];n&&(n[e]=[...A],tM.x4.setItem(nH,JSON.stringify(t)))},[A,f,V,e]);let K=o.useCallback(e=>!!e&&"STYLE_FOLDER"===e.type,[]),F=o.useCallback((e,t)=>{let a=new Set(e),o=[];n.forEach((e,t)=>{if(a.has(e)&&(o.push(t),"STYLE_FOLDER"===e.type)){let e=(0,nN.mx)(t,n);o.push(...e)}});let r=new Set(o),l=t?n.indexOf(t):n.length,i=[...(0,tC.y1)(l).filter(e=>!r.has(e)),...o,...(0,tC.y1)(l,n.length).filter(e=>!r.has(e))],s=new Map;return i.forEach((e,t)=>{e!==t&&s.set(e,t)}),s},[n]),U=o.useCallback(()=>{T.isShown&&(b(tU.sw()),b(J.XE()),i.glU.selectStyle(tA.n3.INVALID,tA.IA.INVALID))},[b,T.isShown]),B=o.useMemo(()=>{if(!x)return null;if("in"===x.type){let e=n[x.index];return e?{folderNameToNestUnder:e.name,dividerStyles:{display:"none"}}:null}if(null==x.index||null==R||!I)return null;let e=(0,nN.QA)(I,n),t=e[0],a=null,o=null;if(0===x.index?o=n[x.index]:x.index===n.length?a=n[x.index-1]:(a=n[x.index-1],o=n[x.index]),a?.type==="STYLE_FOLDER"&&A.has(a.name)&&-1===w.indexOf(a.name))return{folderNameToNestUnder:a.name,dividerStyles:{display:"none"}};if(a?.type===t$.PW.STYLE){let e=(0,tY.In)(a.name).split("/");for(let n=0;n<e.length;n++){let a=e.slice(0,n+1).join("/");if(A.has(a)&&-1===w.indexOf(a)){if("STYLE_FOLDER"!==t.type)return{folderNameToNestUnder:a,dividerStyles:{display:"none"}};return{folderNameToNestUnder:(0,tY.In)(a),dividerStyles:{marginLeft:24*Math.min((0,tY.ke)(a).length,8)-8}}}}}let r=0,l=null,i=a?(0,nN.rM)(a):0,s=o?(0,nN.rM)(o):0;if(i<=s)r=s,l=a?a.type===t$.PW.STYLE?(0,tY.In)(a.name):a.name:"";else if((0,tP.KF)(null!=a,"Dragging after an item that doesn't exist"),t.type===t$.PW.STYLE||R>=.5)r=i,l=(0,tY.In)(a.name);else{let e=Math.floor(R/.5*(0,nN.rM)(a));e=Math.max(s-1,e),l=(0,tY.ke)((0,tY.In)(a.name)).slice(0,e).join("/"),r=e+1}let c={marginLeft:24*Math.min(r,8)-8};return a&&e.includes(a)||!(0,nN.Md)(a,t,o)?{folderNameToNestUnder:null,dividerStyles:c}:{folderNameToNestUnder:l,dividerStyles:c}},[A,R,I,x,n,w]),G=o.useCallback((a,o,r,l)=>{if(!t||!o&&!r||!B)return;let i=B.folderNameToNestUnder;if(null===i)return;let s=[],c=[];a.forEach(e=>{(0,nN.Md)(o,e,r,i)&&("STYLE_FOLDER"===e.type?c.push(e):s.push(e))});let d=s.concat(c);if(!d.length)return;let p=tk.l7.user("reorder-styles",()=>(0,nN.VB)(d,o,r,i,n,t,l||!1)),m=new Set,u=new Set;d.forEach(e=>{let t=(0,nN.t_)(e),n=p?.get(t);n&&("STYLE_FOLDER"===e.type?m.add(n):u.add(t))}),y({type:e,folderNames:m,styleIds:u});let E=new Set;return A.forEach(e=>{if(i.startsWith(e))return;let t=p?.get(e);t?E.add(t):E.add(e)}),k(E),U(),l||tG.Y5.triggerAction("commit"),F(d,r)},[y,A,B,F,U,t,n,e]),z=o.useCallback((e,t)=>{if("STYLE_FOLDER"!==t.type)return;let a=n.indexOf(t),o=(0,nN.dm)(t).filter(e=>(0,tY.In)(e.name)===t.name);if(!o.length)return G(e,t,n[a+1]);{let t=o[o.length-1],a=n.indexOf(t);return G(e,t,n[a+1])}},[G,n]),Y=(0,tx.xx)((e,t)=>{let a=new Map,o=t.map(e=>e.type===t$.PW.STYLE?e.node_id:e.name);return e.forEach(e=>{let r=o.indexOf(e);-1!==r&&(0,nN.mx)(r,n).forEach(e=>{let n=t[e],o="STYLE_FOLDER"===n.type?n.name:n.node_id,r=a.get(o);r||(r=0),a.set(o,r+1)})}),a}),W=o.useCallback(()=>{if(!I)return;let t=(0,nN.QA)(I,n);if(0===t.length)return;let a=t[0],o=n.indexOf(a),r=o,l=o+1;if(a.type===t$.PW.STYLE&&n[l]&&n[l].type===t$.PW.STYLE){let e=(0,nN.rM)(a);for(let t=o+1;t<n.length;t++){let a=n[t];if("STYLE_FOLDER"===a.type&&a.level===e||(0,nN.rM)(a)<e){r=t-1,l=t;break}t===n.length-1&&(r=t,l=t+1)}}G(t,n[r],n[l],!0);let c=(0,tY.In)(a.name),d=N?(0,_.t)("design_systems.create_style.new_folder"):(0,_.t)("design_systems.create_style.untitled_folder");c&&(d=`${c}/${d}`);let p=(e,t)=>{if(e.type===t$.PW.STYLE){let n=d+"/"+t+(0,tY.kH)(e.name);tk.l7.user("rename-style",()=>{i.glU.renameNode(e.node_id,n)})}else{let n=t+(0,tY.kH)(e.name)+"/";e.styles.forEach(e=>{p(e,n)}),e.subfolders.forEach(e=>{p(e,n)})}};t.forEach(e=>{p(e,"")}),y({type:e,folderNames:new Set([d]),styleIds:new Set}),s(d,!1,e)},[y,G,N,I,s,n,e]),H=o.useCallback((e,t)=>{let a=n[e];"STYLE_FOLDER"===a.type&&k(e=>{let n=new Set(e);return t?n.add(a.name):n.delete(a.name),n})},[n]),$=o.useCallback((e,t)=>{k(a=>{let o=new Set(a),r=n[e];if("STYLE_FOLDER"===r.type){let e=(0,tY.In)(r.name),n=""===e?t:e+"/"+t;A.has(r.name)&&(A.delete(r.name),A.add(n)),(0,nN.KU)(r).forEach(e=>{if(A.has(e.name)){let t=e.name.replace(r.name,"");A.add(n+t),A.delete(e.name)}})}return o}),c(n,e,t)},[c,A,n]),X=o.useCallback(e=>{u(n,e)},[u,n]),Q=o.useCallback((e,t,n)=>{let a=t>.5?1:Math.round(1e3*t)/1e3;D({index:e,type:n?"in":"before"}),M(a)},[]),q=o.useCallback(()=>{k(e=>tk.l7.user("delete-styles",()=>{let t=new Set(e);return(I?(0,nN.QA)(I,n):[]).forEach(e=>{"STYLE_FOLDER"===e.type?((0,nN.a2)(e,f?.key||null),A.delete(e.name),(0,nN.KU)(e).forEach(e=>A.delete(e.name))):(0,nN.Nr)(e,f?.key||null)}),t})),tG.Y5.triggerAction("commit"),T.isShown&&(b(tU.sw()),b(J.XE()),i.glU.selectStyle(tA.n3.INVALID,tA.IA.INVALID)),y(null)},[T.isShown,y,I,n,f?.key,A,b]),Z=o.useMemo(()=>{let e=I?(0,nN.QA)(I,n):[];return(0,nN.Ug)(e).map(e=>e.node_id)},[I,n]),et=o.useCallback(()=>{tk.l7.user("cut-styles",()=>i.glU.cutStyles(Z))},[Z]),en=o.useCallback((e,t)=>{t===tH.zy.PASTE?tk.l7.user("paste-styles",()=>i.glU.pasteStyles()):e.shouldPropagate=!0},[]);o.useEffect(()=>{if(!I)return;let e=e=>{e.target&&("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)||et()};return document.addEventListener("cut",e),()=>{document.removeEventListener("cut",e)}},[et,I]);let ea=o.useCallback(()=>{i.glU.pasteStyles()},[]),eo=o.useCallback(e=>{O(t=>[...t,e])},[]),er=o.useCallback(()=>{d()},[d]),el=tD.rf(v,"ondragend",o.useCallback(()=>{D(null),M(null),O([]),p()},[p])),ei=(0,tO.ZC)(I);o.useEffect(()=>{ei!==I&&I&&k(e=>{let n=new Set(e);for(let e of I.styleIds.values()){let a=t.find(t=>t.node_id===e);if(!a)continue;let o=(0,tY.ke)(a.name);for(let e=0;e<o.length;e++){let t=o.slice(0,e).join("/");n.delete(t)}}return n})},[I,ei,t]);let es=o.useRef(null),ec=o.useCallback(e=>{es.current=e},[es]),ed=o.useMemo(()=>I?(0,nN.h$)(I,n):[],[I,n]),ep=o.useMemo(()=>P?(0,nN.h$)(P,n):[],[P,n]),em=o.useMemo(()=>[...ed,...ep].sort((e,t)=>e-t),[ed,ep]),eu=o.useCallback((e,t,r,i,c,d)=>{let p="STYLE_FOLDER"===e.type?e.name:e.node_id,u=!1,_=!1;for(let t of w)if("STYLE_FOLDER"===e.type){if(e.name===t){_=!0;break}e.name.startsWith(t)&&(u=!0)}else if((0,tY.In)(e.name)===t){u=!0;break}if(!_&&!u&&Y(A,n).has(p))return null;let g=em&&em[em.length-1]===t,h=em&&em[0]===t;if(e.type===t$.PW.STYLE){let n=(0,nN.rM)(e),l=null!=a&&a===e.node_id;return o.createElement(nh,{hideStylePreview:U,recordingKey:`style-row-${t}`,index:t,key:e.node_id,isDragging:i,dsStyle:e,selected:r,selectedSecondary:P?.styleIds.has(e.node_id)||!1,level:n,stylePreviewShown:T,onContextMenu:X,updateContextMenuStyleRef:E,updateFocusRowRef:r?ec:null,onMouseDown:c,onMouseMove:d,onInspectStyle:m,updateSelection:y,isEditable:S,deleteSelectedItems:q,isRenaming:l,onRenameItem:s,stopRenamingItem:$,onCreateFolder:W,isLastChildOfSelection:g})}{let n=null!=l&&l.name===e.name&&l.styleTypeSection===e.styleTypeSection,a=B?.folderNameToNestUnder||null;return o.createElement(nc,{recordingKey:`folder-section-${e.styleTypeSection}-row-${t}`,key:t,index:t,isDragging:i,folder:e,selected:r,selectedSecondary:P?.folderNames.has(e.name)||!1,isCollapsed:A.has(e.name),temporarilyExpandFolder:eo,isTemporarilyExpanded:_,isRenaming:n,folderNameToNestUnder:a,onRenameItem:s,stopRenamingItem:$,level:e.level,toggleFolder:e=>H(t,e),onContextMenu:X,onCreateFolder:W,onMouseDown:c,onMouseMove:d,isEditable:S,deleteSelectedItems:q,hideStylePreview:U,isFirstChildOfSelection:h})}},[y,em,A,q,B?.folderNameToNestUnder,Y,U,X,W,m,s,l,a,P?.folderNames,P?.styleIds,$,n,T,eo,w,H,E,S,ec]),eE=o.useCallback(t=>{let a=new Set,o=new Set;t.forEach(e=>{let t=n[e];"STYLE_FOLDER"===t.type?a.add(t.name):o.add(t.node_id)}),y({type:e,folderNames:a,styleIds:o})},[y,n,e]),ey=o.useRef(),e_=o.useRef();return o.useEffect(()=>{ey.current&&ed.length?(ey.current(),es.current&&!es.current.contains(document.activeElement)&&es.current.focus()):e_.current&&!ed.length&&(e_.current(),es.current=null)},[ey,ed,es]),o.createElement(tX.vL,{name:"StyleDraggableList",handleClipboard:en,focusFunctionRef:ey,blurFunctionRef:e_},o.createElement(nf,{styleType:e},o.createElement(nJ,{recordingKey:"style-draggable-list",listItems:n,onInsertItemsIn:z,canInsertItemsIn:K,onInsertItemsBetweenValues:G,onDrag:Q,onDragStart:er,onDragEnd:el,insertDividerStyle:B?.dividerStyles,selectedIndices:ed,updateSelection:eE,renderListItem:eu,scrollContainer:h,isDragDisabled:!S}),o.createElement(nw,{styleRowRef:g,onDeleteItems:q,onCutItems:et,onPasteItems:ea,onRenameItem:s,onEditStyle:m,onCreateFolder:W,styleType:e})))}class nJ extends tQ.q{}var nq=n(520285),nj=n(70575),nZ=n(181320),n0=n(804846),n1=n(33136),n2=n(166635);function n8(e){let t=(0,n1.t)();return e.readOnly?o.createElement(n2.lc,{...e}):t.nodesAreAllInsideStacks&&"AUTO"===t.stackPositioning?null:o.createElement(tJ.Zk,null,o.createElement(tJ.fI,null,o.createElement(tJ.xw,{extended:!0},(0,_.tx)("fullscreen.properties_panel.constraints_panel.constraints"))),o.createElement(n2.lc,{...e}))}function n4(e){return o.createElement(tL.k,{name:"constraints_panel"},o.createElement(n8,{...e}))}var n3=n(233711),n5=n(78479),n7=n(905060),n6=n(841446),n9=n(80479),ae=n(876797),at=n(750693),an=n(307905),aa=n(459674),ao=n(443830),ar=n(920997),al=n(390965),ai=n(754276),as=n(196367),ac=n(520581),ad=n(869156),ap=n(635736);function am(e){return e.modalShown?.type===ap.ye.type||e.modalShown?.prevModal?.type===ap.ye.type}function au(){let e=(0,ap.mB)(),t=(0,o.useCallback)(()=>{e()},[e]),n=(0,r.d4)(am),a=0===(0,ad.Rb)().length&&!n;return o.createElement(tL.k,{name:"local_variables_panel"},o.createElement(tJ.Zk,null,o.createElement(tJ.fI,{className:a?"local_variables_panel--localVariablesPanelRowFaded--atToe local_variables_panel--localVariablesPanelRow--zR8nJ draggable_list--panelHeaderRowFaded--kETRR":"local_variables_panel--localVariablesPanelRow--zR8nJ"},o.createElement(tJ.xZ,{className:"local_variables_panel--titleText--7rdD7 draggable_list--panelTitleText--SwKez",onClick:t,"data-onboarding-key":"local-variables-panel-title"},(0,_.tx)("variables.local_variables_panel.local_variables_title")),o.createElement(ac.E,{name:"variables_modal_button"},o.createElement(as.d,{onClick:t,recordingKey:(0,tD.Pt)("localVariablesPanel","variablesModalButton"),toggled:n,"aria-label":(0,_.t)("variables.local_variables_panel.open_variables_button_tooltip"),htmlAttributes:{"data-tooltip":(0,_.t)("variables.local_variables_panel.open_variables_button_tooltip"),"data-tooltip-type":t2.Ib.TEXT}},o.createElement(t1.U,{svg:ng.A},o.createElement(nd.A,null)))))))}var aE=n(460043);function ay({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:c,localPlugins:d,modalShown:p,openFile:m,orgEntity:u,pickerInStyleCreationShown:E,pickerShown:_,publishedPlugins:g,saveAsState:h,sceneGraphSelection:v,scrollContainer:f,selectedStyleProperties:S,selectionPaints:b,selectionProperties:T,shownPanels:N,strokePanelMode:I,strokePanelTerminalPointCount:P,stylePickerListLayout:C,stylePickerShown:A}){let k=(0,r.wA)(),w=(0,y.md)(tu.b);return o.createElement(tg.i,null,0===Object.keys(v).length&&o.createElement(nj.Mw,{panelName:nj.ON.DESIGN}),(0,ty.d6)(N)&&o.createElement(nq.AV,{recordingKey:"alignPanel"}),o.createElement(tv.VF,{isVisible:N[i.ibQ.TRANSFORM_ITEM]},()=>o.createElement(ai.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:w,pickerShown:_,openFileKey:m?.key||null,canEditConstraints:(0,ty.GG)(N),onlyShowXYInputsRow:w===tE.GR.DEFAULT_SIMPLIFIED||(l().areOnlyResponsiveSetsSelected??!1)})),o.createElement(tE.F$,{isVisible:N[i.ibQ.SCALE_ITEM]}),o.createElement(n3.Q,{selection:v,shownPanels:N,scaleShouldHideOtherPanels:(0,ty.NR)(N)}),o.createElement(tv.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(al.r,{key:"template"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(aE.$,{key:"templateProperties",recordingKey:"templatePropsPanel"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.COMPONENT_ITEM]},()=>o.createElement(n0.cu,{key:"component",recordingKey:"componentPanel"})),o.createElement(tv.VF,{isVisible:(0,ty.tV)(N,T.stateGroupSelectionInfo)},()=>o.createElement(tI.BS,{key:"componentProperties",recordingKey:"propsPanel"})),o.createElement(tv.VF,{isVisible:(0,ty.M0)(N)},()=>o.createElement(n7._,{key:"instance",recordingKey:"instancePanel"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.VECTOR_ITEM]},()=>o.createElement(ai.Ss,{key:"vector-transform",recordingKey:"vectorTransformPanel",isUI3:!1,x:l().x,y:l().y,cornerRadius:l().cornerRadius,handleMirroring:l().handleMirroring,dispatch:k,dropdownShown:a})),o.createElement(tv.VF,{isVisible:(0,ty.zp)(N,T,S,!1)},()=>o.createElement(ar.Vy,{key:"stack",onlyShowResizingRow:!1,onlyStacksSelected:!!N[i.ibQ.STACK_ITEM],recordingKey:"stackPanel"})),o.createElement(tv.VF,{isVisible:(0,ty.GG)(N)},()=>o.createElement(n4,{key:"constraints",openFileKey:m?.key||null,dropdownShown:a,recordingKey:"constraintsPanel"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.MASK_ITEM]},()=>o.createElement(ae.B,{key:"mask",maskType:T.maskType,dispatch:k,dropdownShown:a,recordingKey:"maskPanel"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.GRIDS_ITEM]},()=>o.createElement(tE.tC,{key:"grids",selectionProperties:T})),o.createElement(tv.VF,{isVisible:N[i.ibQ.LAYER_ITEM]},()=>o.createElement(n9.s,{key:"layer",blendMode:T.blendMode,opacity:T.opacity,visible:T.visible,variableConsumptionInfo:T.variableConsumptionInfo,recordingKey:"layerPanel"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.TYPE_ITEM]},()=>o.createElement(tE.gc,{key:"type",selectionProperties:T})),o.createElement(tv.VF,{isVisible:N[i.ibQ.CANVAS_ITEM]},()=>o.createElement(nZ.v,{key:"canvas-background",backgroundColor:T.backgroundColor,backgroundEnabled:T.backgroundEnabled,backgroundOpacity:T.backgroundOpacity,exportBackgroundDisabled:T.exportBackgroundDisabled,dispatch:k,dropdownShown:a,modalShown:p,editModeType:t.activeCanvasEditModeType,pickerShown:_,currentTool:t.currentTool,colorFormat:n,library:c,openFile:m,recordingKey:"canvasBackgroundPanel",currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:tT.rC,sceneGraphSelection:v,selectedStyleProperties:S,hasExports:!!T.exportSettings&&(0,tb._W)(T.exportSettings,[]).length>0})),o.createElement(tv.VF,{isVisible:N[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>o.createElement(an.C,{key:"remove-group-fill-stroke"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.FILL_ITEM]},()=>o.createElement(tE.B8,{key:"fill",selectionProperties:T,variableScopes:(0,ao.og)(T)})),o.createElement(tv.VF,{isVisible:N[i.ibQ.STROKE_ITEM]},()=>o.createElement(at.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:A,strokePanelMode:I,strokePanelTerminalPointCount:P,strokePaints:T.strokePaints,borderSharedWeight:T.borderSharedWeight,strokeWeight:T.strokeWeight,strokeAlign:T.strokeAlign,strokeCap:T.strokeCap,strokeJoin:T.strokeJoin,miterLimitAngle:T.miterLimitAngle,connectorLineStyle:T.connectorLineStyle,leftEndCap:T.leftEndCap,rightEndCap:T.rightEndCap,maxStrokeWeight:T.maxStrokeWeight,dashPattern:T.dashPattern,dashCap:T.dashCap,terminalCap:T.terminalCap,arcRadius:T.arcRadius,arcSweep:T.arcSweep,numSelectedByType:T.numSelectedByType,dispatch:k,dropdownShown:a,modalShown:p,pickerShown:_,pickerInStyleCreationShown:E,stylePickerListLayout:C,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:tT.Em,inheritStyleKey:T.inheritFillStyleKeyForStroke||null,inheritStyleID:T.styleIdForStrokeFill||null,library:c,sceneGraphSelection:v,selectedStyleProperties:S,openFile:m,isPanelBodyCollapsedAtom:null})),o.createElement(tv.VF,{isVisible:(0,ty.fI)(N,(0,ty.NR)(N),b)},()=>o.createElement(at.UA,{key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:b,dispatch:k,dropdownShown:a,sceneGraphSelection:v,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:_,stylePickerListLayout:C,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:tT.rC,library:c,openFile:m,isUI3:!1})),o.createElement(tv.VF,{isVisible:N[i.ibQ.EFFECTS_ITEM]},()=>o.createElement(tE.w5,{key:"effects",selectionProperties:T})),o.createElement(tv.VF,{isVisible:(0,ty.ji)(N,t,v)},()=>o.createElement(au,{key:"local-variables"})),o.createElement(tv.VF,{isVisible:(0,ty.ww)(N,v)},()=>o.createElement(n$,{key:"local-styles",recordingKey:"local-styles",scrollContainer:f})),o.createElement(tv.VF,{isVisible:(0,ty.P1)(N,m)},()=>o.createElement(n5.LI,{key:"export",recordingKey:"exportsPanel",openFile:m,singleNodeName:n5.LI.singleNodeNameFrom(T),numSelected:T.numSelected,exportSettings:T.exportSettings,sceneGraphSelection:v,isSelectionRenamable:n5.LI.isSelectionRenamable(Object.keys(v)),currentPage:(0,tN.Nf)(t),dispatch:k,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:_,saveAsState:h,panelWidth:ty.iP})),o.createElement(tv.VF,{isVisible:!(0,ty.NR)(N)},()=>o.createElement(aa.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:d,publishedPlugins:g,allSavedPlugins:e.plugins,orgEntity:u,dispatch:k,openFileKey:m?.key||null,editorType:m?.editorType?(0,tc.wN)(m.editorType):null,numSelected:l().numSelected??0})),(0,s.kc)().jsx_debugging&&o.createElement(n6.A,null))}var a_=n(814466),ag=n(756015);function ah({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:c,localPlugins:d,modalShown:p,openFile:m,orgEntity:u,pickerInStyleCreationShown:E,pickerShown:_,publishedPlugins:g,saveAsState:h,sceneGraphSelection:v,scrollContainer:f,selectedStyleProperties:S,selectionPaints:b,selectionProperties:T,shownPanels:N,strokePanelMode:I,strokePanelTerminalPointCount:P,stylePickerListLayout:C,stylePickerShown:A}){let k=(0,r.wA)(),w=(0,y.md)(tu.b),O=(0,ao.qh)(T);return o.createElement(tg.i,null,0===Object.keys(v).length&&o.createElement(nj.Mw,{panelName:nj.ON.DESIGN}),o.createElement(ag._i,{recordingKey:"toolbarView",shouldShowComponentPropertiesPanel:(0,ty.tV)(N,T.stateGroupSelectionInfo),shouldShowInstancePanel:(0,ty.M0)(N)}),o.createElement(tv.VF,{isVisible:(0,ty.tV)(N,T.stateGroupSelectionInfo)},()=>o.createElement(tI.BS,{key:"componentProperties",recordingKey:"propsPanel"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.COMPONENT_ITEM]},()=>o.createElement(n0.cu,{key:"component",recordingKey:"componentPanel"})),o.createElement(tv.VF,{isVisible:(0,ty.M0)(N)},()=>o.createElement(n7._,{key:"instance",recordingKey:"instancePanel"})),o.createElement(tv.VF,{isVisible:(0,ty.d6)(N)||N[i.ibQ.TRANSFORM_ITEM]},()=>o.createElement(ai.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:w,pickerShown:_,openFileKey:m?.key||null,canEditConstraints:(0,ty.GG)(N),onlyShowXYInputsRow:w===tE.GR.DEFAULT_SIMPLIFIED||(l().areOnlyResponsiveSetsSelected??!1)})),o.createElement(tv.VF,{isVisible:(0,ty.zp)(N,T,S,!0)},()=>o.createElement(ar.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:w===tE.GR.DEFAULT_SIMPLIFIED,onlyStacksSelected:!!N[i.ibQ.STACK_ITEM]})),o.createElement(tE.F$,{isVisible:N[i.ibQ.SCALE_ITEM]}),o.createElement(n3.Q,{selection:v,shownPanels:N,scaleShouldHideOtherPanels:(0,ty.NR)(N)}),o.createElement(tv.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(al.r,{key:"template"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(aE.$,{key:"templateProperties",recordingKey:"templatePropsPanel"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.VECTOR_ITEM]},()=>o.createElement(ai.Ss,{isUI3:!0,key:"vector-transform",recordingKey:"vectorTransformPanel",x:T.x,y:T.y,cornerRadius:T.cornerRadius,handleMirroring:T.handleMirroring,dispatch:k,dropdownShown:a})),o.createElement(tv.VF,{isVisible:N[i.ibQ.MASK_ITEM]},()=>o.createElement(ae.B,{key:"mask",recordingKey:"maskPanel",maskType:l().maskType,dispatch:k,dropdownShown:a})),o.createElement(tv.VF,{isVisible:N[i.ibQ.LAYER_ITEM]},()=>o.createElement(a_.X,{recordingKey:"appearancePanel"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.TYPE_ITEM]},()=>o.createElement(tE.gc,{key:"type",selectionProperties:T})),o.createElement(tv.VF,{isVisible:N[i.ibQ.CANVAS_ITEM]},()=>o.createElement(nZ.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:T.backgroundColor,backgroundEnabled:T.backgroundEnabled,backgroundOpacity:T.backgroundOpacity,exportBackgroundDisabled:T.exportBackgroundDisabled,dispatch:k,dropdownShown:a,modalShown:p,editModeType:t.activeCanvasEditModeType,pickerShown:_,currentTool:t.currentTool,colorFormat:n,library:c,openFile:m,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:tT.rC,sceneGraphSelection:v,selectedStyleProperties:S,hasExports:!!T.exportSettings&&(0,tb._W)(T.exportSettings,[]).length>0})),o.createElement(tv.VF,{isVisible:N[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>o.createElement(an.C,{key:"remove-group-fill-stroke"})),o.createElement(tv.VF,{isVisible:N[i.ibQ.FILL_ITEM]},()=>o.createElement(tE.B8,{key:"fill",selectionProperties:T,variableScopes:O})),o.createElement(tv.VF,{isVisible:N[i.ibQ.STROKE_ITEM]},()=>o.createElement(at.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:A,strokePanelMode:I,strokePanelTerminalPointCount:P,strokePaints:T.strokePaints,borderSharedWeight:T.borderSharedWeight,strokeWeight:T.strokeWeight,strokeAlign:T.strokeAlign,strokeCap:T.strokeCap,strokeJoin:T.strokeJoin,miterLimitAngle:T.miterLimitAngle,connectorLineStyle:T.connectorLineStyle,leftEndCap:T.leftEndCap,rightEndCap:T.rightEndCap,maxStrokeWeight:T.maxStrokeWeight,dashPattern:T.dashPattern,dashCap:T.dashCap,terminalCap:T.terminalCap,arcRadius:T.arcRadius,arcSweep:T.arcSweep,numSelectedByType:T.numSelectedByType,dispatch:k,dropdownShown:a,modalShown:p,pickerShown:_,pickerInStyleCreationShown:E,stylePickerListLayout:C,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:tT.Em,inheritStyleKey:T.inheritFillStyleKeyForStroke||null,inheritStyleID:T.styleIdForStrokeFill||null,library:c,sceneGraphSelection:v,selectedStyleProperties:S,openFile:m,isPanelBodyCollapsedAtom:null})),o.createElement(tv.VF,{isVisible:N[i.ibQ.EFFECTS_ITEM]},()=>o.createElement(tE.w5,{key:"effects",selectionProperties:T})),o.createElement(tv.VF,{isVisible:(0,ty.fI)(N,(0,ty.NR)(N),b)},()=>o.createElement(at.UA,{isUI3:!0,key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:b,dispatch:k,dropdownShown:a,sceneGraphSelection:v,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:_,stylePickerListLayout:C,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:tT.rC,library:c,openFile:m})),o.createElement(tv.VF,{isVisible:(0,ty.ji)(N,t,v)},()=>o.createElement(au,{key:"local-variables"})),o.createElement(tv.VF,{isVisible:(0,ty.ww)(N,v)},()=>o.createElement(n$,{key:"local-styles",recordingKey:"local-styles",scrollContainer:f})),o.createElement(tv.VF,{isVisible:N[i.ibQ.GRIDS_ITEM]},()=>o.createElement(tE.tC,{key:"grids",selectionProperties:T})),o.createElement(tv.VF,{isVisible:(0,ty.P1)(N,m)},()=>o.createElement(n5.LI,{key:"export",recordingKey:"exportsPanel",openFile:m,singleNodeName:n5.LI.singleNodeNameFrom(T),numSelected:T.numSelected,exportSettings:T.exportSettings,isSelectionRenamable:n5.LI.isSelectionRenamable(Object.keys(v)),sceneGraphSelection:v,currentPage:(0,tN.Nf)(t),dispatch:k,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:_,saveAsState:h,panelWidth:ty.iP})),o.createElement(tv.VF,{isVisible:!(0,ty.NR)(N)},()=>o.createElement(aa.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:d,publishedPlugins:g,allSavedPlugins:e.plugins,orgEntity:u,dispatch:k,openFileKey:m?.key||null,editorType:m?.editorType?(0,tc.wN)(m.editorType):null,numSelected:l().numSelected??0})),(0,s.kc)().jsx_debugging&&o.createElement(n6.A,null))}function av(e){let t=(0,r.wA)(),n=(0,j.GS)(),a=(0,ep.iZ)(),l=(0,A.J2)((0,to.UK)().expandedFramePresetType);return(((0,t_.Im)(e.shownPanels)||Object.keys(e.shownPanels).every(t=>!e.shownPanels[parseInt(t)]))&&!window.figmaPerfTesting&&!(0,e9.Lg)()&&!(0,e9.nl)()&&(0,th.x1)("PropertiesPanel","Rendering design tab with no shownPropertiesPanels",{isEmpty:(0,t_.Im)(e.shownPanels),shouldRenderInspectTab:(0,ty.S4)(e.appModel,a)}),e.shownPanels[i.ibQ.FRAME_PRESETS])?o.createElement(tg.i,null,o.createElement(tv.VF,{isVisible:!0},()=>o.createElement(tf.nl,{key:"frame-presets",recordingKey:"framePresetPanel",dispatch:t,expandedFramePresetType:l}))):e.shownPanels[i.ibQ.PENCIL_TOOL]?o.createElement(tg.i,null,o.createElement(tv.VF,{isVisible:!0},()=>o.createElement(tS.q,{key:"pencilToolPanel",recordingKey:"pencilToolPanel",id:"pencilToolPanel",openFile:e.openFile}))):n?o.createElement(ah,{...e}):o.createElement(ay,{...e})}var af=n(414507),aS=n(435225);function ab({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:s,localPlugins:c,modalShown:d,openFile:p,orgEntity:m,pickerInStyleCreationShown:u,pickerShown:E,publishedPlugins:_,saveAsState:g,sceneGraphSelection:h,selectedStyleProperties:v,selectionPaints:f,selectionProperties:S,shownPanels:b,strokePanelMode:T,strokePanelTerminalPointCount:N,stylePickerListLayout:I,stylePickerShown:P}){let C=(0,r.wA)(),[A,k]=(0,y.fp)(tu.b);return o.createElement(tg.i,null,(0,ty.d6)(b)&&o.createElement(nq.AV,{recordingKey:"alignPanel"}),o.createElement(tv.VF,{isVisible:!0},()=>o.createElement(ai.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:A,pickerShown:E,openFileKey:p?.key||null,canEditConstraints:!1,onlyShowXYInputsRow:!1})),o.createElement(tE.F$,{isVisible:b[i.ibQ.SCALE_ITEM]}),o.createElement(tv.VF,{isVisible:!(0,ty.NR)(b)},()=>o.createElement(n7._,{key:"instance",recordingKey:"instancePanel"})),o.createElement(tv.VF,{isVisible:(0,ty.GG)(b)},()=>o.createElement(n4,{key:"constraints",recordingKey:"constraintsPanel",openFileKey:p?.key||null,dropdownShown:a})),o.createElement(tv.VF,{isVisible:b[i.ibQ.LAYER_ITEM]},()=>o.createElement(n9.s,{key:"layer",recordingKey:"layerPanel",blendMode:S.blendMode,opacity:S.opacity,visible:S.visible,variableConsumptionInfo:S.variableConsumptionInfo})),A===tE.GR.DEFAULT_SIMPLIFIED&&o.createElement(aS.Y,{onExpand:()=>k(tE.GR.OVERRIDDEN_EXPANDED)}),A===tE.GR.OVERRIDDEN_EXPANDED&&o.createElement(o.Fragment,null,o.createElement(n3.Q,{selection:h,shownPanels:b,scaleShouldHideOtherPanels:(0,ty.NR)(b)}),o.createElement(tv.VF,{isVisible:b[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(al.r,{key:"template"})),o.createElement(tv.VF,{isVisible:b[i.ibQ.COMPONENT_ITEM]},()=>o.createElement(n0.cu,{key:"component",recordingKey:"componentPanel"})),o.createElement(tv.VF,{isVisible:b[i.ibQ.VECTOR_ITEM]},()=>o.createElement(ai.Ss,{key:"vector-transform",recordingKey:"vectorTransformPanel",x:S.x,y:S.y,cornerRadius:S.cornerRadius,handleMirroring:S.handleMirroring,dispatch:C,dropdownShown:a,isUI3:!1})),o.createElement(tv.VF,{isVisible:(0,ty.zp)(b,S,v,!1)},()=>o.createElement(ar.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:!1,onlyStacksSelected:!!b[i.ibQ.STACK_ITEM]})),o.createElement(tv.VF,{isVisible:b[i.ibQ.MASK_ITEM]},()=>o.createElement(ae.B,{key:"mask",recordingKey:"maskPanel",maskType:l().maskType,dispatch:C,dropdownShown:a})),o.createElement(tv.VF,{isVisible:b[i.ibQ.GRIDS_ITEM]},()=>o.createElement(tE.tC,{key:"grids",selectionProperties:S})),o.createElement(tv.VF,{isVisible:b[i.ibQ.TYPE_ITEM]},()=>o.createElement(tE.gc,{key:"type",selectionProperties:S})),o.createElement(tv.VF,{isVisible:b[i.ibQ.CANVAS_ITEM]},()=>o.createElement(nZ.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:S.backgroundColor,backgroundEnabled:S.backgroundEnabled,backgroundOpacity:S.backgroundOpacity,exportBackgroundDisabled:S.exportBackgroundDisabled,dispatch:C,dropdownShown:a,modalShown:d,editModeType:t.activeCanvasEditModeType,pickerShown:E,currentTool:t.currentTool,colorFormat:n,library:s,openFile:p,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:tT.rC,sceneGraphSelection:h,selectedStyleProperties:v,hasExports:!!S.exportSettings&&(0,tb._W)(S.exportSettings,[]).length>0})),o.createElement(tv.VF,{isVisible:b[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>o.createElement(an.C,{key:"remove-group-fill-stroke"})),o.createElement(tv.VF,{isVisible:b[i.ibQ.FILL_ITEM]},()=>o.createElement(tE.B8,{key:"fill",selectionProperties:S,variableScopes:(0,ao.og)(S)})),o.createElement(tv.VF,{isVisible:b[i.ibQ.STROKE_ITEM]},()=>o.createElement(at.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:P,strokePanelMode:T,strokePanelTerminalPointCount:N,strokePaints:S.strokePaints,borderSharedWeight:S.borderSharedWeight,strokeWeight:S.strokeWeight,strokeAlign:S.strokeAlign,strokeCap:S.strokeCap,strokeJoin:S.strokeJoin,miterLimitAngle:S.miterLimitAngle,connectorLineStyle:S.connectorLineStyle,leftEndCap:S.leftEndCap,rightEndCap:S.rightEndCap,maxStrokeWeight:S.maxStrokeWeight,dashPattern:S.dashPattern,dashCap:S.dashCap,terminalCap:S.terminalCap,arcRadius:S.arcRadius,arcSweep:S.arcSweep,numSelectedByType:S.numSelectedByType,dispatch:C,dropdownShown:a,modalShown:d,pickerShown:E,pickerInStyleCreationShown:u,stylePickerListLayout:I,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:tT.Em,inheritStyleKey:S.inheritFillStyleKeyForStroke||null,inheritStyleID:S.styleIdForStrokeFill||null,library:s,sceneGraphSelection:h,selectedStyleProperties:v,openFile:p,isPanelBodyCollapsedAtom:null})),o.createElement(tv.VF,{isVisible:!0},()=>o.createElement(at.UA,{key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:f,dispatch:C,dropdownShown:a,sceneGraphSelection:h,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:E,stylePickerListLayout:I,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:tT.rC,library:s,openFile:p,isUI3:!1})),o.createElement(tv.VF,{isVisible:b[i.ibQ.EFFECTS_ITEM]},()=>o.createElement(tE.w5,{key:"effects",selectionProperties:S})),o.createElement(tv.VF,{isVisible:!(0,ty.NR)(b)},()=>o.createElement(aa.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:_,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,tc.wN)(p.editorType):null,numSelected:l().numSelected??0}))),o.createElement(tv.VF,{isVisible:(0,ty.P1)(b,p)},()=>o.createElement(n5.LI,{key:"export",recordingKey:"exportsPanel",openFile:p,singleNodeName:n5.LI.singleNodeNameFrom(S),numSelected:S.numSelected,exportSettings:S.exportSettings,sceneGraphSelection:h,currentPage:(0,tN.Nf)(t),isSelectionRenamable:n5.LI.isSelectionRenamable(Object.keys(h)),dispatch:C,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:E,saveAsState:g,panelWidth:ty.iP})),o.createElement(tv.VF,{isVisible:!(0,ty.NR)(b)},()=>o.createElement(aa.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:_,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,tc.wN)(p.editorType):null,numSelected:l().numSelected??0})))}function aT({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:s,localPlugins:c,modalShown:d,openFile:p,orgEntity:m,pickerInStyleCreationShown:u,pickerShown:E,publishedPlugins:_,saveAsState:g,sceneGraphSelection:h,selectedStyleProperties:v,selectionPaints:f,selectionProperties:S,shownPanels:b,strokePanelMode:T,strokePanelTerminalPointCount:N,stylePickerListLayout:I,stylePickerShown:P}){let C=(0,r.wA)(),[A,k]=(0,y.fp)(tu.b);return o.createElement(tg.i,null,0===Object.keys(h).length&&o.createElement(nj.Mw,{panelName:nj.ON.DESIGN}),o.createElement(ag._i,{recordingKey:"toolbarView",shouldShowComponentPropertiesPanel:(0,ty.tV)(b,S.stateGroupSelectionInfo),shouldShowInstancePanel:(0,ty.M0)(b)}),o.createElement(tv.VF,{isVisible:!(0,ty.NR)(b)},()=>o.createElement(n7._,{key:"instance",recordingKey:"instancePanel"})),o.createElement(tv.VF,{isVisible:!0},()=>o.createElement(ai.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:A,pickerShown:E,openFileKey:p?.key||null,canEditConstraints:(0,ty.GG)(b),onlyShowXYInputsRow:A===tE.GR.DEFAULT_SIMPLIFIED||(l().areOnlyResponsiveSetsSelected??!1)})),o.createElement(tv.VF,{isVisible:(0,ty.zp)(b,S,v,!0)},()=>o.createElement(ar.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:A===tE.GR.DEFAULT_SIMPLIFIED,onlyStacksSelected:!!b[i.ibQ.STACK_ITEM]})),o.createElement(tE.F$,{isVisible:b[i.ibQ.SCALE_ITEM]}),A===tE.GR.DEFAULT_SIMPLIFIED&&o.createElement(aS.Y,{onExpand:()=>k(tE.GR.OVERRIDDEN_EXPANDED)}),A===tE.GR.OVERRIDDEN_EXPANDED&&o.createElement(o.Fragment,null,o.createElement(tv.VF,{isVisible:b[i.ibQ.LAYER_ITEM]},()=>o.createElement(a_.X,{recordingKey:"appearancePanel"})),o.createElement(n3.Q,{selection:h,shownPanels:b,scaleShouldHideOtherPanels:(0,ty.NR)(b)}),o.createElement(tv.VF,{isVisible:b[i.ibQ.TEMPLATE_ITEM]},()=>o.createElement(al.r,{key:"template"})),o.createElement(tv.VF,{isVisible:b[i.ibQ.COMPONENT_ITEM]},()=>o.createElement(n0.cu,{key:"component",recordingKey:"componentPanel"})),o.createElement(tv.VF,{isVisible:b[i.ibQ.VECTOR_ITEM]},()=>o.createElement(ai.Ss,{isUI3:!0,key:"vector-transform",recordingKey:"vectorTransformPanel",x:S.x,y:S.y,cornerRadius:S.cornerRadius,handleMirroring:S.handleMirroring,dispatch:C,dropdownShown:a})),o.createElement(tv.VF,{isVisible:b[i.ibQ.MASK_ITEM]},()=>o.createElement(ae.B,{key:"mask",recordingKey:"maskPanel",maskType:l().maskType,dispatch:C,dropdownShown:a})),o.createElement(tv.VF,{isVisible:b[i.ibQ.TYPE_ITEM]},()=>o.createElement(tE.gc,{key:"type",selectionProperties:S})),o.createElement(tv.VF,{isVisible:b[i.ibQ.CANVAS_ITEM]},()=>o.createElement(nZ.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:S.backgroundColor,backgroundEnabled:S.backgroundEnabled,backgroundOpacity:S.backgroundOpacity,exportBackgroundDisabled:S.exportBackgroundDisabled,dispatch:C,dropdownShown:a,modalShown:d,editModeType:t.activeCanvasEditModeType,pickerShown:E,currentTool:t.currentTool,colorFormat:n,library:s,openFile:p,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:tT.rC,sceneGraphSelection:h,selectedStyleProperties:v,hasExports:!!S.exportSettings&&(0,tb._W)(S.exportSettings,[]).length>0})),o.createElement(tv.VF,{isVisible:b[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>o.createElement(an.C,{key:"remove-group-fill-stroke"})),o.createElement(tv.VF,{isVisible:b[i.ibQ.FILL_ITEM]},()=>o.createElement(tE.B8,{key:"fill",selectionProperties:S,variableScopes:(0,ao.og)(S)})),o.createElement(tv.VF,{isVisible:b[i.ibQ.STROKE_ITEM]},()=>o.createElement(at.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:P,strokePanelMode:T,strokePanelTerminalPointCount:N,strokePaints:S.strokePaints,borderSharedWeight:S.borderSharedWeight,strokeWeight:S.strokeWeight,strokeAlign:S.strokeAlign,strokeCap:S.strokeCap,strokeJoin:S.strokeJoin,miterLimitAngle:S.miterLimitAngle,connectorLineStyle:S.connectorLineStyle,leftEndCap:S.leftEndCap,rightEndCap:S.rightEndCap,maxStrokeWeight:S.maxStrokeWeight,dashPattern:S.dashPattern,dashCap:S.dashCap,terminalCap:S.terminalCap,arcRadius:S.arcRadius,arcSweep:S.arcSweep,numSelectedByType:S.numSelectedByType,dispatch:C,dropdownShown:a,modalShown:d,pickerShown:E,pickerInStyleCreationShown:u,stylePickerListLayout:I,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:tT.Em,inheritStyleKey:S.inheritFillStyleKeyForStroke||null,inheritStyleID:S.styleIdForStrokeFill||null,library:s,sceneGraphSelection:h,selectedStyleProperties:v,openFile:p,isPanelBodyCollapsedAtom:null})),o.createElement(tv.VF,{isVisible:b[i.ibQ.EFFECTS_ITEM]},()=>o.createElement(tE.w5,{key:"effects",selectionProperties:S})),o.createElement(tv.VF,{isVisible:(0,ty.fI)(b,(0,ty.NR)(b),f)},()=>o.createElement(at.UA,{isUI3:!0,key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:f,dispatch:C,dropdownShown:a,sceneGraphSelection:h,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:E,stylePickerListLayout:I,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:tT.rC,library:s,openFile:p})),o.createElement(tv.VF,{isVisible:b[i.ibQ.GRIDS_ITEM]},()=>o.createElement(tE.tC,{key:"grids",selectionProperties:S})),o.createElement(tv.VF,{isVisible:(0,ty.P1)(b,p)},()=>o.createElement(n5.LI,{key:"export",recordingKey:"exportsPanel",openFile:p,singleNodeName:n5.LI.singleNodeNameFrom(S),isSelectionRenamable:n5.LI.isSelectionRenamable(Object.keys(h)),numSelected:S.numSelected,exportSettings:S.exportSettings,sceneGraphSelection:h,currentPage:(0,tN.Nf)(t),dispatch:C,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:E,saveAsState:g,panelWidth:ty.iP})),o.createElement(tv.VF,{isVisible:!(0,ty.NR)(b)},()=>o.createElement(aa.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:_,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,tc.wN)(p.editorType):null,numSelected:l().numSelected??0}))),o.createElement(tv.VF,{isVisible:!(0,ty.NR)(b)},()=>o.createElement(aa.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:_,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,tc.wN)(p.editorType):null,numSelected:l().numSelected??0})))}function aN(e){let t=(0,j.GS)();if((0,t_.Im)(e.shownPanels)||Object.keys(e.shownPanels).every(t=>!e.shownPanels[parseInt(t)])){let e=Error("Rendering simplified design tab with no shownPropertiesPanels");(0,th.$D)(af.FigmaTeam.EDITOR_USABILITY,e)}return t?o.createElement(aT,{...e}):o.createElement(ab,{...e})}function aI({scrollContainer:e,...t}){let n=(0,y.md)(tu.b),a=(0,tm.Yo)(),r=()=>(0,ty.RB)(t.selectedStyleProperties)?t.selectedStyleProperties:t.selectionProperties;return n===tE.GR.DEFAULT_EXPANDED?o.createElement(av,{...t,getContextualSelectionProperties:r,orgEntity:a,scrollContainer:e}):o.createElement(aN,{...t,getContextualSelectionProperties:r,orgEntity:a})}var aP=n(507956);function aC({appModel:e,dropdownShown:t,pickerShown:n,saveAsState:a,sceneGraphSelection:l,selectedStyleProperties:i,selectionProperties:s}){let c=(0,r.wA)(),d=(0,ee.q5)(),p=(0,tN.Nf)(e),m=(0,aP.ks)(),u=e.isReadOnly&&!m,E=(0,ty.RB)(i)?i:s;return o.createElement(tv.VF,{isVisible:!0},()=>o.createElement(n5.LI,{key:"export",title:u?(0,_.t)("fullscreen.properties_panel.export"):(0,_.t)("fullscreen.properties_panel.presets"),standalone:!0,openFile:d,singleNodeName:n5.LI.singleNodeNameFrom(E),isSelectionRenamable:n5.LI.isSelectionRenamable(Object.keys(l)),numSelected:E.numSelected,exportSettings:E.exportSettings,sceneGraphSelection:l,currentPage:p,dispatch:c,dropdownShown:t,currentSelectedProperty:e.currentSelectedProperty,pickerShown:n,recordingKey:"exportsPanel",saveAsState:a,panelWidth:ty.iP}))}var aA=n(126590),ak=n(143678),aw=n(889449),aO=n(853497);function ax({selectionProperties:e,scrollContainer:t}){let n=(0,ee.q5)(),a=(0,C.KH)(),r=!e.prototypeStartingPointsInfo||e.prototypeStartingPointsInfo?.length>0,l=0===Object.keys(a).length,i=n?.canEdit,s=o.createElement(tv.VF,{isVisible:l&&!i&&r},()=>o.createElement(aO.A,{viewOnly:!0})),c=o.createElement(tv.VF,{isVisible:l},()=>o.createElement(n$,{key:"code-local-styles",recordingKey:"code-local-styles",scrollContainer:t}));return o.createElement(eb.fu,{name:ak.e0.CODE_PANEL},o.createElement(tg.i,null,o.createElement(nj.Mw,{panelName:nj.ON.INSPECT}),o.createElement(aw.U,{key:"inspection-properties-panel",recordingKey:"inspectionPanel",flowPanel:s,localStylesPanel:c})))}var aD=n(972643),aR=n(75395),aM=n(57860),aL=n(326331),aV=n(977750),aK=n(189904),aF=n(523047),aU=n(335601),aB=n(743282),aG=n(901536),az=n(239349),aY=n(662275),aW=n(218973),aH=n(158950),a$=n(60088),aX=n(581138),aQ=n(343559),aJ=n(939791),aq=n(544082),aj=n(822397),aZ=n(198868),a0=n(802926),a1=n(269900),a2=n(429308),a8=n(574724);async function a4(e,t){let n=await (0,aq.vd)(e),a=await (0,aq.vd)(t),o=(await a8.Ay.design.getTextImageEmbeds({model:"clip-huge-shared",input:{images:[n,a]}})).encoded_images;if(!o||2!==o.length)throw Error("Expected two embedding vectors in the response");let r=o[0],l=o[1];if(!r||!l)throw Error("Embedding vectors must not be undefined");return(0,a2.Lb)(r,l)}async function a3(e,t){e(d.F.clearAll());let n=eU.q.instance.getCurrentPage()?.childrenNodes.filter(e=>"SECTION"===e.type&&1===e.childrenNodes.length);if(!n||0===n.length){e(d.F.enqueue({message:(0,_.t)("living_designs.eval.error"),error:!0}));return}let a=tk.l7.ai(aq.p1,()=>{let e=eU.q.instance.createNode("CANVAS");return e.name=`Eval - ${new Date().toLocaleString()}`,e});await eU.q.instance.setCurrentPageAsync(a.guid);let o=t.evaluationRuns,r=o*n.length;e(d.F.enqueue({type:"living-designs-evals",message:(0,_.t)("living_designs.eval.progress",{completed:0,total:r}),timeoutOverride:1/0}));try{let a=0,l=n.flatMap((e,t)=>Array.from({length:o}).map((n,a)=>{var r;let l=t*o+a;return r=(e.absoluteRenderBounds.w+(l>0?40:0))*l,tk.l7.ai(aq.p1,()=>{let t=e.clone(),n=eU.q.instance.get(t);n.relativeTransform={...n.relativeTransform,m02:r};let a=e.clone(),o=eU.q.instance.get(a);o.relativeTransform={...o.relativeTransform,m02:r},o.name="Output: "+e.name,o.y=e.y+e.size.y+40,o.size={x:o.size.x,y:3*o.size.y},o.childrenNodes[0].removeSelfAndChildren();let l=n.childrenNodes[0];if(!l)throw Error("Failed to clone node");return{nodeToEval:l,inputSection:n,outputSection:o}})})),i=(0,aZ.D)();i.viewport.scrollAndZoomIntoView(l.flatMap(({inputSection:e,outputSection:t})=>[e,t].map(e=>i.getNodeById(e.guid)).filter(e=>null!==e)));let s=l.map(async({nodeToEval:n,outputSection:o})=>{let l=await a5(n,o,t);return a++,e(d.F.enqueue({type:"living-designs-evals",message:(0,_.t)("living_designs.eval.progress",{completed:a,total:r}),timeoutOverride:1/0})),l}),c=(await Promise.all(s)).map(({metrics:e})=>e),p=function(e){let t=e.reduce((e,t)=>e+t.imageToImageSimilarity,0)/e.length,n=e.length,a=e.filter(e=>e.error).length;return{avgImageToImageSimilarity:t,numTestCases:n,numFailures:a,failureRate:a/n}}(c),m=l[0]?.inputSection;if(!m)throw Error("No sections were prepared for evaluation.");tk.l7.ai(aq.p1,()=>(function(e,t){let n=e.clone(),a=eU.q.instance.get(n);a.childrenNodes[0].removeSelfAndChildren(),a.relativeTransform={...a.relativeTransform,m02:e.absoluteRenderBounds.w},a.name="Aggregate Metrics",a.x=e.x-e.size.x-40,a.y=e.y;let o=eU.q.instance.createNode("TEXT");o.spliceCharacters(0,0,`Aggregate Metrics: ${JSON.stringify(t,(e,t)=>"number"!=typeof t||Number.isInteger(t)?t:t.toFixed(3),2)}`,"BEFORE"),o.x=0,o.size.x=a.size.x,o.y=10,a.appendChild(o),o.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],o.fontSize=40})(m,p)),e(d.F.enqueue({type:"living-designs-evals",message:(0,_.t)("living_designs.eval.finished")}))}catch(t){a.removeSelfAndChildren(),e(d.F.enqueue({type:"living-designs-evals",message:(0,_.t)("living_designs.eval.error"),error:!0}))}}async function a5(e,t,n){!function e(t){for(let n of t.childrenNodes)e(n);t.annotations.length>0&&((0,aq.Ww)(t,{...(0,aq.u6)(t),messages:t.annotations.map(e=>({id:(0,aB.g)(),createdAt:Date.now(),content:e.label}))}),t.annotations.splice(0,t.annotations.length))}(e);let a=e.size,o={x:t.size.x/2-a.x/2,y:40},r=y.zl.get(aj.Zl).serializer,{html:l,svgs:i,styles:s}=await (0,aq.li)(e,r,(0,aj.Lf)(e).map(e=>e.nodeId));if("sites"===r&&l&&i){let n=`export default function App() {
        return (
          <div
            style={{ width: '100%', height: '100%' }}
            dangerouslySetInnerHTML={{ __html: \`${l}\` }}
          />
        );
      }`,r=(0,aq.hl)(n,i),c=await (0,a0.I)(r),d=await (0,a0.z)(c);a7({name:"HTML",imageSet:(await (0,a1.l)({code:d,width:e.size.x??0,height:e.size.y??0,props:{},styleOverride:s})).imageSet,sources:[{code:r,language:"TYPESCRIPT"},{code:s,language:"CSS"}],position:o,size:a,outputSection:t})}let{generatedCode:c,nodesWithProps:d,errorMessage:p}=await (0,aj.kX)(e,{initialBackoffDelay:n.evalBackoffDelay});if(!c||!d)return tk.l7.ai(aq.p1,()=>{let e=eU.q.instance.createNode("FRAME");e.size=a,e.x=o.x,e.y=o.y,t.appendChild(e);let n=eU.q.instance.createNode("TEXT");n.spliceCharacters(0,0,p??(0,_.t)("living_designs.eval.error"),"BEFORE"),n.size=e.size,n.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],e.fills=[{type:"SOLID",color:{r:1,g:0,b:0,a:1}}],e.appendChild(n)}),{outputSection:t,metrics:{imageToImageSimilarity:0,error:!0}};let m=await (0,a0.I)(c),u=await (0,a0.z)(m),E=await (0,a1.l)({code:u,width:e.size.x??0,height:e.size.y??0,props:(0,aj.IL)(eU.q.instance,d),styleOverride:s}),g=await a7({name:"Generated",imageSet:E.imageSet,sources:[{code:c,language:"TYPESCRIPT"},{code:s,language:"CSS"}],position:o,size:a,outputSection:t}),h=await a4(e,g);return tk.l7.ai(aq.p1,()=>{let e=eU.q.instance.createNode("TEXT");e.spliceCharacters(0,0,`Image-Image Similarity: ${h.toFixed(2)}`,"BEFORE"),e.x=0,e.size.x=g.size.x,e.y=10,t.appendChild(e),e.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],e.fontSize=40}),{outputSection:t,metrics:{imageToImageSimilarity:h,error:!1}}}async function a7({name:e,imageSet:t,sources:n,position:a,size:o,outputSection:r}){let l=[],i=20,s=tk.l7.ai(aq.p1,()=>{let s=eU.q.instance.createNode("FRAME");s.size=o,s.x=i,s.y=a.y,s.insertImageInFillPaint(t),s.name=e,i+=o.x+40;let c=(r.size.x-i)/n.length-40;for(let t of n){let n=eU.q.instance.createNode("FRAME");n.name=e+" Code",n.size={x:c,y:o.y},n.x=i,n.y=a.y,n.frameMaskDisabled=!1,r.appendChild(n);let d=eU.q.instance.createNode("CODE_BLOCK");l.push([d.guid,t]),n.appendChild(d),r.appendChild(s),i+=c+40}return s}),c=(0,aZ.D)();for(let[e,t]of l){await c.loadFontAsync({family:"Source Code Pro",style:"Medium"});let n=c.getNodeById(e);n.code=t.code,n.codeLanguage=t.language}return a.y+=o.y+40,s}var a6=n(602354),a9=n(343887),oe=n(940319),ot=n(601607),on=n(237870),oa=n(32067),oo=n(547583),or=n(746806),ol=n(711490),oi=n(502601);let os=function(){throw Error("Component Preview not available")};var oc=n(20484);let od="LivingDesignsModal",op=(0,on.Ju)(function({initialSize:e}){let t=(0,r.wA)(),[n,a]=(0,o.useState)(0),l=(0,oc.ts)(e,ou),[i,s]=a6.tU.useTabs({preview:!0,code:!0,debug:!0});if(!l)return null;let{width:c,setWidth:d,height:p,setHeight:m,minWidth:u,minHeight:E,position:y,setPosition:g}=l,h=o.createElement(a6.tU.TabStrip,{manager:s},o.createElement(a6.tU.Tab,{...i.preview},(0,_.t)("living_designs.modal.tabs.preview")),o.createElement(a6.tU.Tab,{...i.code},(0,_.t)("living_designs.modal.tabs.code")),o.createElement(a6.tU.Tab,{...i.debug},(0,_.t)("living_designs.modal.tabs.debug"))),v=o.createElement(a9.K,{onClick:()=>a(e=>e+1),"aria-label":(0,_.t)("living_designs.modal.refresh")},o.createElement(oe._,null));return o.createElement(oi.Q,null,o.createElement(oE.Provider,{value:{tabPropsMap:i,tabManager:s}},o.createElement(or.BL,{customButton:v,title:h,position:y,allowResizeHeight:!0,allowResizeWidth:!0,dragHeaderOnly:!0,fullFrame:!0,height:p,width:c,minWidth:u,minHeight:E,setWidth:d,setHeight:m,setPosition:g,onClose:()=>{t((0,aY.ES)({type:od}))},overflowHidden:!0},o.createElement(o_,{key:n,size:{x:c,y:p}}))))},od),om={x:400,y:400},ou={x:260,y:80},oE=o.createContext(void 0),oy=()=>{let e=o.useContext(oE);if(!e)throw Error("usePreviewContext must be used within a PreviewContext.Provider");return e};function o_({size:e}){let{isResizing:t,isDragging:n}=o.useContext(ol.O);return o.createElement(oh,{disablePointerEvents:t||n,size:e})}var og=(e=>(e.None="none",e.Generating="generating",e.Bundling="bundling",e.Ready="ready",e.Error="error",e))(og||{});function oh({disablePointerEvents:e,size:t}){let n=(0,oa.VW)(),a=(0,aq.L4)(),r=(0,aq.Jp)(),l=(0,tO.PD)(r),i=n?.guid?r:l,[s,c]=(0,y.fp)((0,aj.R)(a?.guid||"")),[d,p]=(0,o.useState)(null),[m,u]=(0,o.useState)(""),{tabPropsMap:E}=oy(),g=(0,ot.Fk)(aj.IL,i?.generation?.nodesWithProps||[]);(0,o.useEffect)(()=>{let e=i?.generation;if(!e||"idle"!==s.status){p(null),u("");return}(0,a0.I)(e.code).then(a0.z).then(t=>{p(t),u(e.styles)})},[i?.generation,s]);let h="idle"===s.status&&i?.generation?.code?d?"ready":"bundling":"loading"===s.status?"generating":"none";return o.createElement("div",{className:aG.cx.wFull.hFull.relative.$},o.createElement(a6.tU.TabPanel,{...E.preview},o.createElement("div",{className:aG.cx.absolute.top0.right0.bottom0.left0.$},"none"===h&&o.createElement("div",{className:aG.cx.flex.hFull.wFull.itemsCenter.justifyCenter.$},(0,_.t)("living_designs.preview.no_design")),"generating"===h&&o.createElement("div",{className:aG.cx.flex.hFull.wFull.itemsCenter.justifyCenter.flexColumn.$},o.createElement("div",null,(0,_.t)("living_designs.preview.generating")),o.createElement(aM.k,null)),"bundling"===h&&o.createElement("div",{className:aG.cx.flex.hFull.wFull.itemsCenter.justifyCenter.flexColumn.$},o.createElement("div",null,(0,_.t)("living_designs.preview.bundling")),o.createElement(aM.k,null)),"ready"===h&&o.createElement(os,{disablePointerEvents:e,code:d,props:g,styles:m,size:{x:t.x,y:t.y},withReset:!0,onError:e=>c({status:"idle",errorMessage:e.message}),scaleLinearly:!0}),"idle"===s.status&&s.errorMessage&&o.createElement("div",{className:aG.cx.absolute.left0.right0.bottom0.h24.flex.justifyBetween.itemsCenter.bt1.bSolid.colorBorder.p12.colorBgDanger.colorTextOndanger.$},(0,_.t)("living_designs.preview.error",{error:s.errorMessage||"Unknown"})))),o.createElement(a6.tU.TabPanel,{...E.code},o.createElement("textarea",{readOnly:!0,className:aG.cx.absolute.top0.right0.bottom0.left0.$,value:i?.generation?.code||"No code available"})),o.createElement(a6.tU.TabPanel,{...E.debug},o.createElement("div",{className:aG.cx.absolute.top0.right0.bottom0.left0.overflowYScroll.$},o.createElement(oo.p,{data:i?.generation}))))}var ov=n(140686),of=n(256296),oS=n(568214),ob=n(572206),oT=n(973149),oN=n(499777),oI=n(420186),oP=n(72875),oC=n(538697),oA=n(994481);let ok=new oT.KD({}),ow=e=>e.replace(/([A-Z])/g," $1").toLowerCase().replace(/^./,e=>e.toUpperCase()).trim();function oO({prop:e,onChange:t}){switch(e.type){case"number":return o.createElement(ox,{prop:e,onChange:t});case"color":return o.createElement(oD,{prop:e,onChange:t});case"string":return o.createElement(oR,{prop:e,onChange:t});case"enum":return o.createElement(oM,{prop:e,onChange:t});case"boolean":return o.createElement(oL,{prop:e,onChange:t});default:return null}}function ox({prop:e,onChange:t}){let n=(0,r.wA)();return o.createElement(oA.cS,{label:ow(e.name),input:o.createElement(aW.j5,{value:e.value??e.defaultValue??0,onValueChange:e=>t(e),formatter:ok,dispatch:n,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":ow(e.name)})})}function oD({prop:e,onChange:t}){let n=(0,r.wA)(),a=(0,oN.Xo)(),l=o.useRef(null),i=(0,oS.H0)(e.value??e.defaultValue??"#ffffff")||{r:1,g:1,b:1,a:1},s={type:"SOLID",color:i,opacity:i.a?i.a:1};return o.createElement("div",null,a?.id===`living-design-prop-${e.name}-color-picker`&&o.createElement(oP.h3,{disabledVariableIds:new Set,initialPosition:new ob.Mi(a.initialX,a.initialY),color:i,boundVariable:null,onChange:e=>t((0,oS.YU)(e)),onClose:()=>n(J.XE())}),o.createElement(oA.cS,{label:ow(e.name),input:o.createElement("div",{className:"living_designs_props--colorValueContainer--nPsog paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t",ref:l},o.createElement(at.y7,{paint:s,onChange:e=>{let n=e.color;n&&(void 0!==e.opacity&&(n.a=e.opacity),t((0,oS.YU)(n)))},togglePicker:()=>{if(!l.current)return;let{x:t,y:a}=(0,oI.cn)(l.current);n(J.u1({id:`living-design-prop-${e.name}-color-picker`,initialX:t,initialY:a}))}}))}))}function oR({prop:e,onChange:t}){return o.createElement(oA.cS,{label:ow(e.name),input:o.createElement(tJ.ks,{value:e.value??e.defaultValue??"",onChange:e=>t(e.currentTarget.value)})})}function oM({prop:e,onChange:t}){let n=(0,r.wA)(),a=(0,nT.Um)();return o.createElement(oA.cS,{label:ow(e.name),input:o.createElement(oC.l6,{property:e.value??e.defaultValue??"",onChange:e=>t(e),id:`living-design-prop-${e.name}`,dispatch:n,dropdownShown:a,formatter:{format:e=>e}},e.options?.map(e=>o.createElement(oC.c$,{key:e,value:e},e)))})}function oL({prop:e,onChange:t}){return o.createElement(oA.cS,{label:ow(e.name),input:o.createElement(ov.S,{checked:e.value??e.defaultValue??!1,onChange:e=>t(e),label:o.createElement(of.h,null,ow(e.name))})})}var oV=n(320986),oK=n(289298);function oF(e,t){return t.map(t=>({displayText:t,callback(){y.zl.set(aj.f3,{provider:e,modelId:t})}}))}let oU=[{displayText:"Anthropic",children:oF("anthropic",["claude-3-5-sonnet-20240620","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-5-sonnet-20241022","claude-3-haiku-20240307"])},{displayText:"OpenAI",children:oF("openai",["ft:gpt-4o-2024-08-06:figma-development::A95wrEFE:ckpt-step-732","gpt-3.5-turbo","gpt-3.5-turbo-0301","gpt-3.5-turbo-0613","gpt-3.5-turbo-1106","gpt-3.5-turbo-0125","gpt-3.5-turbo-16k","gpt-3.5-turbo-16k-0613","gpt-4","gpt-4-0314","gpt-4-0613","gpt-4-32k","gpt-4-32k-0314","gpt-4-32k-0613","gpt-4-1106-preview","gpt-4-vision-preview","gpt-4-turbo-2024-04-09","gpt-4o-2024-05-13","gpt-4o-2024-08-06","gpt-4o-mini-2024-07-18","o1-preview-2024-09-12","o1-mini-2024-09-12"])}];function oB(){let{toggleDropdown:e,dropdownTargetRef:t,Dropdown:n,isDropdownShown:a}=(0,a$.B)(),r=(0,y.md)(aj.f3);return o.createElement(o.Fragment,null,a&&o.createElement(n,{items:oU,showPoint:!0,lean:"left"}),o.createElement("div",{ref:t},o.createElement(aR.E,{className:aG.cx.wFull.flex.alignCenter.justifyBetween.cursorPointer.b1.colorBorder.bRadius4.$,onClick:e},o.createElement("span",{className:aG.cx.p4.$},null==r?"Pick a model":r.modelId),o.createElement(t1.U,{svg:oK.A},o.createElement(aL.r,null)))))}function oG(){let e=(0,az.VW)(),t=(0,aq.L4)(),n=(0,aq.Vq)(),[a,l]=o.useState(""),i=(0,r.wA)(),s=(0,y.md)((0,aj.R)(t?.guid||""));if(!e||!n)return o.createElement(oW,null);let c=()=>{a.length&&(l(""),(0,aq.Ww)(e,e=>{let t=Date.now();return{...e,messages:[...e.messages||[],{id:(0,aB.g)(),createdAt:t,content:a}]}}),tG.Y5.triggerAction("commit"),(0,aj.kX)(e,{openPreview:d}))},d=()=>{let e={x:Math.max(t?.size.x||om.x,ou.x),y:Math.max(t?.size.y||om.y,ou.y)};i((0,aY.ES)({type:od})),i((0,aY.to)({type:op,data:{initialSize:e}}))},p=(t,n)=>{(0,aq.Ww)(e,e=>{if(!e.props)return e;let a=e.props.map(e=>{if(e.name!==t)return e;try{return aD.Ts.parse({...e,value:n})}catch(t){return console.error(`Invalid value for prop "${e.name}":`,t.errors),e}});return{...e,props:a}})};return o.createElement(o.Fragment,null,o.createElement(tJ.Zk,null,o.createElement(aQ.r,{titleTx:o.createElement("span",null,(0,_.t)("living_designs.properties_panel.title")),icon:o.createElement(aV.O,{onClick:d})}),o.createElement("div",{className:aG.cx.flex.flexColumn.gap12.$},o.createElement("div",{className:aG.cx.flex.flexColumn.gap8.$},!!n.messages?.length&&o.createElement("div",{className:aG.cx.flex.flexColumn.$},n.messages.map((e,t)=>o.createElement(oz,{key:e.id,message:e,artwork:0===t?o.createElement(aK.N,null):o.createElement("div",{className:aG.cx.w16.h16.flex.justifyCenter.$},o.createElement("span",{className:aG.cx.textBodyMedium.colorTextSecondary.$},(0,_.t)("living_designs.properties_panel.interactions.version_number",{number:t}))),variant:0===t?"primary":"secondary"}))),o.createElement(aJ.Ad,{label:void 0,input:o.createElement("div",{className:aG.cx.flex.gap8.$},o.createElement(oY,{value:a,placeholder:(0,_.t)("living_designs.properties_panel.description_input.placeholder"),handleChange:l,handleSubmit:c}),o.createElement(u.$n,{onClick:c,disabled:!a.length||"loading"===s.status,"aria-label":(0,_.t)("living_designs.properties_panel.interactions.add_button.label")},"loading"===s.status?o.createElement(aM.k,null):o.createElement(aF.W,null))),appendedClassName:"living_designs_panel--textareaRow--V8RnZ"}),o.createElement(aJ.Ad,{label:"Model ID",input:o.createElement(oB,null)})),n.props&&!!n.props.length&&o.createElement("div",{className:aG.cx.flex.flexColumn.gap12.$},o.createElement("span",{className:aG.cx.textBodyMediumStrong.px16.$},(0,_.t)("living_designs.properties_panel.properties_header")),n.props.map(e=>o.createElement("div",{key:e.name,className:aG.cx.$},o.createElement(oO,{prop:e,onChange:t=>p(e.name,t)})))))),o.createElement(oW,null),e.guid===t?.guid&&o.createElement(tJ.Zk,{className:oV.rq},o.createElement(aX.z,{onClick:()=>(0,aq.T9)(t),disabled:"loading"===s.status},(0,_.t)("living_designs.properties_panel.settings.reset_button"))))}function oz({message:e,artwork:t,variant:n="primary"}){return o.createElement("div",{className:aG.cx.flex.px16.py4.gap8.$},t&&o.createElement("div",{style:{"--color-icon":"var(--color-icon-assistive)"}},t),o.createElement("div",null,o.createElement("span",{className:aG.cx.textBodyMedium.case([["primary"===n,aG.cx.colorText],["secondary"===n,aG.cx.colorTextSecondary]]).$},e.content)))}function oY({value:e,placeholder:t,handleChange:n,minHeight:a,handleSubmit:r,disabled:l}){let{inputRef:i,inputProps:{onChange:s,onFocus:c,onMouseUp:d,onMouseLeave:p,onKeyUp:m}}=(0,aU.X)({onChange:function(e){n(e.target.value)}});return o.createElement(aH.v,{ref:e=>{e?.textarea&&(i.current=e.textarea)},value:e,placeholder:t,onChange:s,onFocus:c,onMouseUp:d,onMouseLeave:p,onKeyUp:m,minHeight:a,submit:r,bypassModifiers:!0,preventSubmitOnBlur:!0,disabled:l})}function oW(){let[e,t]=(0,y.fp)(aj.Zl),n=(0,r.wA)(),a=n=>{t({...e,serializer:n})};return o.createElement(tJ.Zk,null,o.createElement(aQ.r,{titleTx:o.createElement("span",null,(0,_.t)("living_designs.properties_panel.settings.header"))}),o.createElement(aJ.Ad,{label:(0,_.t)("living_designs.properties_panel.settings.serializer_dropdown"),input:o.createElement("div",{className:aG.cx.flex.flexColumn.gap4.$},o.createElement("select",{value:e.serializer,onChange:e=>a(e.target.value),className:`${aG.cx.p8.$}`},[{label:"JSX",serializer:"jsx"},{label:"Sites",serializer:"sites"},{label:"Hybrid",serializer:"hybrid"}].map(({label:e,serializer:t})=>o.createElement("option",{key:e,value:t},e)))),alwaysShowLabel:!0}),o.createElement(aJ.Ad,{label:(0,_.t)("living_designs.properties_panel.settings.eval_runs"),input:o.createElement(aW.Ht,{value:e.evaluationRuns,onValueChange:n=>{t({...e,evaluationRuns:n})},dispatch:n,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("living_designs.properties_panel.settings.eval_runs"),min:1,max:5}),alwaysShowLabel:!0}),o.createElement(aJ.Ad,{label:(0,_.t)("living_designs.properties_panel.settings.backoff_delay"),input:o.createElement(aW.Ht,{value:e.evalBackoffDelay,onValueChange:n=>{t({...e,evalBackoffDelay:n})},dispatch:n,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("living_designs.properties_panel.settings.backoff_delay"),min:0,max:6e4}),alwaysShowLabel:!0}),o.createElement(aX.z,{onClick:()=>a3(n,e)},(0,_.t)("living_designs.properties_panel.settings.create_evals_button")))}function oH(){return o.createElement(tg.i,null,o.createElement(oG,null))}var o$=n(806787),oX=n(880934),oQ=n(94500),oJ=n(832637),oq=n(742311),oj=n(259927),oZ=n(775664),o0=n(750029),o1=n(205135);class o2 extends tD.o6{render(){return o.createElement(tJ.Zk,null,o.createElement(tJ.fI,null,o.createElement(tJ.xw,null,(0,_.tx)("proto.menu.background"))),o.createElement(o8,{...this.props}))}}function o8(e){let t=o.useRef(null),n=o.useRef(null),a=(0,j.GS)(),{dispatch:r,pickerShown:l,prototypeBackgroundColor:i}=e,s=o.useCallback(()=>{let e=a?tq.findDOMNode(n.current):tq.findDOMNode(t.current);if(l&&l.id===oj.$T)r(J.XE());else if(e&&e instanceof HTMLElement){let t=(0,oI.cn)(e);r(J.u1({id:oj.$T,initialX:t.x,initialY:t.y}))}},[r,l,a]),c=o.useCallback((e,t)=>{r((0,oQ._P)({name:"Prototype Background Modified"})),tG.Y5.updateSelectionProperties({prototypeBackgroundColor:e},{shouldCommit:t})},[r]),d=(0,tb._W)(i,{r:0,g:0,b:0,a:1}),p=o.createElement("div",{className:"prototype_background_panel--colorValueContainer--CEbzl paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},o.createElement(o0.J,{onClick:s,color:d,opacity:d.a,recordingKey:tD.Pt(e,"chit"),className:"prototype_background_panel--chit--F--d0 paint_panels--chit--twQEy"}),o.createElement(o1.AN,{className:"prototype_background_panel--color--e5Pc8 paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:oZ.TI,property:d,onChange:c,recordingKey:tD.Pt(e,"colorInput"),noBorderOnFocus:!0}));return o.createElement(o.Fragment,null,a?o.createElement(oA.TN,{ref:n},p):o.createElement(tJ.fI,{ref:t,className:"prototype_background_panel--colorRow--MtNeY"},p),l&&l.id===oj.$T&&o.createElement(oP.h3,{disabledVariableIds:new Set,initialPosition:new ob.Mi(l.initialX??0,l.initialY??0),color:d,boundVariable:null,onChange:c,recordingKey:tD.Pt(e,"colorPicker")}))}o2.displayName="PrototypeBackgroundPanel";var o4=n(992271),o3=n(276660),o5=n(371435),o7=n(834447);let o6="prototype_device_panel--deviceSelect--wnOgI",o9="prototype_device_panel--deviceOption--rvW-q",re="prototype_device_panel--inactiveLabel--UEKyk prototype_device_panel--activeLabel--l162n",rt="prototype_device_panel--labelInactive--pv4Sf",rn="prototype_device_panel--deviceDropdownChevron--kq9TV",ra="prototype_device_panel--deviceDropdownInput--AxG9E";var ro=n(537545),rr=n(64111);class rl extends o3.I{}class ri extends o3.Y{}class rs extends o.PureComponent{constructor(){super(...arguments),this.deviceInfo=()=>o4.hY[this.props.prototypeDevice.presetIdentifier],this.shouldShowModelDropdown=()=>{let e=this.deviceInfo();return o4.yr[e?.deviceName||""].length>1},this.onModelChange=e=>{if(!this.deviceInfo())return;let t=o4.hY[e];if(!t)return;let n=this.props.prototypeDevice.rotation;tG.Y5.updateSelectionProperties({prototypeDevice:{type:"PRESET",size:t.framePresetSize,presetIdentifier:e,rotation:n}})},this.renderModelDropdown=(e,t,n)=>{if(!e)return;let a=o.createElement(ry,{dispatch:this.props.dispatch,presetIdentifier:this.deviceInfo().presetIdentifier,dropdownShown:this.props.dropdownShown,onChange:this.onModelChange,recordingKey:tD.Pt(this.props,"modelDropdown")}),r=t?o.createElement(oA.dx,{left:a,right:n}):o.createElement(oA.TN,null,a);return o.createElement("div",null,!this.props.isUI3&&o.createElement(tJ.hl,null,o.createElement(tJ.UZ,{className:rt},(0,_.tx)("presets.device_panel.model"))),this.props.isUI3?r:o.createElement(tJ.fI,null,a))},this.cssForCurrentDeviceRotation=()=>{if("NONE"===this.props.prototypeDevice.type)return;let e="";switch("MICROSOFT_SURFACE_PRO_4"===this.props.prototypeDevice.presetIdentifier&&(e="scale(0.65)"),this.props.prototypeDevice.rotation){case"NONE":default:return;case"CCW_90":return`rotate(-90deg) ${e}`}},this.renderDevicePreview=()=>{let e=this.deviceInfo();if(!e)return;let t=(0,tb._W)(this.props.prototypeBackgroundColor,{r:0,g:0,b:0,a:0}),n=oZ.z5.format(t),a=t.r>.9&&t.g>.9&&t.b>.9,r=`1px solid ${a?"#EFEFEF":"transparent"}`,l=o.createElement("div",{className:"prototype_device_panel--devicePreview--T2Tzn",style:{backgroundColor:n,border:r}},o.createElement("img",{className:"prototype_device_panel--deviceImage--Wpr8Y",src:e.thumbnailUrl,style:{transform:this.cssForCurrentDeviceRotation()},alt:`${e.getI18nDeviceName()}`}));return o.createElement("div",null,!this.props.isUI3&&o.createElement(tJ.hl,null,o.createElement(tJ.UZ,{className:rt},(0,_.tx)("presets.device_panel.preview"))),this.props.isUI3?o.createElement(oA.TN,{appendedClassName:o7.Rk},l):o.createElement("div",{className:"prototype_device_panel--devicePreviewContainer--pC-H4"},l))},this.onChangeOrientation=e=>{let t=this.props.prototypeDevice;if("NONE"===t.type)return;let n=t.size.y>t.size.x,a=t.rotation;a=n?"PORTRAIT"===e?"NONE":"CCW_90":"PORTRAIT"===e?"CCW_90":"NONE",tG.Y5.updateSelectionProperties({prototypeDevice:{...t,rotation:a}})},this.currentDeviceOrientation=()=>{let e=this.props.prototypeDevice;return"NONE"===e.type?"PORTRAIT":e.size.y>e.size.x?"NONE"===e.rotation?"PORTRAIT":"LANDSCAPE":"NONE"===e.rotation?"LANDSCAPE":"PORTRAIT"}}render(){let e=this.props.prototypeDevice,t=o.createElement(rm,{dispatch:this.props.dispatch,prototypeDevice:this.props.prototypeDevice,isUI3:this.props.isUI3,dropdownShown:this.props.dropdownShown,recordingKey:tD.Pt(this.props,"deviceDropdown")}),n=o.createElement(rl,{property:this.currentDeviceOrientation(),onChange:this.onChangeOrientation,recordingKey:tD.Pt(this.props,"orientationControl"),className:"prototype_device_panel--orientationControl--YdZ-v"},o.createElement(ri,{value:"PORTRAIT",svg:rr.A}),o.createElement(ri,{value:"LANDSCAPE",svg:ro.A})),a=(0,o4.$X)(e.type||"NONE",e.presetIdentifier),r=o.createElement(tJ.fI,null,t,a&&n),l=this.deviceInfo()&&this.shouldShowModelDropdown(),i=a&&!l?o.createElement(oA.dx,{left:t,right:n}):o.createElement(oA.TN,null,t),s=o.createElement(rc,{prototypeDevice:this.props.prototypeDevice,dispatch:this.props.dispatch,smallNudgeAmount:this.props.smallNudgeAmount,bigNudgeAmount:this.props.bigNudgeAmount,recordingKey:tD.Pt(this.props,"deviceSizeInputs")});return o.createElement(tJ.Zk,null,o.createElement(tJ.fI,{className:"prototype_device_panel--panelTitleRowOuter--wkKKy collapsible_property_panel--panelTitleRowOuter--i5K0R"},o.createElement(tJ.xw,{extended:this.props.isUI3},this.props.isUI3?(0,_.tx)("presets.device_panel.prototype_settings"):(0,_.tx)("presets.device_panel.device"))),this.props.isUI3?i:r,this.renderModelDropdown(!!l,a,n),this.props.isUI3&&"CUSTOM"===this.props.prototypeDevice.type&&s,this.props.isUI3&&o.createElement(o8,{pickerShown:this.props.pickerShown,dispatch:this.props.dispatch,prototypeBackgroundColor:this.props.prototypeBackgroundColor,recordingKey:tD.Pt(this.props,"backgroundPanel")}),this.renderDevicePreview(),!this.props.isUI3&&"CUSTOM"===this.props.prototypeDevice.type&&s)}}function rc(e){let t=o.useCallback(t=>{tG.Y5.updateSelectionProperties({prototypeDevice:{type:"CUSTOM",size:{x:t,y:e.prototypeDevice.size.y},rotation:e.prototypeDevice.rotation}})},[e.prototypeDevice.size.y,e.prototypeDevice.rotation]),n=o.useCallback(t=>{tG.Y5.updateSelectionProperties({prototypeDevice:{type:"CUSTOM",size:{x:e.prototypeDevice.size.x,y:t},rotation:e.prototypeDevice.rotation}})},[e.prototypeDevice.size.x,e.prototypeDevice.rotation]),a=o.createElement(aW.$j,{className:"prototype_device_panel--scrubbableInputLeftCol--P2T66 prototype_device_panel--scrubbableInput--0TFVb",inputClassName:"prototype_device_panel--leftColInput--pAJSy prototype_device_panel--input--vNirJ",dispatch:e.dispatch,value:e.prototypeDevice.size.x,onValueChange:t,smallNudgeAmount:e.smallNudgeAmount,bigNudgeAmount:e.bigNudgeAmount,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("presets.device_panel.device_width_tooltip"),tooltipForScreenReadersOnly:!0,recordingKey:tD.Pt(e,"deviceWidth")},o.createElement("span",{className:re},(0,_.tx)("proto.device_panel.width"))),r=o.createElement(aW.$j,{className:"prototype_device_panel--scrubbableInput--0TFVb",inputClassName:"prototype_device_panel--input--vNirJ",dispatch:e.dispatch,value:e.prototypeDevice.size.y,onValueChange:n,smallNudgeAmount:e.smallNudgeAmount,bigNudgeAmount:e.bigNudgeAmount,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("presets.device_panel.device_height_tooltip"),tooltipForScreenReadersOnly:!0,recordingKey:tD.Pt(e,"deviceHeight")},o.createElement("span",{className:re},(0,_.tx)("proto.device_panel.height")));return(0,j.GS)()?o.createElement(oA.dx,{left:a,right:r}):o.createElement(tJ.fI,null,a,r)}rs.displayName="PrototypeDevicePanel";class rd extends oC.l6{}class rp extends oC.c${}class rm extends tD.o6{constructor(){super(...arguments),this.formatter={format:e=>"NONE"===e?this.props.isUI3?(0,_.t)("proto.frame_preset_panel.no_device"):(0,_.t)("proto.frame_preset_panel.none"):"CUSTOM"===e?(0,_.t)("proto.frame_preset_panel.custom_size"):"PRESENTATION"===e?(0,_.t)("proto.frame_preset_panel.presentation"):e.getI18nDeviceName(),isEqual:(e,t)=>"NONE"===e||"CUSTOM"===e||"PRESENTATION"===e||"NONE"===t||"CUSTOM"===t||"PRESENTATION"===t?e===t:e.presetIdentifier===t.presetIdentifier},this.onChange=e=>{(0,oQ.$J)(e,this.props.prototypeDevice);let t=this.props.prototypeDevice.type,n=t;n="NONE"===e?"NONE":"PRESENTATION"===e?"PRESENTATION":"CUSTOM"===e?"CUSTOM":"PRESET",this.props.dispatch((0,oQ._P)({name:"Prototype Device Type Changed",params:{oldType:this.props.prototypeDevice.presetIdentifier||t,newType:e.presetIdentifier||n,isInlinePreviewOpened:y.zl.get(o5.h).modalStatus===o5.b.OPEN}}))},this.renderPresetOption=(e,t)=>{let n=(0,o4.Fh)(e,this.props.prototypeDevice);if(null===n)return null;let a=n.framePresetSize;return o.createElement(rp,{value:n,key:t,recordingKey:tD.Pt(this.props,n.deviceName)},o.createElement("div",{className:o9},o.createElement("span",null,n.getI18nDeviceName()),o.createElement("span",null,a.x,"\u200A\xd7\u200A",a.y)," "))}}render(){let e;return e="NONE"===this.props.prototypeDevice.type?"NONE":"PRESENTATION"===this.props.prototypeDevice.type?"PRESENTATION":"CUSTOM"===this.props.prototypeDevice.type?"CUSTOM":o4.hY[this.props.prototypeDevice.presetIdentifier]||"NONE",o.createElement(rd,{className:o6,chevronClassName:rn,inputClassName:ra,id:"prototype-device-select",property:e,formatter:this.formatter,onChange:this.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,dropdownClassName:"prototype_device_panel--deviceDropdown--ufbuZ",recordingKey:tD.Pt(this.props,"select"),dropdownAlignment:"right"},o.createElement(rp,{value:"NONE",recordingKey:tD.Pt(this.props,"NONE")}),o.createElement(oC.sK,null),o4.r6.map(this.renderPresetOption),o.createElement(oC.sK,null),o4.J_.map(this.renderPresetOption),o.createElement(oC.sK,null),o4.AG.map(this.renderPresetOption),o.createElement(oC.sK,null),o4.$w.map(this.renderPresetOption),o.createElement(oC.sK,null),o.createElement(rp,{value:"CUSTOM",recordingKey:tD.Pt(this.props,"CUSTOM")},o.createElement("div",{className:o9},o.createElement("span",null,(0,_.tx)("proto.frame_preset_panel.custom_size")),o.createElement("span",null,(0,_.tx)("proto.frame_preset_panel.fit")))),o.createElement(rp,{value:"PRESENTATION",recordingKey:tD.Pt(this.props,"PRESENTATION")},o.createElement("div",{className:o9},o.createElement("span",null,(0,_.tx)("proto.frame_preset_panel.presentation")),o.createElement("span",null,(0,_.tx)("proto.frame_preset_panel.fill")))),o.createElement(oC.sK,null),o4.dr.map(this.renderPresetOption))}}rm.displayName="DeviceDropdown";class ru extends oC.l6{}class rE extends oC.c${}class ry extends tD.o6{constructor(){super(...arguments),this.formatter={format:e=>{let t=o4.hY[e];return t?t.getI18nStyleName():(0,_.t)("proto.frame_preset_panel.missing")},isEqual:(e,t)=>e===t},this.renderStyleOption=(e,t)=>{let n=e.presetIdentifier;return o.createElement(rE,{value:n,key:t,recordingKey:tD.Pt(this.props,n)},o4.hY[n].getI18nStyleName())}}render(){let e=o4.hY[this.props.presetIdentifier];if(!e)return null;let t=o4.yr[e.deviceName],n=this.props.presetIdentifier;return o.createElement(ru,{className:o6,chevronClassName:rn,inputClassName:ra,id:"prototype-style-select",property:n,formatter:this.formatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,dropdownClassName:"prototype_device_panel--modelDropdown--WbHYJ",recordingKey:tD.Pt(this.props,"select")},t.map(this.renderStyleOption))}}ry.displayName="ModelDropdown";var r_=n(45623),rg=n(536825),rh=n(304061),rv=n(939683),rf=n(529004),rS=n(860601),rb=n(163023),rT=n(723081),rN=n(46878),rI=n(634238),rP=n(234945),rC=n(279702),rA=n(113468),rk=n(107244),rw=n(248752);function rO(e){return e??"Default"}let rx=o.createContext({getNodeName:rO}),rD=o.memo(function({getNodeName:e=rO,children:t}){let n=o.useMemo(()=>({getNodeName:e}),[e]);return o.createElement(rx.Provider,{value:n},t)});var rR=n(325682),rM=n(73349),rL=n(38340),rV=n(908946),rK=n(987850),rF=n(239737),rU=n(222478),rB=n(709731),rG=n(30075),rz=n(384775),rY=n(406385),rW=n(623590);function rH(){let e=(0,r.wA)(),t=(0,r.d4)(e=>(0,tN.Yh)(e.mirror.appModel,rU.JT.MAGIC_LINK)),n=(0,rF.PE)(),{withinMeter:a}=(0,rK.X)(rU.JT.MAGIC_LINK);return n&&a?o.createElement("span",{className:"magic_link--magicLinkButton--CWefW","data-testid":"magic-link-entry"},o.createElement(a9.K,{recordingKey:tD.Pt("prototypeInteractionList","magicLinkButton"),"aria-label":(0,_.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip"),onClick:()=>{(0,rz.$I)({moduleToOpen:{type:"custom",module:o.createElement(rY.p,null),name:rG.Sn.MAGIC_LINK,beforeModuleOpen:()=>{e((0,oQ.Zh)({name:"prototype.ai_magic_link_entry_clicked",params:{source:"properties_panel"}})),(0,rB.B3)(rU.JT.MAGIC_LINK),t&&(0,rB.Ag)(rU.JT.MAGIC_LINK,rW.e,{})}},trackingData:{source:"prototype_magic_link_triggered"}})},htmlAttributes:{"data-tooltip":(0,_.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip"),"data-tooltip-type":t2.Ib.TEXT,"data-tooltip-show-above":!0}},o.createElement(rV.B,null))):null}var r$=n(422237);let rX=(0,r$.ex)("prototype_info",function(e){let{tooltipText:t}=e;return o.createElement("div",{className:aG.cx.flex.justifyCenter.itemsCenter.$},o.createElement("span",{className:aG.cx.m6.flexGrow1.$,style:{maxWidth:144}},t))},e=>({tooltipText:e.getAttribute("data-tooltip-text")}));var rQ=n(139055),rJ=n(447141),rq=n(930269),rj=n(819785),rZ=n(695038),r0=n(612325);let r1=new rT.JV,r2=new rT.Eq,r8=new rT.sX,r4=o.memo(function({filterInteractionCategory:e}){let t=(0,r.wA)(),n=(0,r.d4)(rL.Cy),a=(0,r.d4)(rL.n9),l=(0,r.d4)(rL.DV),c=(0,r.d4)(r6),d=(0,r.d4)(rP.dK),p=(0,r.d4)(rP.Xt),m=(0,rL.a2)(),u=(0,rL.R)(),E=(0,r.d4)(le),y=(0,r.d4)(r7),_=Object.keys(p).length>1,g=lt(),h=function(){let e=lt(),t=(0,r.d4)(r9);return!!e&&!!t&&t.selectionOverrides[i.YnC.PROTOTYPE_INTERACTIONS]}(),v=(0,ee.q5)(),f=(0,rv.U)(),S=(0,tn.cJ)(),b=o.useMemo(()=>new rT.cP(d),[d]),T=o.useCallback(e=>b.format(e),[b]),N=o.useRef(null),I=e=>{tG.Y5.updateSelectionProperties({prototypeInteractions:e},{shouldCommit:rC.zk.NO_BUT_TRACK_AS_EDIT}),tG.Y5.commit()},P=(0,oq.Zj)(Object.keys(p)),C=o.createElement(r3,{interactionGroups:m,inheritedInternalInteractionGroups:u,mixed:_,isOrInInstance:g,openFile:v,dispatch:t,currentSelectedProperty:c,onChange:(e,t)=>{let o=e.map(e=>e.interactions).reduce((e,t)=>e.concat(t),[]),r=new Set,l=[];for(let e of o){let t=oX.dI(e.id);if(t&&!r.has(t))l.push(e);else{if(!(t=i.glU.generateUniqueID()))continue;let n=oX.sH(t);if(!n)continue;l.push({...e,id:n})}t&&r.add(t)}t===rA.J.NORMAL?l=[...l,...a]:t===rA.J.INHERITED_INTERNAL&&(l=[...n,...l]),I(l)},onAddProperty:e=>{e.stopPropagation();let t=[],o=[];for(let e of Object.keys(p)){let n=i.glU.generateUniqueID();if(!n)return;let a=oX.sH(n);if(!a)return;let r={id:a,sourceNodeID:oX.sH(e)??oX.Hr,event:{interactionType:function(e,t=!1){let n=new Set;for(let{event:t}of e)n.add(t.interactionType);for(let e of ln)if((!(0,s.kc)().sts_interaction_interop||!t||"DRAG"!==e)&&!n.has(e))return e;return"ON_KEY_DOWN"}(m,S)}};r.stateManagementVersion=1,r.actions=[{connectionType:"NONE"}],t.push(r);let l=(0,rh.kh)(d,e);o.push(l?l.guid:"")}let r=t.map(e=>rf.d({nodeID:e.sourceNodeID,interactionID:e.id}));if(r.length>0){i.glU.setSelectedInteractions(r);let e=tq.findDOMNode(N.current),t=(0,oI.cn)(e);li(new ob.Mi(t.x,t.y+(0,np.jz)(rq.rightNavGridRowHeight)))}let l=[...n,...t,...a];f("prototype_interaction_added",{interactionCount:l.length,sourceTlfIds:JSON.stringify(o)}),I(l)},onDeleteProperty:(e,t)=>{let n=(t===rA.J.NORMAL?m:u).filter((t,n)=>e.has(n)),a=[];for(let e of n)a.push(...e.interactions);let o=ll(a);tk.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(o)),tG.Y5.deselectProperty()},shouldIgnoreKeyboardEvents:l.length>0||c.type!==i.rrT.PROTOTYPE_INTERACTION&&c.type!==i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,isValidPrototypingSourceSelected:E,showResetInteractionsButton:h,toggleScrollBehaviorPicker:()=>{if(y?.id===oj.AO)t(J.XE());else{let e=tq.findDOMNode(N.current),n=(0,oI.cn)(e);t(J.u1({id:oj.AO,initialX:n.x,initialY:n.y}))}},headerAccessory:P&&o.createElement(rH,null),inSites:S,filterInteractionCategory:e});return o.createElement(rD,{getNodeName:T},S?C:o.createElement(tJ.Zk,{"data-onboarding-key":"prototypePanel",ref:N,"data-testid":"prototype-interaction-list"},C))});function r3(e){let t=o.useRef(!1),n=(0,j.GS)(),a=(0,s.kc)().sts_interaction_interop&&!!e.filterInteractionCategory,r=!a||e.filterInteractionCategory===rA.J.NORMAL,l=e.isOrInInstance&&e.inheritedInternalInteractionGroups.length>0,c=a?e.filterInteractionCategory===rA.J.INHERITED_INTERNAL&&l:l,d=n?o.createElement("div",{className:"prototype_interaction_list--categoryRow--Xxfm4"},o.createElement(of.J,{className:"prototype_interaction_list--categoryLabel--0dGOM"},(0,_.tx)("proto.interaction_list.variant_interactions"))):o.createElement(tJ.fI,null,o.createElement(tJ.UZ,{className:"prototype_interaction_list--label--dGwgy"},(0,_.tx)("proto.interaction_list.variant_interactions")));return o.createElement(o.Fragment,null,r&&o.createElement(rw.h6,{title:e.inSites?"":(0,_.t)("proto.title_interactions"),stylePickerShown:{isShown:!1},addProperty:e.onAddProperty,toggleScrollBehaviorPicker:e.toggleScrollBehaviorPicker,hideAddButton:!e.isValidPrototypingSourceSelected,renderProperty:(n,a,r,l,i,c,d,p,m)=>!(0,s.kc)().sts_interaction_interop&&e.inSites&&(0,rQ.p4)(n.interactions)?o.createElement(o.Fragment,{key:a}):o.createElement(r5,{interactionGroups:e.interactionGroups,interactionGroup:n,index:a,selected:r,hasFocus:i,isDragging:l,singletonRow:e.interactionGroups.length<=1,onMouseDown:d,onMouseMove:p,onMouseUp:m,dispatch:e.dispatch,category:rA.J.NORMAL,autoOpenVariablePicker:t,recordingKey:tD.Pt("prototypeInteractionList",a),key:a,inSites:e.inSites}),openFile:e.openFile,onChange:t=>e.onChange(t,rA.J.NORMAL),currentSelectedProperty:e.currentSelectedProperty,selectedPropertyType:i.rrT.PROTOTYPE_INTERACTION,propertyList:e.interactionGroups,pickerShown:null,dispatch:e.dispatch,onDeleteProperty:t=>e.onDeleteProperty(t,rA.J.NORMAL),shouldIgnoreKeyboardEvents:e.shouldIgnoreKeyboardEvents,recordingKey:"prototypeInteractionList",boldHeaderRow:e.interactionGroups.length>=1||e.inheritedInternalInteractionGroups.length>=1,showResetInteractionsButton:e.showResetInteractionsButton,onResetInteractions:tk.nc.user("reset-instance-interactions",()=>i.glU.resetSymbolOverrides(i.YnC.PROTOTYPE_INTERACTIONS)),headerAccessory:e.headerAccessory}),c&&d,c&&o.createElement(rw.h6,{title:"",stylePickerShown:{isShown:!1},addProperty:rS.lQ,hideAddButton:!0,toggleScrollBehaviorPicker:e.toggleScrollBehaviorPicker,renderProperty:(n,a,r,l,i,s,c,d,p)=>o.createElement(r5,{interactionGroups:e.inheritedInternalInteractionGroups,interactionGroup:n,key:a,index:a,selected:r,hasFocus:i,isDragging:l,singletonRow:e.inheritedInternalInteractionGroups.length<=1,onMouseDown:c,onMouseMove:d,onMouseUp:p,dispatch:e.dispatch,category:rA.J.INHERITED_INTERNAL,autoOpenVariablePicker:t,recordingKey:tD.Pt("prototypeInheritedInternalInteractionList",a),inSites:e.inSites}),openFile:e.openFile,onChange:t=>e.onChange(t,rA.J.INHERITED_INTERNAL),currentSelectedProperty:e.currentSelectedProperty,selectedPropertyType:i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,propertyList:e.inheritedInternalInteractionGroups,pickerShown:null,dispatch:e.dispatch,onDeleteProperty:t=>e.onDeleteProperty(t,rA.J.INHERITED_INTERNAL),shouldIgnoreKeyboardEvents:e.shouldIgnoreKeyboardEvents,recordingKey:tD.Pt("prototypeInheritedInternalInteractionList")}))}function r5({interactionGroups:e,interactionGroup:t,index:n,hasFocus:a,isDragging:l,selected:c,singletonRow:d,onMouseDown:p,onMouseMove:m,onMouseUp:u,dispatch:E,category:g,recordingKey:h,inSites:v}){let f=(0,j.GS)(),{getNodeName:S}=o.useContext(rx),b=(0,r.d4)(rL.DV),T=(0,rL.a2)(),N=(0,r.d4)(r7),I=N?.id===oj.o$?N:null,P=(0,r.d4)(rP.dK),[C,A]=o.useState(!1),k=(0,y.md)(rI.NE)?r2:r1,w=o.useContext(rQ.qd),O=function(e,t){let n=new Set(t.map(e=>{let t=rf.s(e);return t?oX.dI(t.interactionID):""}).filter(e=>""!==e));for(let t of e.interactions){let e=oX.dI(t.id);if(e&&n.has(e))return!0}return!1}(t,b),x=o.useRef(null),D=o.useRef(null),R=o.useCallback(()=>{let e=f&&v?D.current:tq.findDOMNode(x.current);li((0,oI.cn)(e))},[v,f]),M=o.useCallback(()=>{i.glU.setSelectedInteractions([]),E(J.XE()),tG.Y5.deselectProperty()},[E]),L=n=>{if(!x||!D)return;let a=lr(t);if(n.metaKey||n.ctrlKey)O?a=b.filter(e=>!a.includes(e)):a.push(...b);else if(n.shiftKey){var o;let n,r;let l=(o=t.key,e.findIndex(({key:e})=>e===o));if(-1===l)return;let i=function(e,t){let n=1/0,a=e;for(let o of t){let t=Math.abs(e-o);t<n&&(a=o,n=t)}return a}(l,function(e,t){let n=new Set,a=new Set(t);for(let t=0;t<e.length;t++)lr(e[t]).some(e=>a.has(e))&&n.add(t);return n}(e,b)),s=(n=l,r=i,l>i&&(n=i,r=l),e.slice(n,r+1));for(let e of(a=[...b],s))a.push(...lr(e))}i.glU.setSelectedInteractions(a),tG.Y5.updateAppModel({currentSelectedProperty:{type:g===rA.J.NORMAL?i.rrT.PROTOTYPE_INTERACTION:i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,indices:[]}}),a.length?I&&I.shouldPin?v&&(a.length>1||a.includes(b[0]))&&M():R():M()},V=(0,r.d4)(rk.ZM),K=!1,F=null,U=null;for(let e of t.interactions)if(!F&&e.actions&&e.actions.length>0)F=e.actions[0],U=e;else if(lo(F,S,f,V)!=lo((e.actions??[])[0],S,f,V)){K=!0;break}let B=()=>{let e=ll(t.interactions);i.glU.hoverInteractions(e),A(!0)},G=()=>{i.glU.hoverInteractions([]),A(!1)},z=e=>{e.stopPropagation()},Y=e=>{e.stopPropagation();let n=ll(t.interactions);tk.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(n)),tG.Y5.deselectProperty(),tG.Y5.commit()},W=!1,H=!1;if(g===rA.J.NORMAL){for(let e of t.interactions){if(!e.actions||0===e.actions.length)continue;let t=e.actions[0];if(!t||"SWAP_STATE"!==t.navigationType)continue;let n="";if(t.transitionNodeID){let e=P.get(oX.dI(t.transitionNodeID));if(e){if(e.isState)n=e.parentGuid||"";else{W=!0;break}}}let a=i.glU.getContainingStateGroupOrSelf(oX.dI(e.sourceNodeID??oX.Hr))||"";if(""===a||""!==n&&a!==n){W=!0;break}}let n=["ON_CLICK","MOUSE_DOWN","MOUSE_UP"].includes(t.event.interactionType??""),a=e.some(e=>"ON_HOVER"===e.event.interactionType);H=n&&a}W=g!==rA.J.INHERITED_INTERNAL&&W;let $=function(e,t,n){if(e!==rA.J.INHERITED_INTERNAL)return null;let a=n.find(e=>e.key===t.key&&e.interactions.length===t.interactions.length&&1===t.interactions.length&&function(e,t){let n=void 0!==e.actions&&e.actions.length>=1,a=void 0!==t.actions&&t.actions.length>=1;if(!n||!a)return!1;let o=e.actions.every(e=>"UPDATE_MEDIA_RUNTIME"===e.connectionType),r=e.actions.every(e=>oX.fn(e.transitionNodeID));var l=!1;for(let e of t.actions)if("INTERNAL_NODE"===e.connectionType&&"SWAP_STATE"===e.navigationType){l=!0;break}return o&&r&&l}(e.interactions[0],t.interactions[0]));return a?.interactions[0]??null}(g,t,e),X=(0,tO.ZC)($),Q=(0,rv.U)();if(o.useEffect(()=>{null===X&&$&&Q("prototype_interaction_conflict_override_created",{interaction_type:t.interactions[0].event?.interactionType,action_type:$.event?.interactionType})}),(0,s.kc)().sts_interaction_interop&&t.event.interactionType&&w&&w!==(0,rR.hD)(t.event.interactionType)||(0,s.kc)().sts_interaction_interop&&"mouse"===w&&(0,rQ.zL)(t.interactions))return null;let q=g===rA.J.INHERITED_INTERNAL&&T.some(e=>e.key===t.key)&&!$,Z=c&&a,ee=O&&!c,et=new rT.js(f,V),en=(0,rT.mj)(F),ea=U?.actions?.length??0,eo=(0,s.kc)().sts_interaction_interop&&ea>1?(0,_.t)("sites.panel.interaction_summary",{numActions:ea}):K||!F||"NONE"===en?void 0:et.format(en),er=o.createElement(r_.Z,null),el=W||H||q,ei=W?(0,_.t)("proto.prototype_panel.this_interaction_must_swap_from_a_variant_to_another_variant_within_the_same_component_set_tooltip"):H?(0,_.t)("proto.prototype_panel.prototype_multiple_interactions_mouse_and_hover_tooltip"):q?(0,_.t)("proto.prototype_panel.this_interaction_will_not_be_triggered_as_interactions_on_instances_are_triggered_before_inherited_internal_interactions_tooltip"):"",es=o.createElement(aJ.Y9,{ref:D,"data-testid":`prototypeInteractionItem-${n}`,singletonRow:d,dragging:l,onMouseDown:p,onMouseMove:m,onMouseUp:u,onMouseEnter:B,onMouseLeave:G,recordingKey:tD.Pt(h,"draggableRow"),onClick:(0,s.kc)().sts_interaction_interop?L:rS.lQ},o.createElement(aJ.s2,{label:null,leftIcon:o.createElement(tJ.YW,{onClick:(0,s.kc)().sts_interaction_interop?rS.lQ:L,selected:ee&&!!I,recordingKey:tD.Pt(h,"interactionIcon"),onMouseDown:z,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":el?ei:la(t.event,k,!!v),className:C&&(0,s.kc)().sts_interaction_interop?rJ.zY:void 0},el?er:(0,rN.e7)(t.event.interactionType)),input:o.createElement(nv.D8,{onClick:(0,s.kc)().sts_interaction_interop?rS.lQ:L,onMouseDown:z,recordingKey:tD.Pt(h,"interactionText")},la(t.event,k,!!v),eo&&o.createElement("span",{className:"prototype_interaction_list--summaryText--hGpp4"},"\xa0\xb7\xa0",eo)),rightIcon:o.createElement("div",{hidden:(0,s.kc)().sts_interaction_interop&&!C},o.createElement(a9.K,{onClick:Y,"aria-label":(0,_.t)("proto.prototype_panel.remove_interaction_tooltip"),recordingKey:tD.Pt(h,"removeButton"),htmlAttributes:{onMouseDown:z}},o.createElement(t1.U,{svg:rj.A,fallbackSvg:rZ.A},o.createElement(rg.O,null))))}));return v?es:o.createElement("div",null,o.createElement(tQ.e,{ref:x,className:f?"prototype_interaction_list--interactionListRow---i0Rg ui3_rows--ui3OneInputOneIconRow--SMoQ9 ui3_rows--_row--DnZFk ui3_rows--_grid--cP2Wu":void 0,"data-testid":`prototypeInteractionItem-${n}`,selected:Z,selectedSecondary:ee,singletonRow:d,dragging:l,onMouseDown:p,onMouseMove:m,onMouseUp:u,onMouseEnter:B,onMouseLeave:G,recordingKey:tD.Pt(h,"draggableRow")},o.createElement(nv.D8,{className:t4()({"prototype_interaction_list--interactionButton--q-58Q":!0,"prototype_interaction_list--interactionButtonSelected--8YX9A":Z,"prototype_interaction_list--interactionButtonSelectedSecondary--Nx73L":ee}),onClick:L,onMouseDown:z,recordingKey:h},el&&o.createElement(rb.B,{className:"prototype_interaction_list--warningIcon--Mgr5O",svg:r0.A,"data-tooltip-type":t2.Ib.SPECIAL,"data-tooltip":rX,"data-tooltip-text":ei}),o.createElement("div",{className:el?"prototype_interaction_list--interactionNameShort--5UMLL prototype_interaction_list--interactionName--zQsSL":"prototype_interaction_list--interactionName--zQsSL"},la(t.event,k,!!v)),o.createElement(t1.U,{className:"prototype_interaction_list--actionIcon--x-haP",svg:K?(0,rN.Yb)("NONE"):(0,rN.Yb)((0,rT.mj)(F))},(0,rN.av)((0,rT.mj)(F))),o.createElement("div",{className:"prototype_interaction_list--targetText--UMXyE",dir:"auto"},K?(0,_.t)("proto.variant_actions.mixed"):g===rA.J.INHERITED_INTERNAL?(0,_.t)("proto.variant_actions.change_to"):lo(F,S,f,V))),o.createElement("span",{className:"prototype_interaction_list--removeButton--g6aiQ"},o.createElement(a9.K,{onClick:Y,"aria-label":(0,_.t)("proto.prototype_panel.remove_interaction_tooltip"),recordingKey:tD.Pt(h,"removeButton"),htmlAttributes:{onMouseDown:z}},o.createElement(t1.U,{svg:rj.A,fallbackSvg:rZ.A},o.createElement(rg.O,null))))))}function r7(e){return e.pickerShown}function r6(e){return e.mirror.appModel.currentSelectedProperty}function r9(e){return e.mirror.selectionProperties.resettableInstanceOverrides}function le(e){return e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0}function lt(){let e=(0,r.d4)(rP.Xt),t=(0,r.d4)(rP.dK);for(let n of Object.keys(e)){let e=t.get(n);if(e&&("INSTANCE"===e.type||e.isInstanceSublayer))return!0}return!1}let ln=["ON_CLICK","DRAG","ON_HOVER","ON_PRESS","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"];function la(e,t,n){let a=t.format(e.interactionType??"NONE");if("ON_KEY_DOWN"===e.interactionType&&e.keyTrigger&&e.keyTrigger.keyCodes){let t=(0,rM._i)(e.keyTrigger.keyCodes),o=(0,rM.E8)(e.keyTrigger,!0);if("KEYBOARD"===e.keyTrigger.triggerDevice&&t)return(0,s.kc)().sts_interaction_interop&&n?(0,rM.U8)(t):a+" ("+(0,rM.U8)(t)+")";if(o)return(0,s.kc)().sts_interaction_interop&&n?o:a+" ("+o+")"}return a}function lo(e,t,n,a){let o=new rT.js(n,a);if(!e)return o.format("NONE");let r=(0,rT.mj)(e);switch(r){case"NONE":case"GO_BACK":case"CLOSE_OVERLAY":case"SET_VARIABLE":case"SET_VARIABLE_MODE":case"CONDITIONAL":return o.format(r);case"OPEN_URL":if(null!=e.connectionURL){if((0,tb.gl)(e.connectionURL))return(0,_.t)("fullscreen.mixed");return e.connectionURL.replace(/https?:\/\//,"")}return o.format("NONE");case"UPDATE_MEDIA_PLAY":case"UPDATE_MEDIA_PAUSE":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":case"UPDATE_MEDIA_MUTE":case"UPDATE_MEDIA_UNMUTE":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":case"UPDATE_MEDIA_SKIP_FORWARD":case"UPDATE_MEDIA_SKIP_BACKWARD":case"UPDATE_MEDIA_SKIP_TO":return r8.format(e)}return e.transitionNodeID?(0,tb.gl)(e.transitionNodeID)?(0,_.t)("fullscreen.mixed"):t(oX.dI(e.transitionNodeID)):o.format("NONE")}function lr(e){return e.interactions.filter(e=>e.id&&e.sourceNodeID).map(e=>rf.d({nodeID:e.sourceNodeID,interactionID:e.id}))}function ll(e){let t=[];for(let n of e){let{sourceNodeID:e,id:a}=n;e&&a&&t.push(rf.d({nodeID:e,interactionID:a}))}return t}function li(e){tG.Y5.triggerAction("show-prototype-interaction-edit-modal",{args:{source:i.yxn.PROPERTIES_PANEL,x:e.x,y:e.y}})}var ls=n(889157),lc=n(797613),ld=n(974985),lp=n(256981),lm=n(43604);let lu=(0,o.memo)(function(e){return o.createElement("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e},o.createElement("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M14 7.879v-1.88a1 1 0 0 0-1.707-.706L9.586 8H7.5A1.5 1.5 0 0 0 6 9.5v5c0 .383.144.733.38.998l.711-.71A.5.5 0 0 1 7 14.5v-5a.5.5 0 0 1 .5-.5H10l2-2 1-1v2.879zm0 4.242-1 1V18l-1-1-1.44-1.44-.706.708 2.439 2.439A1 1 0 0 0 14 18v-5.88m2.069-2.068.71-.71a3.501 3.501 0 0 1-1.217 5.993c-.29.092-.562-.144-.562-.448v-.03c0-.237.17-.437.392-.522a2.5 2.5 0 0 0 .677-4.283m-1.013 1.013.172-.172c.113-.056.248-.044.36.073.255.269.412.632.412 1.033s-.157.764-.412 1.033c-.238.25-.588.02-.588-.326v-1.415a.5.5 0 0 1 .056-.226m2.798-4.92a.5.5 0 0 1 0 .708l-11 11a.5.5 0 1 1-.708-.707l11-11a.5.5 0 0 1 .708 0",clipRule:"evenodd"}))});var lE=n(875533),ly=n(697945),l_=n(477633),lg=n(564734),lh=n(68710),lv=n(632319);function lf({videoPlayback:{mediaLoop:e,muted:t}}){let n=null;return(0,tb.gl)(e)&&(0,tb.gl)(t)?n=(0,_.tx)("proto.prototype_panel.replace_mixed_muted_and_loop_video_playback",{loopSvg:o.createElement(rb.B,{svg:l_.A,className:ly.eT}),speakerSvg:o.createElement(rb.B,{svg:lh.A,className:ly.To})}):(0,tb.gl)(e)?n=(0,_.tx)("proto.prototype_panel.replace_mixed_video_playback",{svg:o.createElement(rb.B,{svg:l_.A,className:ly.eT})}):(0,tb.gl)(t)&&(n=(0,_.tx)("proto.prototype_panel.replace_mixed_video_playback",{svg:o.createElement(rb.B,{svg:lh.A,className:ly.To})})),n?o.createElement(tJ.fI,null,o.createElement(tJ.UZ,{className:ly.pc},n)):null}let lS=e=>(0,tb.gl)(e)?"mixed":e,lb=e=>!0===e,lT=function(e){let t=()=>{let t=!lb(e.videoPlayback.mediaLoop);e.updateSelectionProperties({videoMediaLoop:t}),e.dispatch((0,oQ._P)({name:"Node video loop changed",params:{newLoop:t,oldLoop:lS(e.videoPlayback.mediaLoop),numVideosSelected:e.videoPlayback.numVideosSelected}}))},n=()=>{let t=!e.videoPlayback.muted;e.updateSelectionProperties({videoMuted:t}),e.dispatch((0,oQ._P)({name:"Node video muted changed",params:{newMuteValue:t,oldMuteValue:lS(e.videoPlayback.muted),numVideosSelected:e.videoPlayback.numVideosSelected}}))},a=o.createElement("span",{className:(0,j.GS)()?void 0:ly.hW},o.createElement(ov.S,{label:o.createElement(of.J,{htmlAttributes:{"data-tooltip":(0,_.t)("proto.prototype_panel.default_video_playback_state"),"data-tooltip-type":t2.Ib.TEXT}},(0,_.tx)("proto.prototype_panel.autoplay")),onChange:t=>{e.updateSelectionProperties({videoAutoplay:t}),e.dispatch((0,oQ._P)({name:"Node video autoplay Changed",params:{newAutoplay:t,oldAutoplay:lS(e.videoPlayback.autoplay),numVideosSelected:e.videoPlayback.numVideosSelected}}))},checked:lb(e.videoPlayback.autoplay),mixed:(0,tb.gl)(e.videoPlayback.autoplay)})),r=(0,j.GS)()?o.createElement(lc.f,{checked:lb(e.videoPlayback.mediaLoop),mixed:(0,tb.gl)(e.videoPlayback.mediaLoop),onIcon:o.createElement(t1.U,{svg:l_.A},o.createElement(ld.p,null)),offIcon:o.createElement(t1.U,{svg:lg.A},o.createElement(lp.U,null)),onChange:t,recordingKey:tD.Pt(e,"videoLoopToggle"),"aria-label":(0,_.t)("proto.prototype_panel.loop"),htmlAttributes:{"data-tooltip":(0,_.t)("proto.prototype_panel.loop"),"data-tooltip-type":t2.Ib.TEXT}}):o.createElement(lE.m,{toggled:lb(e.videoPlayback.mediaLoop),svg:e.videoPlayback.mediaLoop?l_.A:lg.A,fallbackSvg:e.videoPlayback.mediaLoop?l_.A:lg.A,onMouseDown:t,recordingKey:tD.Pt(e,"videoLoopToggle"),"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("proto.prototype_panel.loop"),dataTestId:"videoLoopToggle",className:ly.BM}),l=(0,j.GS)()?o.createElement(lc.f,{checked:lb(!e.videoPlayback.muted),mixed:(0,tb.gl)(e.videoPlayback.muted),onIcon:o.createElement(t1.U,{svg:lh.A},o.createElement(lm.L,null)),offIcon:o.createElement(t1.U,{svg:lv.A},o.createElement(lu,null)),onChange:n,recordingKey:tD.Pt(e,"videoSoundToggle"),"aria-label":(0,_.t)("proto.prototype_panel.sound"),htmlAttributes:{"data-tooltip":(0,_.t)("proto.prototype_panel.sound"),"data-tooltip-type":t2.Ib.TEXT}}):o.createElement(lE.m,{toggled:!e.videoPlayback.muted,svg:lb(e.videoPlayback.muted)?lv.A:lh.A,fallbackSvg:lb(e.videoPlayback.muted)?lv.A:lh.A,onMouseDown:n,recordingKey:tD.Pt(e,"videoSoundToggle"),"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("proto.prototype_panel.sound"),dataTestId:"videoSoundToggle",className:ly.BM}),i=(0,j.GS)()?o.createElement(aJ.pG,{input:a,leftIcon:r,rightIcon:l}):o.createElement(tJ.fI,{className:ly.kh},a,o.createElement("div",{className:ly.zc},r,l));return o.createElement(tJ.Zk,null,o.createElement(tJ.fI,null,o.createElement(tJ.xw,{extended:!0},(0,_.tx)("proto.prototype_panel.video"))),i,o.createElement(lf,{videoPlayback:e.videoPlayback}))};var lN=n(794272),lI=n(555074),lP=n(420450),lC=n(955136);function lA(e){let{type:t}=e;return o.createElement("div",{className:aG.cx.flex.justifyCenter.itemsCenter.$},o.createElement(rb.B,{className:aG.cx.flexGrow1.mx12.$,useOriginalSrcFills_DEPRECATED:!0,svg:"horizontal"===t?lP.A:lC.A}),o.createElement("span",{className:aG.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,_.tx)("proto.prototype_panel.content_needs_to_be_bigger_than_the_frame_tooltip")))}let lk=(0,r$.ex)("prototype_scroll_horizontal_info",lA,()=>({type:"horizontal",unconstrainWidth:!0})),lw=(0,r$.ex)("prototype_scroll_vertical_info",lA,()=>({type:"vertical",unconstrainWidth:!0}));var lO=n(234587);let lx="scroll_behavior_panel--inactiveLabel--IexW8",lD="scroll_behavior_panel--inactiveLabelContainer--lQjAi";var lR=n(591363);function lM(e){let{scrollDirection:t,showScrollWarning:n,disableOverflowBehaviorItem:a,disableScrollBehaviorItem:l,dropdownShown:s,updateSelectionProperties:c}=e,d=(0,r.wA)(),[p,m]=function(){let e=(0,A.J2)(i.Ez5.propertiesPanelState().shownPropertiesPanels)[i.ibQ.OVERFLOW_ITEM],t=(0,lO.cJ)(),n=(0,lI.kl)("isSection"),a=(0,lI.kl)("anyTopLevelFramesInSelection");return[e,!t&&!n&&!a]}(),u=(0,j.GS)()?o.createElement(aQ.mS,{titleTx:(0,_.tx)("proto.scroll_panel.scroll_behavior_title")}):o.createElement(tJ.fI,null,o.createElement(tJ.xw,{className:"scroll_behavior_panel--panelTitle--kN-Nl"},(0,_.tx)("proto.scroll_panel.scroll_behavior_title")));return p||m?o.createElement(tL.k,{name:"scroll_behavior_panel"},o.createElement(tJ.Zk,null,u,m&&o.createElement(tJ.fI,null,o.createElement("div",{className:lD},o.createElement("span",{className:lx},(0,_.tx)("proto.scroll_panel.position_dropdown.position"))),o.createElement(lG,{recordingKey:tD.Pt(e,"scrollBehavior"),dropdownShown:s,disabled:l})),p&&o.createElement(tJ.fI,null,o.createElement("div",{className:lD},o.createElement("span",{className:lx},(0,_.tx)("proto.scroll_panel.overflow_dropdown.overflow"))),n&&o.createElement(rb.B,{className:"scroll_behavior_panel--infoIcon--FeXbf",svg:lR.A,useOriginalSrcFills_DEPRECATED:!0,"data-tooltip-type":t2.Ib.SPECIAL,"data-tooltip":"HORIZONTAL"===t?lk:lw,"data-tooltip-show-immediately":!0}),o.createElement(lF,{className:n?"scroll_behavior_panel--scrollDirectionShort--w6iSo":"scroll_behavior_panel--scrollDirection--XSmzK",property:t,dispatch:d,dropdownShown:s,onChange:e=>{d((0,oQ._P)({name:"Overflow Behavior changed",params:{newDirection:e,oldDirection:(0,tb._W)(t,"MIXED")}})),c({scrollDirection:e})},disabled:a,recordingKey:tD.Pt(e,"scrollDirection")})))):null}class lL extends oC.c${}class lV extends oC.l6{}let lK=["NONE","HORIZONTAL","VERTICAL","BOTH"];class lF extends o.PureComponent{render(){return o.createElement(lV,{id:"scroll-direction-select",className:this.props.className,chevronClassName:"scroll_behavior_panel--scrollDirectionChevron--5keRt",inputClassName:"scroll_behavior_panel--scrollDirectionInput--vJSqu",property:this.props.property||"NONE",formatter:rT.Rk,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,disabled:this.props.disabled,recordingKey:this.props.recordingKey,dataTestId:"scroll-direction-dropdown"},lK.map(e=>o.createElement(lL,{key:e,value:e,recordingKey:tD.Pt(this.props,e)})))}}lF.displayName="ScrollDirectionDropdown";class lU extends oC.l6{}class lB extends oC.c${}function lG(e){let t=(0,r.wA)(),n=(0,lI.kl)("scrollBehavior"),{fixedScrollingDisabled:a}=(0,lN.R)(e=>{let t=e.mirror.selectionProperties;return{fixedScrollingDisabled:!t.nodesAreAllNotInStacksOrAbsolutePositioned||!t.allHaveScrollableFrameAsParent}}),l="scroll-behavior-select",s=e.dropdownShown&&e.dropdownShown.type===l?rT.Ge:rT.wi;return o.createElement(lU,{id:l,className:"scroll_behavior_panel--scrollPosition--YAyUM",formatter:s,property:n||"SCROLLS",onChange:e=>{t((0,oQ._P)({name:"Node Scroll Behavior Changed",params:{newValue:e}}));let n="FIXED_WHEN_CHILD_OF_SCROLLING_FRAME"===e?i.KjJ.FIXED:"STICKY_SCROLLS"===e?i.KjJ.STICKY_SCROLLS:i.KjJ.SCROLLS;tk.l7.user("set-scroll-behavior",()=>i.X3B.aggressivelySetScrollBehaviorOfSelection(n)),tG.Y5.commit()},dispatch:t,dropdownShown:e.dropdownShown,dropdownClassName:"scroll_behavior_panel--fullWidth--reSmx",recordingKey:e.recordingKey,disabled:e.disabled,dataTestId:"scroll-behavior-dropdown"},o.createElement(lB,{value:"SCROLLS"}),o.createElement(lB,{value:"FIXED_WHEN_CHILD_OF_SCROLLING_FRAME",disabled:a}),o.createElement(lB,{value:"STICKY_SCROLLS"}))}var lz=n(105020),lY=n(548183),lW=n(854547),lH=n(654784),l$=n(351731);function lX(){return o.createElement(oJ.u,{idForTests:"create-connection-hint",title:(0,_.t)("proto.onboarding.creating_a_connection"),userFlag:"dismissed_create_connection_hint",icon_DEPRECATED:lW.A,iconFallback:lH.A,hintText:(0,_.t)("proto.onboarding.select_a_frame_or_object_hint")})}function lQ(){return o.createElement(oJ.u,{idForTests:"delete-connection-hint",title:(0,_.t)("proto.onboarding.removing_a_connection"),userFlag:"dismissed_delete_connection_hint",icon_DEPRECATED:lz.A,iconFallback:lY.A,hintText:(0,_.t)("proto.onboarding.to_delete_a_connection_click_and_drag_on_either_end")})}function lJ(){return o.createElement(oJ.u,{idForTests:"play-button-hint",title:(0,_.t)("proto.onboarding.running_your_prototype"),userFlag:"dismissed_play_button_hint",icon_DEPRECATED:l$.A,hintText:(0,_.t)("proto.onboarding.use_the_play_button_hint")})}function lq({dismissedCreateConnectionHint:e,dismissedDeleteConnectionHint:t,dismissedPlayButtonHint:n,numTransitionsOnCurrentPage:a}){let r=0===a&&!e,l=0!==a&&!t,i=!n,s=o.useMemo(()=>r?S.c.CREATING_A_CONNECTION:l?S.c.REMOVING_A_CONNECTION:i?S.c.RUNNING_YOUR_PROTOTYPE:null,[r,l,i]);return s?o.createElement(eb.fu,{name:"Prototype Onboarding Hint Panel V1",properties:{trackingDescriptor:s}},o.createElement(tJ.Zk,null,o.createElement("div",null,r&&o.createElement(lX,null),l&&o.createElement(lQ,null),i&&o.createElement(lJ,null)))):null}class lj extends o.PureComponent{constructor(){super(...arguments),this.onClickShowPrototypeSettings=()=>{this.props.dispatch((0,oQ._P)({name:"Show Prototype Settings Clicked"})),F.wr()}}renderOnboardingPanel(){let e=!!this.props.userFlags.dismissed_create_connection_hint,t=!!this.props.userFlags.dismissed_delete_connection_hint,n=!!this.props.userFlags.dismissed_play_button_hint,a=this.props.selectionProperties.numTransitionsOnCurrentPage;return o.createElement(lq,{dismissedCreateConnectionHint:e,dismissedDeleteConnectionHint:t,dismissedPlayButtonHint:n,numTransitionsOnCurrentPage:a})}renderPrototypeSettingsPanel(){return o.createElement(tL.k,{name:"show_prototype_settings_panel"},o.createElement(tJ.Zk,{className:this.props.isUI3?oV.rq:void 0},o.createElement(aX.z,{onClick:this.onClickShowPrototypeSettings,recordingKey:tD.Pt(this.props,"prototypeSettingsButton")},(0,_.tx)("proto.menu.show_prototype_settings"))))}renderDevicePanel(){(0,tP.KF)((0,tb.hS)(this.props.selectionProperties.prototypeDevice),"should not have mixed device selection");let e=(0,oQ.Qx)(this.props.selectionProperties.prototypeDevice);return o.createElement(rs,{key:"device-panel",dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,prototypeBackgroundColor:this.props.selectionProperties.prototypeBackgroundColor,prototypeDevice:e,smallNudgeAmount:this.props.smallNudgeAmount,bigNudgeAmount:this.props.bigNudgeAmount,recordingKey:"devicePanel",isUI3:this.props.isUI3,pickerShown:this.props.pickerShown})}render(){let e=!(0,tb.hS)(this.props.selectionProperties.transitionNodeID)||oX.fn((0,tb.E7)(this.props.selectionProperties.transitionNodeID)),t=this.props.selectionProperties.numSelected??!1,n=!this.props.isSites&&!!this.props.selectionProperties.numVideosSelected,a=this.props.selectionProperties.isInstanceSelected||this.props.selectionProperties.isInstanceSublayerSelected,r=this.props.selectionProperties.isInstanceSublayerSelected,l=!this.props.isSites&&this.props.selectionProperties.prototypeStartingPointsInfo&&this.props.selectionProperties.prototypeStartingPointsInfo.length>0,i=!this.props.isSites&&!e,s=!this.props.isSites&&((this.props.selectionProperties.isValidPrototypingSourceSelected??!0)||this.props.selectionProperties.isSectionSelected&&(0,oq.YR)());if(!t)return o.createElement("div",null,!this.props.isSites&&this.renderDevicePanel(),!this.props.isUI3&&o.createElement(o2,{recordingKey:tD.Pt(this.props,"backgroundPanel"),prototypeBackgroundColor:this.props.selectionProperties.prototypeBackgroundColor,pickerShown:this.props.pickerShown,dispatch:this.props.dispatch}),l&&o.createElement(aO.A,null),!this.props.isSites&&i&&this.renderOnboardingPanel(),o.createElement(nj.Mw,{panelName:nj.ON.PROTOTYPE}));{let e=o.createElement(lM,{dropdownShown:this.props.dropdownShown,scrollDirection:this.props.selectionProperties.scrollDirection??"NONE",showScrollWarning:this.props.selectionProperties.showWontScrollWarning??!1,disableOverflowBehaviorItem:!!a,disableScrollBehaviorItem:!!r,recordingKey:tD.Pt(this.props,"scrollBehaviorPanel"),updateSelectionProperties:tG.Y5.updateSelectionProperties});return o.createElement("div",null,!this.props.isSites&&this.props.selectionProperties.isTopLevelFrameAndValidPrototypeSourceSelected&&o.createElement(ls.A,{recordingKey:tD.Pt(this.props,"startingPointPanel")}),s&&o.createElement(r4,null),e,n&&o.createElement(lT,{updateSelectionProperties:tG.Y5.updateSelectionProperties,dispatch:this.props.dispatch,videoPlayback:function(e){let{videoMediaLoop:t,videoAutoplay:n,videoMuted:a,numVideosSelected:o}=e;return(0,tP.B1)(t),(0,tP.B1)(n),(0,tP.B1)(a),(0,tP.B1)(o),{autoplay:n,muted:a,mediaLoop:t,numVideosSelected:o}}(this.props.selectionProperties)}),!this.props.isSites&&this.renderPrototypeSettingsPanel(),i&&this.renderOnboardingPanel(),o.createElement(nj.Mw,{panelName:nj.ON.PROTOTYPE}))}}}lj.displayName="PrototypePanel";let lZ=(0,eb.kp)(function(e){let{bigNudgeAmount:t,smallNudgeAmount:n}=(0,to.sT)(),a=(0,j.GS)(),r=(0,lO.cJ)();return o.createElement(lj,{...e,bigNudgeAmount:t,smallNudgeAmount:n,isUI3:a,isSites:r})},ak.e0.PROTOTYPE_PANEL);function l0({appModel:e,colorFormat:t,dropdownShown:n,expandedFramePresetType:a,library:l,pickerShown:s,sceneGraphSelection:c,selectedStyleProperties:d,selectionProperties:p,shownPanels:m,userFlags:u}){let E=(0,r.wA)(),y=(0,ee.q5)(),_=(0,ty.RB)(d)?d:p,g=!m[i.ibQ.FRAME_PRESETS]&&!m[i.ibQ.PENCIL_TOOL]&&!_.containsResponsiveSets;return o.createElement(tg.i,null,o.createElement(tv.VF,{isVisible:m[i.ibQ.FRAME_PRESETS]},()=>o.createElement(tf.nl,{key:"frame-presets",recordingKey:"framePresetPanel",dispatch:E,expandedFramePresetType:a})),o.createElement(tv.VF,{isVisible:m[i.ibQ.PENCIL_TOOL]},()=>o.createElement(tS.q,{id:"pencilToolPanel",key:"pencilToolPanel",recordingKey:"pencilToolPanel",openFile:y})),o.createElement(tv.VF,{isVisible:g},()=>o.createElement(lZ,{key:"prototype",recordingKey:"prototypePanel",dispatch:E,selectionProperties:_,appModel:e,pickerShown:s,dropdownShown:n,currentTool:e.currentTool,colorFormat:t,sceneGraphSelection:c,editModeType:e.activeCanvasEditModeType,library:l,openFile:y,userFlags:u})))}function l1({scrollContainer:e,refMainScrollContainer:t,...n}){(0,aA.S2)();let a=n.user,r=(0,tn.my)()===tc.nT.Design,l=(0,te.Kf)({isDesign:r,isUnauth:!a})(),c=n.appModel.topLevelMode,d=n.propertiesPanelTab,p=n.appModel.isReadOnly,m=c!==i.lyf.PREVIEW&&(c!==i.lyf.BRANCHING||!(0,ty.S4)(n.appModel,n.user))&&c!==i.lyf.DEV_HANDOFF&&d===i.FAf.DESIGN,u=c!==i.lyf.PREVIEW&&c!==i.lyf.BRANCHING&&d===i.FAf.PROTOTYPE,E=c===i.lyf.PREVIEW&&!n.userStateLoaded&&!l||d===i.FAf.INSPECT,y=(0,s.kc)().livefish&&c===i.lyf.LAYOUT&&!p&&d===i.FAf.LIVING_DESIGNS,_=d===i.FAf.EXPORT,g=d===i.FAf.COMMENT;return o.createElement(o.Fragment,null,m&&o.createElement(aI,{scrollContainer:e,...n}),u&&o.createElement(l0,{appModel:n.appModel,colorFormat:n.colorFormat,dropdownShown:n.dropdownShown,expandedFramePresetType:n.expandedFramePresetType,library:n.library,pickerShown:n.pickerShown,sceneGraphSelection:n.sceneGraphSelection,selectedStyleProperties:n.selectedStyleProperties,selectionProperties:n.selectionProperties,shownPanels:n.shownPanels,userFlags:n.userFlags}),E&&o.createElement(ax,{scrollContainer:e,selectionProperties:n.selectionProperties}),y&&o.createElement(oH,null),_&&o.createElement(aC,{appModel:n.appModel,dropdownShown:n.dropdownShown,pickerShown:n.pickerShown,saveAsState:n.saveAsState,sceneGraphSelection:n.sceneGraphSelection,selectedStyleProperties:n.selectedStyleProperties,selectionProperties:n.selectionProperties}),g&&o.createElement(n.commentsPanel,null))}function l2(e){let{dispatch:t,...n}=e,a=null,r=e=>{a=e};return o.createElement(o$.j,{recordingKey:n.recordingKey,activeTab:n.propertiesPanelTab,refMainScrollContainer:r},o.createElement(l1,{...n,scrollContainer:a,refMainScrollContainer:r}))}var l8=n(16771),l4=n(59434);let l3=o.memo(function(){let e=(0,r.wA)(),t=(0,r.d4)(e=>(0,ti.getPermissionsState)(e)),n=(0,C.aV)(),a=(0,r.d4)(e=>e.loadingState),l=(0,r.d4)(e=>e.mirror.appModel),s=(0,y.md)(ts.wm),c=(0,r.d4)(e=>e.mirror.sceneGraphSelection),d=(0,r.d4)(e=>e.mirror.selectionPaints),p=(0,r.d4)(e=>e.mirror.selectionProperties),m=(0,r.d4)(e=>e.mirror.selectedStyleProperties),u=(0,r.d4)(e=>e.currentUserOrgId),E=(0,r.d4)(e=>e.dropdownShown),_=(0,r.d4)(e=>e.fonts),g=(0,r.d4)(e=>e.fileVersion),h=(0,r.d4)(e=>e.installedPluginVersions),v=(0,r.d4)(e=>e.library),f=(0,r.d4)(e=>e.localPlugins),S=(0,r.d4)(e=>e.modalShown),b=(0,r.d4)(e=>e.multiplayer),T=(0,r.d4)(e=>e.openFile),N=(0,r.d4)(e=>e.pickerShown),I=(0,r.d4)(e=>e.pickerInStyleCreationShown),P=(0,r.d4)(e=>e.publishedPlugins),k=(0,r.d4)(e=>e.saveAsState),w=(0,r.d4)(e=>e.selectedView),O=(0,r.d4)(e=>e.voice.showWidget),x=(0,r.d4)(e=>e.stylePickerListLayout),D=(0,r.d4)(e=>e.stylePickerShown),R=(0,r.d4)(e=>e.stylePreviewShown),M=(0,r.d4)(e=>e.styleSets),L=(0,r.d4)(e=>e.usedKeyboardShortcuts),V=(0,r.d4)(e=>e.user),K=(0,r.d4)(e=>e.userFlags),U=(0,r.d4)(e=>e.userStateLoaded),B=(0,r.d4)(e=>e.repos),G=(0,r.d4)(e=>e.folders),z=(0,r.d4)(e=>e.teams),Y=(0,r.d4)(e=>e.orgById),W=(0,r.d4)(e=>e.orgDraftsOwners),H=(0,r.d4)(e=>e.orgUsersByOrgId),$=(0,r.d4)(e=>e.userEduGracePeriods),X=(0,r.d4)(e=>e.licenseGroups),Q=(0,j.GS)(),J=(0,tn.my)()===tc.nT.Design,q=(0,ep.iZ)(),Z=(0,te.Kf)({isDesign:J,isUnauth:!q})(),ee=(0,tl.VP)(a,"edit_button_upgrading_to_edit"),et=n||ee,en=(0,A.ut)((0,F.aY)(),i.FAf.DESIGN),ea=(0,A.J2)(i.Ez5.propertiesPanelState().shownPropertiesPanels),eo=(0,A.J2)(i.Ez5.propertiesPanelState().strokePanelMode),er=(0,A.J2)(i.Ez5.propertiesPanelState().strokePanelTerminalPointCount),el=(0,A.J2)((0,to.UK)().expandedFramePresetType),ei=(0,to.Ku)(),es=(0,to.qw)(),ec=(0,ta.b)(),ed=(0,A.J2)(i.Ez5.uiState().showPropertiesPanel),em=!(0,tt.Oo)()&&Q&&ed,eu=(0,A.J2)((0,to.UK)().renderRulers),{isRightPanelCollapsed:eE}=(0,o.useContext)(td.t),{inProductHelpViewType:ey}=(0,tp.A5)(),e_=(0,A.J2)(i.Ez5.uiState().inProductHelpSidePanelWidth),eg=(0,tr.Tn)(),eh=(0,tr.qM)(),ev=(0,o.useMemo)(()=>Z?i.FAf.COMMENT:en,[en,Z]);return(0,o.useEffect)(()=>{ev!==en&&F.aY()?.set(ev)},[ev,en]),o.createElement(l4.o,{boundaryKey:"PropertiesPanel",loggedOutDesktopRevampExpAvaialable:J},o.createElement(l2,{recordingKey:"propertiesPanel",isCollapsed:eE,propertiesPanelTab:ev,strokePanelMode:eo,strokePanelTerminalPointCount:er,commentsPanel:l8.L,dispatch:e,isLoading:et,shouldAnimateLoadingState:n,shouldShowBackgroundGradient:em,shownPanels:ea,rulersVisible:eu,isInsetEditorEnabled:ec,expandedFramePresetType:el,colorFormat:ei,propertiesPanelSplitPosition:es,permissionsState:t,key:(0,e9.tw)()??void 0,appModel:l,sceneGraph:s,sceneGraphSelection:c,selectionPaints:d,selectionProperties:p,selectedStyleProperties:m,currentUserOrgId:u,dropdownShown:E,fonts:_,fileVersion:g,allSavedPlugins:h,library:v,localPlugins:f,modalShown:S,multiplayer:b,openFile:T,pickerShown:N,pickerInStyleCreationShown:I,publishedPlugins:P,saveAsState:k,selectedView:w,stylePickerListLayout:x,stylePickerShown:D,stylePreviewShown:R,styleSets:M,usedKeyboardShortcuts:L,user:V,userFlags:K,userStateLoaded:U,repos:B,folders:G,teams:z,orgById:Y,orgDraftsOwners:W,orgUsersByOrgId:H,userEduGracePeriods:$,licenseGroups:X,isUI3:Q,showVoiceWidget:O,hasMergedDimensionsAndAutolayout:Q,inProductHelpViewType:ey,inProductHelpSidePanelWidth:e_,justChangedMinimizeUIValue:eg,isUIMinimized:eh}))});var l5=n(48758),l7=n(889085),l6=n(648836),l9=n(481483),ie=n(544750),it=n(75888),ia=n(677859),io=n(541524),ir=n(630978),il=n(695342),ii=n(221537),is=n(12519);let ic="stack_controls--input--gK1jo text--fontNeg12--2PWcg text--_fontBase--QdLsd text--_negText--j9g-L",id="stack_controls--scrubbableControl--b1ChI",ip="stack_controls--inputSvg--wFizL",im="stack_controls--stackSpacingRow--Uus3H";function iu(){let e=(0,A.J2)(i.Ez5.canvasViewState().focusedStackRegion);if(!e)return null;let{region:t,focus:n}=e;return t===i.RN9.SPACING?o.createElement(iy,{focusOnMount:n}):t===i.RN9.COUNTER_SPACING?o.createElement(i_,{focusOnMount:n}):o.createElement(ig,{stackRegion:t,focusOnMount:n})}let iE=e=>{if(e.keyCode===t3.Uz.TAB){e.preventDefault(),e.currentTarget.blur();let t=e.shiftKey;i.Qa7.tabActiveStackRegion(t)}};function iy({focusOnMount:e}){return o.createElement(tJ.fI,{className:im},o.createElement(is.KI,{focusOnMount:e,outerClassName:id,inputClassName:ic,svgClassName:ip,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:iE,onPaste:ih,noBorderOnFocus:!0,recordingKey:"stackSpacingControl",inputTestId:"stackSpacingControl",source:"canvas",onCanvasUI:!0}))}function i_({focusOnMount:e}){return o.createElement(tJ.fI,{className:im},o.createElement(ir.q,{focusOnMount:e,outerClassName:id,inputClassName:ic,svgClassName:ip,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:iE,onPaste:ih,noBorderOnFocus:!0,recordingKey:"stackCounterSpacingControl",inputTestId:"stackCounterSpacingControl",source:"canvas",onCanvasUI:!0}))}function ig({stackRegion:e,focusOnMount:t}){let[n]=(0,ii.HF)(e),a=Array.isArray(n)?n.length:0;return e===i.RN9.SPACING?null:o.createElement(tJ.fI,{className:t4()("stack_controls--stackPaddingRow--40WUa",{"stack_controls--large--bJFUN":a>3})},o.createElement(il.s,{paddingSelection:e,focusOnMount:t,outerClassName:id,inputClassName:ic,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:iE,onPaste:ih,noBorderOnFocus:!0,svgClassName:ip,recordingKey:"stackPaddingControl",inputTestId:"stackPaddingControl",source:"canvas",disableVariablesEntryPoint:!0}))}function ih(e){(0,io.gk)(e)&&(e.preventDefault(),e.currentTarget.blur(),tk.l7.user("paste-in-stack",()=>{i.glU.triggerAction("paste",{})}))}let iv=o.memo(function(){return(0,r.d4)(e=>e.mirror.appModel.isReadOnly)?null:o.createElement(iS,null)});function iS(){return o.createElement(l6.k,{isShown:!0},o.createElement(it.IA,null,o.createElement(ib,{testID:"DesignInlineMenu"})))}function ib({testID:e}){let t=(0,r.d4)(e=>{let t=e.mirror.selectionProperties.stackMode;return 1===e.mirror.selectionProperties.numSelected&&("HORIZONTAL"===t||"VERTICAL"===t)});return(0,r.d4)(e=>{let t=e.mirror.selectionProperties.selectedWidgetInfo;return!!(1===e.mirror.selectionProperties.numSelected&&t?.propertyMenu.length)})?o.createElement(ia.W1,{size:"small",testID:e},o.createElement(l9.jk,null),o.createElement(ie.x,null)):t?o.createElement(ia.W1,{testID:e,darkModePreferred:!0},o.createElement(iu,{key:"stackControls"})):null}var iT=n(284321),iN=n(100303),iI=n(137345),iP=n(293775);let iC=(0,o.memo)(function(e){return o.createElement("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e},o.createElement("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M18.364 5.636a8.96 8.96 0 0 1 2.535 5.016C21.206 12.688 19.4 14 17.73 14H15.5a1.5 1.5 0 0 0-1.5 1.5v2.231c0 1.67-1.312 3.475-3.348 3.168a9 9 0 1 1 7.712-15.263m1.546 5.165c.188 1.246-.918 2.199-2.179 2.199H15.5a2.5 2.5 0 0 0-2.5 2.5v2.231c0 1.26-.953 2.367-2.2 2.18a8 8 0 1 1 9.11-9.11M13 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0m-4.134 3.5a1 1 0 1 0-1.732-1 1 1 0 0 0 1.732 1m7.634.366a1 1 0 1 1-1-1.732 1 1 0 0 1 1 1.732M7.134 15.5a1 1 0 1 0 1.732-1 1 1 0 0 0-1.732 1",clipRule:"evenodd"}))});var iA=n(342691),ik=n(746907),iw=n(694598),iO=n(320063),ix=n(886133),iD=n(934533),iR=n(215932),iM=n(38329);function iL(e,t,n){iM.D.dispatch(d.F.enqueue({message:e,type:n,icon:t,timeoutOverride:3e3}))}function iV(){let e=(0,y.md)(iR.GI);return(0,o.useMemo)(()=>(function(e){let t=(0,ik.r8)();if(!t)return{};let n={};for(let a of e){let e=t.getRuleById(a.ruleId);if(!e)continue;let o=e.group,r=iF[o];n[o]||(n[o]={label:r,rulesToViolations:{}}),n[o].rulesToViolations[a.ruleId]||(n[o].rulesToViolations[a.ruleId]=[]),n[o].rulesToViolations[a.ruleId]?.push(a)}return n})(e),[e])}function iK(){return(0,y.md)(iR.GI).length}let iF={[iw.e.DESIGN_HEURISTICS]:(0,_.tx)("design_linter.group_names.design_heuristics"),[iw.e.DESIGN_SYSTEMS]:(0,_.tx)("design_linter.group_names.design_systems")};var iU=n(371591),iB=n(139689),iG=n(755020),iz=n(370903),iY=n(995382);function iW({shouldDisplay:e}){return e?o.createElement("div",{className:aG.cx.p12.flex.justifyCenter.$},(0,_.tx)("design_linter.penalty_box.no_violations")):null}function iH(){return o.createElement("div",{onPointerUp:e=>e.stopPropagation(),role:"button"},o.createElement(a9.K,{onClick:()=>{i.Ez5?.uiState().showDesignLinter.set(!1)},"aria-label":(0,_.t)("general.close")},o.createElement(iB.A,null)))}function i$(){let e=iK();return o.createElement("div",{className:aG.cx.bb1.colorBorder.bSolid.flex.flexRow.justifyBetween.p8.pl16.itemsCenter.$},o.createElement("div",{className:aG.cx.flex.textBodyMediumStrong.$},o.createElement("span",{className:aG.cx.mr2.$},(0,_.tx)("design_linter.penalty_box.title")),o.createElement("span",null,e?`(${e})`:"")),o.createElement(iH,null))}function iX({onNavigateBack:e,title:t}){return o.createElement("div",{className:aG.cx.bb1.colorBorder.bSolid.$},o.createElement("div",{className:aG.cx.p8.flex.itemsCenter.justifyBetween.$,onPointerUp:e,role:"button",tabIndex:0},o.createElement("div",{className:aG.cx.flex.itemsCenter.$},o.createElement(iG.C,null),o.createElement("span",{className:aG.cx.textBodyMediumStrong.$},t)),o.createElement(iH,null)))}function iQ({children:e}){return o.createElement("div",{className:"design_linter_panel--displayContents--uRenD"},o.createElement("div",{className:aG.cx.flex.flexColumn.wFull.hFull.overflowHidden.overflowYScroll.$},e))}function iJ({onNext:e,onPrev:t,hasNext:n,hasPrev:a,title:r}){return o.createElement("div",{className:aG.cx.flex.flexRow.itemsCenter.justifyBetween.p8.pl16.$},o.createElement("div",null,r),o.createElement("div",{className:aG.cx.flex.flexRow.$},o.createElement(a9.K,{onClick:e=>{e.currentTarget.blur(),t()},disabled:!a,"aria-label":(0,_.t)("general.previous")},o.createElement(rb.B,{svg:iY.A})),o.createElement(a9.K,{onClick:t=>{t.currentTarget.blur(),e()},disabled:!n,"aria-label":(0,_.t)("general.next")},o.createElement(rb.B,{svg:iz.A}))))}function iq(){let e=(0,ee.q5)(),t=iK(),n=function(){let e=iV();return(0,o.useMemo)(()=>Object.entries(e).map(([e,{rulesToViolations:t}])=>({group:e,count:Object.values(t).reduce((e,t)=>e+t.length,0)})),[e])}(),a=function(){let e=iV();return(0,o.useMemo)(()=>Object.values(e).flatMap(e=>Object.entries(e.rulesToViolations).map(([e,t])=>({rule:e,count:t.length}))),[e])}(),[r,l]=(0,o.useState)(0),i=eU.q.instance.getCurrentPage();if((0,iO.h)(()=>{if(!i)return;let e=0;(0,rh.hV)(i,()=>{e++}),l(e)}),!i||!e)return null;let s=e._name??"File",c=i.name;return o.createElement("div",{className:aG.cx.px16.$},o.createElement("span",{className:aG.cx.textHeadingMedium.block.$},"Debug view"," "),o.createElement("span",{className:aG.cx.textBodyMedium.block.$},`${s} - ${c}`," "),o.createElement("span",{className:aG.cx.textBodyMedium.block.$},`Total layers: ${r}`," "),o.createElement("span",{className:aG.cx.textBodyMedium.block.$},`Total violations: ${t}`," "),o.createElement("span",{className:aG.cx.textHeadingSmall.block.pt8.$},"Violations per group"," "),o.createElement("ol",null,n.map(e=>o.createElement("span",{key:e.group,className:aG.cx.textBodyMedium.block.$},`${e.group}: ${e.count}`," "))),o.createElement("span",{className:aG.cx.textHeadingSmall.block.pt8.$},"Violations per rule"),o.createElement("ol",null,a.map(e=>o.createElement("span",{key:e.rule,className:aG.cx.textBodyMedium.block.$},`${e.rule}: ${e.count}`," "))))}var ij=(e=>(e[e.GROUPS=0]="GROUPS",e[e.RULES=1]="RULES",e[e.VIOLATIONS=2]="VIOLATIONS",e))(ij||{});function iZ(){if(!(0,s.kc)().aip_flower_garden)return null;let e=(0,s.kc)().aip_flower_garden_debug;return o.createElement(iQ,null,o.createElement(i0,null),e&&o.createElement(iq,null))}function i0(){let[e,t]=(0,o.useState)({view:0,selectedGroup:null,selectedRule:null}),n=iV();if((0,y.md)(ik.vo)===ik.td.DETECTING)return o.createElement("div",{className:aG.cx.flex.mt12.justifyCenter.$},o.createElement(ix.y$,null));let{view:a,selectedGroup:r,selectedRule:l}=e;return 0!==a&&r?1!==a&&l?2===a?o.createElement(i4,{onBack:()=>{t({view:1,selectedGroup:r,selectedRule:null})},rule:l,violations:r.rulesToViolations[l.id]??[]}):null:o.createElement(i8,{group:r,onBack:()=>t({view:0,selectedGroup:null,selectedRule:null}),selectRule:(e,n)=>t({view:2,selectedGroup:n,selectedRule:e})}):o.createElement(i2,{selectGroup:e=>t({view:1,selectedGroup:e,selectedRule:null}),violationGroups:n})}let i1={[iw.e.DESIGN_HEURISTICS]:iP.C,[iw.e.DESIGN_SYSTEMS]:iC};function i2({selectGroup:e,violationGroups:t}){let n=Object.keys(t);return o.createElement("div",{className:aG.cx.flex.flexColumn.$},o.createElement(i$,null),o.createElement(tg.i,null,n.map((n,a)=>{let r=i1[n];return r?o.createElement("div",{className:aG.cx.bb1.colorBorder.bSolid.$,key:n,onMouseUp:()=>{e(t[n])},role:"button",tabIndex:a},o.createElement("div",{className:aG.cx.p16.flex.itemsCenter.justifyBetween.$},o.createElement("div",{className:aG.cx.flex.itemsCenter.$},o.createElement("div",{className:aG.cx.p8.b1.colorBorder.bRadius4.mr12.$},o.createElement(r,null)),o.createElement("div",{className:aG.cx.maxW100.truncate.mr12.textBodyMediumStrong.$},t[n]?.label??"")),o.createElement(iA.a,null))):null})),o.createElement(iW,{shouldDisplay:!n.length}))}function i8({group:e,onBack:t,selectRule:n}){let a=(0,ik.r8)();if(!a)return null;let r=Object.keys(e.rulesToViolations);return o.createElement(o.Fragment,null,o.createElement(iX,{onNavigateBack:t,title:e?.label??""}),r.map(t=>{let r=a.getRuleById(t),l=(e.rulesToViolations[t]??[]).length;return r?o.createElement("div",{className:aG.cx.p16.flex.justifyBetween.itemsCenter.bb1.colorBorder.bSolid.$,key:t,onPointerUp:()=>n(r,e),role:"button"},o.createElement("div",{className:aG.cx.flex.flexColumn.$},o.createElement("div",{className:aG.cx.textBodyMediumStrong.pb2.$},r?.name??"",o.createElement("span",{className:aG.cx.pl2.colorTextTertiary.$},`(${l})`)),o.createElement("div",{className:aG.cx.textBodyMedium.colorTextSecondary.$},r?.label??"")),o.createElement(iA.a,{className:aG.cx.colorTextTertiary.$})):null}),o.createElement(iW,{shouldDisplay:!r.length}))}function i4({rule:e,violations:t,onBack:n}){let[a,r]=(0,o.useState)(t[0]?.guid??null),[l,i]=(0,o.useState)(null),[s,c]=(0,o.useState)(0),d=(0,o.useRef)(null),p=e=>`violation-row-${e}`;(0,iO.h)(()=>{d.current?.focus()});let m=(0,o.useCallback)(e=>{document.getElementById(p(e))?.focus()},[]),E=function(){let e=(0,ik.r8)(),t=(0,ey.Xr)(iR.GI);return(0,o.useCallback)(async n=>{if(e)try{await e.fixSingleViolation(n)?t(e=>e.filter(e=>e.guid!==n.guid||e.ruleId!==n.ruleId)):iL((0,_.t)("design_linter.penalty_box.fix_failed_bell"),iD.zX.EXCLAMATION,"error")}catch(e){iL((0,_.t)("design_linter.penalty_box.fix_failed_bell"),iD.zX.EXCLAMATION,"error")}},[e,t])}(),y=(0,o.useCallback)((e,t)=>{tG.Y5.triggerAction("goto-layer",{args:{nodeId:e}}),r(e),c(t),m(e)},[m]),g=(0,o.useCallback)(()=>{let e=s+1;e<t.length&&y(t[e].guid,e)},[s,t,y]),h=(0,o.useCallback)(()=>{let e=s-1;e>=0&&y(t[e].guid,e)},[s,y,t]),v=(0,o.useCallback)(e=>{switch(e.key){case"ArrowUp":case"ArrowLeft":h();break;case"ArrowDown":case"ArrowRight":g();break;default:return}},[g,h]),f=eU.q.instance;return f?o.createElement(o.Fragment,null,o.createElement(iX,{onNavigateBack:n,title:e.name}),o.createElement(iJ,{onNext:g,onPrev:h,hasNext:s<t.length-1,hasPrev:s>0,title:t.length>1?(0,_.t)("design_linter.penalty_box.layer_count",{count:t.length}):""}),o.createElement("div",{className:aG.cx.overflowYScroll.$},t.map((e,t)=>{let n=f.get(e.guid);if(!n)return null;let r=l===n.guid,s=a===n.guid;return o.createElement("div",{key:t,id:p(n.guid),ref:0===t?d:null,className:t4()(aG.cx.p16.flex.justifyBetween.itemsCenter.$,{"design_linter_panel--violation--PNRW9":!0,"design_linter_panel--selectedViolation--YEw2j":s,"design_linter_panel--hoveredViolation--q0-nl":r&&!s}),onMouseEnter:()=>{(0,F.Uc)(n.guid),i(n.guid)},onMouseLeave:()=>{(0,F.Uc)(""),i(null)},onPointerUp:()=>{y(n.guid,t)},onKeyDown:v,role:"button",tabIndex:s?0:-1},o.createElement("div",{className:aG.cx.flex.itemsCenter.$},o.createElement(iU.Bf,{guid:n.guid}),o.createElement("span",{className:aG.cx.textBodyMedium.mx6.$},n.name)),o.createElement(u.$n,{variant:"secondary",onClick:()=>E(e)},(0,_.tx)("design_linter.penalty_box.fix")))}),o.createElement(iW,{shouldDisplay:!t.length}))):null}var i3=n(286723),i5=n(876743),i7=n(145305),i6=n(412371),i9=n(624488),se=n(515288),st=n(936486),sn=n(237701),sa=n(187882);let so=new Map,sr=o.memo(function(){let e=(0,y.md)((0,iT.Xh)(void 0)),t=(0,ee.q5)(),n=(0,j.GS)(),a=(0,C.aV)();(0,sa.bi)();let r=(0,L.X0)(),l=!!t&&e;return o.useEffect(()=>{l&&(0,ef.YQ)({id:"Found Updates To Publish"})},[l]),o.createElement(i5.Q,{ignoreRulers:a},o.createElement(se.s,null),o.createElement(i9.$,null,n&&o.createElement(sn.n,null),n&&o.createElement(st.d,{shouldUseBottomBorder:!r}),o.createElement(sl,null)))});function sl(){let e=(0,r.d4)(e=>e.leftPanel),t=(0,sa.cT)(),{pagesList:n,pageToNumChangesMap:a,isComparingChanges:l}=function(){let e=(0,sa.n0)(),t=(0,r.d4)(e=>!!(0,s.kc)().version_diffing&&e.mirror.appModel.activeCanvasEditModeType===i.m1T.COMPARE_CHANGES),n=(0,r.d4)(e=>e.versionHistory.compareId);return o.useMemo(()=>{if(!t||!n)return{pagesList:e,pageToNumChangesMap:so,isComparingChanges:t};let a=(0,i3.ee)(e);return{pagesList:e,pageToNumChangesMap:a,isComparingChanges:t}},[t,n,e])}(),c=(0,i6.g)({pagesList:n}),d=(0,sa.GQ)(),p=(0,A.J2)(i.Ez5.uiState().showCanvasSearch),m=(0,A.J2)(i.Ez5.uiState().showDesignLinter);return p?o.createElement(iN.EA.Provider,{value:!0},o.createElement(iI.f,{showFilter:!0})):(0,s.kc)().aip_flower_garden&&m?o.createElement(iZ,null):n.length>0?o.createElement(i7.y,{recordingKey:"pagesPanel",isReadOnly:t,width:d,pagesList:n,activeTab:e.activeTab,isDevHandoff:!1,isDevHandoffOverview:!1,isComparingChanges:l,pageToNumChanges:a,onPageContextMenu:c}):null}var si=n(319008),ss=n(988889),sc=n(959369),sd=n(359919);let sp=(0,o.memo)(function(e){return o.createElement("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e},o.createElement("mask",{id:"fpl-icon-24-mail-a",fill:"#fff"},o.createElement("path",{fillRule:"evenodd",d:"M5.88 7h12.24a.88.88 0 0 1 .88.88v.82l-7 3.733L5 8.7v-.82A.88.88 0 0 1 5.88 7M4 8.99v7.13A1.88 1.88 0 0 0 5.88 18h12.24A1.88 1.88 0 0 0 20 16.12V7.88A1.88 1.88 0 0 0 18.12 6H5.88A1.88 1.88 0 0 0 4 7.88zm15 .843v6.287a.88.88 0 0 1-.88.88H5.88a.88.88 0 0 1-.88-.88V9.833l6.765 3.608.235.126.235-.126z",clipRule:"evenodd"})),o.createElement("path",{fill:"var(--color-icon)",d:"m19 8.7.47.882L20 9.3v-.6zm-7 3.733-.47.883.47.25.47-.25zM5 8.7H4v.6l.53.282zm-1 .31h1v-.02zm0-.02 1 .02v-.02zm16 .02-1-.02v.02zm0-.02h-1v.02zm-1 .843h1V8.167l-1.47.784zm-14 0 .47-.882L4 8.167v1.666zm6.765 3.608-.47.882zm.235.126-.47.882.47.251.47-.251zm.235-.126.471.882zM18.12 6H5.88v2h12.24zM20 7.88A1.88 1.88 0 0 0 18.12 6v2a.12.12 0 0 1-.12-.12zm0 .82v-.82h-2v.82zm-7.53 4.616 7-3.734-.94-1.764-7 3.733zM4.53 9.582l7 3.734.94-1.765-7-3.733zM4 7.88v.82h2v-.82zM5.88 6A1.88 1.88 0 0 0 4 7.88h2a.12.12 0 0 1-.12.12zM5 8.99v.02l-2-.04v.06zm-2 .02v7.11h2V9.01zm0 7.11A2.88 2.88 0 0 0 5.88 19v-2a.88.88 0 0 1-.88-.88zM5.88 19h12.24v-2H5.88zm12.24 0A2.88 2.88 0 0 0 21 16.12h-2a.88.88 0 0 1-.88.88zM21 16.12V9.01h-2v7.11zm-2-7.11v-.02l2 .04v-.06zm2-.02V7.88h-2v1.11zm0-1.11A2.88 2.88 0 0 0 18.12 5v2a.88.88 0 0 1 .88.88zM18.12 5H5.88v2h12.24zM5.88 5A2.88 2.88 0 0 0 3 7.88h2A.88.88 0 0 1 5.88 7zM3 7.88v1.11h2V7.88zm17 8.24V9.833h-2v6.287zM18.12 18A1.88 1.88 0 0 0 20 16.12h-2a.12.12 0 0 1 .12-.12zM5.88 18h12.24v-2H5.88zM4 16.12A1.88 1.88 0 0 0 5.88 18v-2a.12.12 0 0 1 .12.12zm0-6.287v6.287h2V9.833zm8.235 2.726L5.471 8.95l-.941 1.765 6.764 3.608zm.236.125-.236-.125-.94 1.765.235.125zm-.706-.125-.236.125.942 1.765.235-.126zm6.764-3.608-6.764 3.608.941 1.765 6.765-3.608z",mask:"url(#fpl-icon-24-mail-a)"}))});var sm=n(137035),su=n(737947),sE=n(27087),sy=n(809840),s_=n(218997),sg=n(15839),sh=n(233286);function sv(){let e=(0,T.e)({overlay:R.Dqt,priority:k.N.DEFAULT_MODAL});(0,b.E)(e.uniqueId,"commentThreadMobileAnnouncementClicked",()=>{(0,eE.sx)("sidebar_announcement_mobile_app_download_prompt_modal_shown"),e.show({})});let t=(0,o.useCallback)(async()=>{(0,eE.sx)("sidebar_announcement_mobile_app_download_prompt_email_me_cta_clicked"),await sE.Ay.post("/api/send_mobile_download_email"),e.complete()},[e]);return o.createElement(s_.h,{isShowing:e.isShowing,modalType:sg.q3.FEATURE_UPDATE,closeButtonStyle:sg.M_.ON_DARK,element:()=>o.createElement(sf,{onEmailClick:t}),trackingContextName:"mobile_comment_announcement",onClickPrimaryCta:e.complete,onClose:e.complete,onManualDismiss:e.complete})}function sf(e){return o.createElement("div",{className:"modal_comment_sidebar_announcement--container--5oh-p"},o.createElement("div",{className:"modal_comment_sidebar_announcement--imageContainer--Vuo-V"},o.createElement("img",{alt:"Background",src:"https://static.figma.com/uploads/e19f2f58bc09414847ad59ff9228e07032e8842c",className:"modal_comment_sidebar_announcement--image--lyA61"}),o.createElement("div",{className:"modal_comment_sidebar_announcement--spacer--m02YT"}),o.createElement(sh.T,null)),o.createElement("div",{className:"modal_comment_sidebar_announcement--textContainer--btaTy"},o.createElement("div",{className:"modal_comment_sidebar_announcement--title--eiyLq"},o.createElement(sy.E,{fontSize:24,fontWeight:"semi-bold"},(0,_.t)("rcs.mobile_comment_announcement.title"))),o.createElement("div",{className:"modal_comment_sidebar_announcement--description--Y8AJE"},o.createElement(sy.E,{fontSize:14},(0,_.t)("rcs.mobile_comment_announcement.description")))),o.createElement("div",{className:"modal_comment_sidebar_announcement--buttonsContainer--UTcgc"},o.createElement(u.$n,{variant:"secondary",onClick:e.onEmailClick,iconPrefix:o.createElement(sp,null)},(0,_.t)("rcs.mobile_comment_announcement.email_download_link")),o.createElement(u.$n,{variant:"primary",onClick:()=>{(0,eE.sx)("sidebar_announcement_mobile_app_download_prompt_learn_more_cta_clicked"),su.Ay.unsafeRedirect("https://help.figma.com/hc/articles/1500007537281-Guide-to-the-Figma-mobile-app#download","_blank")},iconPrefix:o.createElement(sm.b,null)},(0,_.t)("rcs.rcs_shared.learn_more"))))}var sS=n(723215),sb=n(631437),sT=n(866206),sN=n(355819),sI=n(457630),sP=n(83695),sC=n(344780),sA=n(820286),sk=n(175290),sw=n(503965);let sO=(0,r$.ex)("prototype_action_info",function(){return o.createElement("div",{className:aG.cx.flex.itemsCenter.justifyCenter.$},o.createElement(rb.B,{className:"prototype_action_info_tooltip--prototypeDestinationInfoIcon--GeQWS",svg:sw.A}),o.createElement("span",{className:aG.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,_.tx)("proto.prototype_panel.use_the_circular_node_to_connect_the_selected_object_to_another_frame_tooltip")))},()=>({unconstrainWidth:!0})),sx=(0,o.memo)(function(e){return o.createElement("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e},o.createElement("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M11.5 6a.5.5 0 0 1 .5.5V11a1 1 0 0 0 1 1h4.5a.5.5 0 0 1 0 1H13a2 2 0 0 1-2-2V6.5a.5.5 0 0 1 .5-.5",clipRule:"evenodd"}))});var sD=n(995672);class sR extends oC.c${}class sM extends oC.l6{}function sL({action:e}){return o.createElement("div",{className:"prototype_action_dropdown--prototypeActionIcon--qChhY"},o.createElement(t1.U,{svg:(0,rN.Yb)(e)},(0,rN.av)(e)))}function sV(e){let t=`prototype-action-select-${e.recordingKey}`,n=e.dropdownShown&&e.dropdownShown.type===t,a=(0,tb.E7)(e.action),l=(0,rN.Yb)(a),i=(0,rN.av)(a),s=(0,j.GS)(),c=(0,r.d4)(rk.ZM),d=new rT.js(s,c),p=new rT.Z6(s,c),m=n?d:p,u=!(0,r.d4)(e=>e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0),E=o.useCallback(e=>e-24,[]),y=o.useCallback(e=>e+24,[]),[_,g]=o.useState(void 0),h=o.createElement(sD.Q,{setMaxWidth:g,options:sK(e),formatOption:e=>e&&e.props.value?m.format(e.props.value):"",getIcon:()=>o.createElement(sL,{action:"NAVIGATE_TO"})}),v=t4()({[e.className??""]:!0,"prototype_action_dropdown--select--b3Ssx":!s}),f=o.createElement(t1.U,{svg:l},i);return o.createElement(o.Fragment,null,o.createElement(sM,{disabled:u,id:t,dataTestId:"action-select",className:v,chevronClassName:"prototype_action_dropdown--prototypeActionChevron--ZL1Q4",inputClassName:"prototype_action_dropdown--prototypeActionInputWithSvg--Atfua",property:e.action,formatter:m,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,icon:f,iconClassName:"prototype_action_dropdown--selectActionSvg--XfhUx",recordingKey:tD.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,e9.nl)(),dropdownAlignment:E,dropdownWidth:s?_:y},sK(e)),s&&h)}function sK(e){let t=(0,lO.cJ)(),n=(0,j.GS)(),a=o.createElement(sR,{key:"NONE",value:"NONE",icon:o.createElement(sL,{action:"NONE"}),recordingKey:tD.Pt(e,"clear-option"),disabled:!1}),r=o.createElement(sR,{key:"NAVIGATE_TO",value:"NAVIGATE_TO",icon:o.createElement(sL,{action:"NAVIGATE_TO"}),recordingKey:tD.Pt(e,"navigate-to-option"),disabled:!1}),l=o.createElement(sR,{key:"SWAP_STATE_TO",value:"SWAP_STATE_TO",icon:o.createElement(sL,{action:"SWAP_STATE_TO"}),recordingKey:tD.Pt(e,"swap-state-to-option"),disabled:!i.glU.isSelectionContainedInStateOrStateInstance()}),c=o.createElement(sR,{key:"GO_BACK",value:"GO_BACK",icon:o.createElement(sL,{action:"GO_BACK"}),recordingKey:tD.Pt(e,"back-option"),disabled:!1}),d=o.createElement(sR,{key:"SCROLL_TO",value:"SCROLL_TO",icon:o.createElement(sL,{action:"SCROLL_TO"}),recordingKey:tD.Pt(e,"scroll-to-option"),disabled:!1}),p=o.createElement(sR,{key:"OPEN_URL",value:"OPEN_URL",icon:o.createElement(sL,{action:"OPEN_URL"}),recordingKey:tD.Pt(e,"url-option"),disabled:!1}),m=o.createElement(sR,{key:"OPEN_OVERLAY",value:"OPEN_OVERLAY",icon:o.createElement(sL,{action:"OPEN_OVERLAY"}),recordingKey:tD.Pt(e,"open-overlay-option"),disabled:!1}),u=o.createElement(sR,{key:"SWAP_WITH",value:"SWAP_WITH",icon:o.createElement(sL,{action:"SWAP_WITH"}),recordingKey:tD.Pt(e,"swap-with-option"),disabled:!1}),E=o.createElement(sR,{key:"CLOSE_OVERLAY",value:"CLOSE_OVERLAY",icon:o.createElement(sL,{action:"CLOSE_OVERLAY"}),recordingKey:tD.Pt(e,"close-option"),disabled:!1}),y=o.createElement(sR,{key:"SET_VARIABLE",value:"SET_VARIABLE",icon:o.createElement(sL,{action:"SET_VARIABLE"}),recordingKey:tD.Pt(e,"set-variable"),disabled:!1}),_=(0,s.kc)().prototype_set_mode_action&&o.createElement(sR,{key:"SET_VARIABLE_MODE",value:"SET_VARIABLE_MODE",icon:o.createElement(sL,{action:"SET_VARIABLE_MODE"}),recordingKey:tD.Pt(e,"set-variable-mode"),disabled:!1}),g=!e.isNestedInConditional&&o.createElement(sR,{key:"CONDITIONAL",value:"CONDITIONAL",icon:o.createElement(sL,{action:"CONDITIONAL"}),recordingKey:tD.Pt(e,"conditional"),disabled:!1}),h=o.createElement(oC.sK,{key:"first-divider"}),v=o.createElement(oC.sK,{key:"second-divider"}),f=o.createElement(oC.sK,{key:"third-divider"}),S=(0,s.kc)().sts_interaction_interop&&t?[l,c,d,h,y,g]:n?[a,h,r,l,c,d,p,v,m,u,E,f,y,_,g]:[a,h,r,l,c,v,y,_,g,d,p,f,m,u,E];if(e.showVideoActions&&!t){let t=[o.createElement(oC.sK,{key:"fourth-divider"}),o.createElement(sR,{key:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",value:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",icon:o.createElement(sL,{action:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS"}),recordingKey:tD.Pt(e,"update-media-play-pause-options"),disabled:!1}),o.createElement(sR,{key:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",value:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",icon:o.createElement(sL,{action:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS"}),recordingKey:tD.Pt(e,"update-media-mute-unmute-options"),disabled:!1}),o.createElement(sR,{key:"UPDATE_MEDIA_SKIP_TO",value:"UPDATE_MEDIA_SKIP_TO",icon:o.createElement(sL,{action:"UPDATE_MEDIA_SKIP_TO"}),recordingKey:tD.Pt(e,"update-media-skip_to"),disabled:!1}),o.createElement(sR,{key:"UPDATE_MEDIA_SKIP_BY_OPTIONS",value:"UPDATE_MEDIA_SKIP_BY_OPTIONS",icon:o.createElement(sL,{action:"UPDATE_MEDIA_SKIP_BY_OPTIONS"}),recordingKey:tD.Pt(e,"update-media-skip-by-options"),disabled:!1})];S=S.concat(t)}return S.filter(Boolean)}var sF=n(983405),sU=n(773833),sB=n(736656),sG=n(533573),sz=n(712685),sY=n(843709);let sW="prototype_action_verbose_title--actionNameInsertion--aF4kI",sH="prototype_action_verbose_title--actionName--qWJL3",s$="prototype_action_verbose_title--actionNameUI3--JAYsG",sX=()=>{let e=(0,r.d4)(e=>e.mirror.sceneGraph);return o.useMemo(()=>new rT.cP(e),[e])};function sQ({action:e,isNestedInConditional:t,isNarrowPanel:n,onClick:a}){let r=(0,rR.YT)()===rR.Oz.TWO_COL,l=o.useContext(sB.c),s=r&&l===sB.P.LEFT,c=t||n,d=(0,ad.u)((0,tb.hS)(e.targetVariable)&&e.targetVariable&&"id"in e.targetVariable?e.targetVariable?.id:void 0),p=(0,tb.hS)(e.targetVariable)&&e.targetVariable&&"nodeFieldAlias"in e.targetVariable?(0,sU.aA)(e.targetVariable.nodeFieldAlias.stablePathToNode,e.targetVariable.nodeFieldAlias.indexOrKey):void 0,m=d?.name??p?.name,u=sX(),E=new rT.Z6((0,j.GS)()),y=(0,rT._X)(e),g=(0,tb.E7)(y),h=o.createElement(t1.U,{svg:(0,rN.Yb)(g)},(0,rN.av)(g)),v=e=>{if(!e.connectionType||(0,tb.gl)(e.connectionType))return null;let t=t4()({[sH]:!0,[s$]:r}),n=t4()({"prototype_action_verbose_title--actionDestination--JZ-gU":!0,"prototype_action_verbose_title--actionDestinationUI3--ZGxbq":r});switch(e.connectionType){case"NONE":case"SET_VARIABLE_MODE":case"OBJECT_ANIMATION":return null;case"INTERNAL_NODE":case"BACK":case"CLOSE":case"UPDATE_MEDIA_RUNTIME":{let a=e.transitionNodeID;if((0,tb.gl)(a))return o.createElement("div",{className:t},(0,_.t)("proto.variant_actions.mixed"));if(void 0===a)return null;let r=oX.dI(a),l=u.format(r);return o.createElement("div",{className:n},l)}case"URL":{let a=e.connectionURL;if(!a)return null;if((0,tb.gl)(a))return o.createElement("div",{className:t},(0,_.t)("proto.variant_actions.mixed"));return o.createElement("div",{className:n},a)}case"SET_VARIABLE":if(!e.targetVariableData||(0,tb.gl)(e.targetVariableData))return null;return o.createElement("div",{className:"prototype_action_verbose_title--setVariablePreviewContainer--6omxy"},o.createElement(sP.y3,{targetVariableData:e.targetVariableData,onClick:rS.lQ,showVariableThumbnails:!1,isNarrowPanel:c,isInConditional:!0}));case"CONDITIONAL":{if((0,tb.gl)(e)||(0,tb.gl)(e.conditionalActions)||!e.conditionalActions)return null;let t=e.conditionalActions.length>0?e.conditionalActions[0].condition:void 0;return o.createElement(sP.y3,{targetVariableData:t,onClick:rS.lQ,isInConditional:!0,showVariableThumbnails:!1})}default:(0,tP.xb)(e.connectionType)}},f=t4()({[sY.Li]:c&&!r,[sY.O8]:!c&&!r,[sY.kE]:r}),S=t4()({"prototype_action_verbose_title--iconContainer--jqarD":!0,"prototype_action_verbose_title--iconContainerUI3--yBP0-":r});return o.createElement("div",{className:f,onClick:a,role:"button",tabIndex:0},o.createElement(sF.Y1,{horizontalAlignItems:"space-between",width:"fill-parent"},o.createElement("div",{className:S},h),(e=>{let t=g?E.format(g):"Undefined",n=t4()({[sH]:!0,[s$]:r});if((0,tb.gl)(e.connectionType)&&(t=(0,_.t)("fullscreen.mixed")),!e.connectionType||(0,tb.gl)(e.connectionType)||"NONE"===e.connectionType||"BACK"===e.connectionType||"CLOSE"===e.connectionType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t));var a=v(e);switch(e.connectionType){case"INTERNAL_NODE":if("SWAP_STATE"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,_.t)("proto.action_change_to")),a);if(a){if("OVERLAY"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:sW},(0,_.tx)("proto.action_overlay_title",{overlayFrameName:o.createElement("span",null,a)})));if("SWAP"===e.navigationType)return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,_.t)("proto.action_swap_overlay_title")),a)}return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t),a);case"UPDATE_MEDIA_RUNTIME":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t),a);case"URL":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},a?(0,_.t)("proto.action_url_title"):(0,_.t)("proto.action_open_link")),a);case"SET_VARIABLE":{let l=e.targetVariableData&&(0,tb.hS)(e.targetVariableData)&&e.targetVariableData.resolvedType===i.rXF.COLOR,c=t4()({"prototype_action_verbose_title--actionNameInsertionColor--isir- prototype_action_verbose_title--actionNameInsertion--aF4kI":!0,"prototype_action_verbose_title--actionNameInsertionColorUI3--Apj0i":r});if(m&&a)return o.createElement(o.Fragment,null,o.createElement("div",{className:l?c:sW},(0,_.tx)("proto.action_set_variable_title",{variableName:o.createElement("span",{className:"prototype_action_verbose_title--variableNameContainer--XeJX2"},o.createElement(sz.wG,{text:m,isDeleted:!!d&&(0,sG.eF)(d),disableHover:s})),variableValue:o.createElement("span",{className:"prototype_action_verbose_title--variableDestinationContainer--RXbKo prototype_action_verbose_title--variableNameContainer--XeJX2"},a)})));return o.createElement(o.Fragment,null,o.createElement("div",{className:n},t))}case"SET_VARIABLE_MODE":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},(0,_.t)("proto.action_set_variable_mode")));case"CONDITIONAL":return o.createElement(o.Fragment,null,o.createElement("div",{className:n},r?(0,_.t)("proto.if"):(0,_.t)("proto.action_conditional_title")),a);case"OBJECT_ANIMATION":return o.createElement(o.Fragment,null);default:(0,tP.xb)(e.connectionType)}})(e)))}var sJ=n(494387),sq=n(789529),sj=n.n(sq),sZ=n(636149),s0=n.n(sZ),s1=n(675551),s2=n.n(s1),s8=n(184058),s4=n.n(s8),s3=n(154483),s5=n(564092),s7=n(896850);let s6="prototype_set_variable_mode_controls--dropdownRow--vl5z4",s9="missing";class ce extends oC.l6{}class ct extends oC.c${}class cn extends oC.l6{}class ca extends oC.c${}let co={},cr=(0,s3.fv)();function cl(){let e=(0,ad.h6)()||co,t=(0,s5.iR)(),n=o.useMemo(()=>{let n=s2()(t,(e,t)=>({collectionID:e.node_id,collectionName:e.name,key:e.key,modeOptions:e.modes?.map(t=>({modeId:{guid:t.id,collectionKey:e.key},name:t.name,isCompatible:!0}))||[],explicitMode:null,inheritMode:null,fileKey:cr(e)}));return sj()({},e,n)},[t,e]),a=o.useMemo(()=>Object.entries(n).map(([e,t])=>({setKey:e,modeData:t,isLocal:void 0===t.fileKey})),[n]),l=o.useMemo(()=>Object.values(a).filter(e=>e.modeData?.modeOptions&&e.modeData?.modeOptions.length>1),[a]),s=o.useMemo(()=>s4()(l.map(e=>e.modeData.fileKey??s7.BH)),[l]),c=(0,ad.el)(s),[d,p]=o.useMemo(()=>{let{_local:e,_unknownFile:t,...n}=s0()(l,e=>e.isLocal?"_local":e.modeData.fileKey&&void 0===c[e.modeData.fileKey]?"_unknownFile":e.modeData.fileKey),a=Object.entries(n).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>[{fileKey:e,fileName:c[e]},...t]).flat(1);return t&&(a.push({fileKey:s7.BH,fileName:(0,_.t)("variables.mode_properties_panel.used_variables.subheading")}),a.push(...t)),[e??[],a]},[c,l]),m=(0,s5.d2)(),u=o.useCallback(e=>{let t=m[(0,tA.yG)(e)],n=l.find(t=>t.setKey===e);if(n)return(e=>{if(e)return void 0===t&&(t=e.modeData.modeOptions[0].modeId.guid),e.modeData.modeOptions.find(e=>e.modeId.guid!==t&&(t=e.modeId.guid,!0))?.modeId.guid})(n)},[m,l]),E=l.length>0?l[0]:void 0,y=E?.setKey,g=E?.modeData.collectionID,h=o.useMemo(()=>y&&u(y),[y,u]),v=(0,r.wA)();return{localVariableSets:d,allVariableSets:l,firstVariableSet:E,firstVariableSetID:g,firstVariableSetMode:h,getDefaultNewModeForVariableCollectionKey:u,reportAnalyticsEventWhenSelected:e=>{let t=i.mSn.getVariableSetInfoForSetModeAnalytics(e);v((0,oQ.Zh)({name:"prototype.set_mode_select_variable_set",params:{...t}}))},subscribedVariableSetsWithSections:p}}function ci({targetVariableSetID:e,targetVariableModeID:t,deprecatedTargetVariableSetKey:n,updateSelectionProperties:a,recordingKey:r,actionIndexPath:l}){let{getDefaultNewModeForVariableCollectionKey:i,allVariableSets:s,reportAnalyticsEventWhenSelected:c}=cl(),{shouldShowAdvancedPrototypingPaywall:d,showAdvancedPrototypingVariablesModal:p}=(0,rR.zt)(),m=(0,j.GS)();o.useEffect(()=>{if(!n||(0,tb.gl)(n))return;let e=s.find(e=>e.setKey===n);e?((0,th.Lo)("SetVariableModeControls","updating variable set key to non-deprecated id value"),a({targetVariableSetKey:void 0,targetVariableSetID:e?.modeData.collectionID})):((0,th.Lo)("SetVariableModeControls","attempted to update variable set key to non-deprecated id value, but could not find it in the list of variable sets, will just clear out the bad data."),a({targetVariableSetKey:void 0}))},[n,s,a]);let[u,E]=o.useMemo(()=>{let t=(0,tb.gl)(e)||void 0===e?e:function(e,t){let n=e.find(e=>e.modeData.collectionID===t);if(n)return n;let a=sJ.gr.toRefIfSubscribed(t);if(a)return e.find(e=>e.setKey===a.key)}(s,e)||s9,n=(()=>{if(!(0,tb.gl)(t)&&void 0!==t&&t!==s9)return t})();return[t,n]},[e,s]),y=o.createElement(cd,{selectedVariableSet:u,onChange:e=>{d?p():(c(e.modeData.collectionID),a({targetVariableSetID:e.modeData.collectionID,targetVariableModeID:i(e.setKey)}))},actionIndexPath:l}),g=m?o.createElement(oA.cS,{input:y,label:(0,_.tx)("proto.set_variable_mode.collection_label")}):o.createElement(tJ.fI,{recordingKey:tD.Pt(r,"selectTargetVariableSet")},y),h=o.createElement(cu,{selectedVariableSetKey:E&&E.setKey,selectedVariableModeID:t,onChange:e=>{d?p():a({targetVariableModeID:e})},actionIndexPath:l}),v=m?o.createElement(oA.cS,{input:h,label:(0,_.tx)("proto.set_variable_mode.mode_label")}):o.createElement(tJ.fI,{recordingKey:tD.Pt(r,"selectTargetVariableMode")},h);return o.createElement("div",{className:m?void 0:aG.cx.relative.$},g,E&&v)}let cs={format:e=>void 0===e?(0,_.t)("proto.prototype_panel.edit_set_mode.none"):e===s9?(0,_.t)("proto.prototype_panel.edit_set_mode.missing_collection"):e.modeData.collectionName,isEqual:(e,t)=>void 0!==e&&void 0!==t&&e!==s9&&t!==s9&&(e.setKey===t.setKey||e.modeData.collectionID===t.modeData.collectionID)};function cc(e,t){return"fileKey"in e?[t&&o.createElement(oC.sK,{key:e.fileKey+"divider"}),o.createElement(ct,{isHeader:!0,key:e.fileKey+"header",formattedValue:e.fileName})]:o.createElement(ct,{key:e.setKey,value:e})}function cd({selectedVariableSet:e,onChange:t,actionIndexPath:n}){let a=(0,r.wA)(),l=(0,nT.Um)(),i="set-variable-mode--select-variable-set-"+n,{localVariableSets:c,allVariableSets:d,subscribedVariableSetsWithSections:p}=cl();return o.createElement(ce,{id:i,className:s6,property:e,formatter:cs,dispatch:a,dropdownShown:l?.type===i?l:null,onChange:e=>{(0,tb.gl)(e)||void 0===e||e===s9||t(e)}},d.length>0?[c.length>0&&o.createElement(ct,{key:tD.Pt(i,"local_variables"),isHeader:!0,formattedValue:(0,s.kc)().ds_variable_props_unified_ui?(0,_.t)("variables.mode_properties_panel.assets_created_in_file.subheading"):(0,_.t)("variables.mode_properties_panel.local_variables.subheading")}),...c.map(e=>cc(e,!1)),...p.map((e,t)=>cc(e,c.length>0||t>0))]:[])}let cp={format:e=>void 0===e?(0,_.t)("proto.prototype_panel.edit_set_mode.none"):e===s9?(0,_.t)("proto.prototype_panel.edit_set_mode.missing_mode"):e?.name??""};function cm(e){return o.createElement(ca,{key:e.modeId.guid,value:e})}function cu({selectedVariableSetKey:e,selectedVariableModeID:t,onChange:n,actionIndexPath:a}){let l=(0,r.wA)(),i=(0,nT.Um)(),s="set-variable-mode--select-variable-mode-"+a,{allVariableSets:c}=cl(),d=o.useMemo(()=>c.find(t=>t.setKey===e)?.modeData.modeOptions,[e,c]),p=o.useMemo(()=>(0,tb.gl)(t)||void 0===t?t:d?.find(e=>e.modeId.guid===t)||s9,[t,d]);return o.createElement(cn,{id:s,className:s6,property:p,formatter:cp,dispatch:l,dropdownShown:i?.type===s?i:null,onChange:e=>{!e||(0,tb.gl)(e)||e===s9||n(e.modeId.guid)}},d&&d?.map(cm))}var cE=n(910392),cy=n(909666),c_=n(442458);let cg=oZ.TI;function ch({children:e}){return(0,j.GS)()?o.createElement(oA.TN,null,e):o.createElement(tJ.fI,{className:"overlay_panel--fplCheckboxRow--EYTAZ checkbox--_checkboxRow--oEhow"},e)}function cv({interactionType:e,recordingKey:t,actionIndexPath:n,nodeId:a}){let[l,s]=o.useState(!1),[c,d]=o.useState(new ob.Mi),p=(0,r.wA)(),m=(0,j.GS)(),u="{ "+n.join(", ")+" }",{destinationOverlayBackgroundColor:E,destinationOverlayBackgroundType:y,destinationOverlayPositionType:g,destinationOverlayBackgroundInteraction:h}=(0,lN.R)(e=>({destinationOverlayBackgroundColor:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[u]?.destinationOverlayBackgroundColor,destinationOverlayBackgroundType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[u]?.destinationOverlayBackgroundType,destinationOverlayPositionType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[u]?.destinationOverlayPositionType,destinationOverlayBackgroundInteraction:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[u]?.destinationOverlayBackgroundInteraction})),v=o.useRef(),f=o.useRef(),S=o.useCallback(()=>{s(!1)},[s]),b=o.useCallback(()=>{if(l)S();else{s(!0);let e=m?tq.findDOMNode(f.current):tq.findDOMNode(v.current);d((0,oI.cn)(e))}},[l,S,m]),T=o.useCallback(e=>{let t=e?"SOLID_COLOR":"NONE";tk.l7.user("overlay-background-type-edit-scope",()=>{i.X3B.setOverlayBackgroundType(oX.dI(a),t)}),p((0,oQ._P)({name:"Overlay background visible changed",params:{backgroundType:t}}))},[p,a]),N=o.useCallback(e=>{let t=e?"CLOSE_ON_CLICK_OUTSIDE":"NONE";tk.l7.user("overlay-background-interaction-edit-scope",()=>{i.X3B.setOverlayBackgroundInteraction(oX.dI(a),t)}),p((0,oQ._P)({name:"Overlay background interaction changed",params:{backgroundInteraction:t}}))},[p,a]),I=o.useCallback(()=>(0,tb._W)(E,{r:0,g:0,b:0,a:.25}),[E]),P=o.useCallback((e,t)=>{t!==rC.zk.NO&&tk.l7.user("overlay-background-color-edit-scope",()=>{i.X3B.setOverlayBackgroundColor(oX.dI(a),e)})},[a]),C=o.useCallback((e,t)=>{P(e,rC.zk.YES)},[P]),A=o.useCallback((e,t)=>{let n=I();P({r:n.r,g:n.g,b:n.b,a:e},t)},[I,P]),k=o.useCallback(e=>{tk.l7.user("overlay-position-type-edit-scope",()=>{i.X3B.setOverlayPositionType(oX.dI(a),e)}),p((0,oQ._P)({name:"Overlay position changed",params:{position:e}}))},[p,a]),w=I(),O=I().a,x=(0,tb.E7)(g),D="CLOSE_ON_CLICK_OUTSIDE"===(0,tb.E7)(h),R="SOLID_COLOR"===(0,tb.E7)(y),M=o.createElement("div",{className:"overlay_panel--colorValueContainer--gJtb9 paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},o.createElement(o0.J,{onClick:R?b:()=>{},color:w,opacity:O,recordingKey:tD.Pt(t,"chit"),className:"overlay_panel--chit--Zn66r paint_panels--chit--twQEy"}),o.createElement(o1.AN,{className:m?"overlay_panel--colorInputUI3--ozOrK paint_panels--colorInput--nSz13":"overlay_panel--colorInput--6yyym paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:cg,property:w,disabled:!R,onChange:C,recordingKey:tD.Pt(t,"colorInput"),noBorderOnFocus:!0}),o.createElement(aW.Pd,{className:"overlay_panel--opacity--vrrjV paint_panels--opacityInputContainer--oqlsk",value:O,onValueChange:A,dispatch:p,disabled:!R,noBorderOnFocus:!0,recordingKey:tD.Pt(t,"opacity")}));return o.createElement(tJ.Zk,{className:m?"overlay_panel--overlayPanelUI3--GLqgD":"overlay_panel--overlayPanel--l-Hts"},!m&&o.createElement(tJ.fI,null,o.createElement(tJ.xw,{faded:!0,className:"overlay_panel--overlayPanelTitle--e9pjs"},(0,_.tx)("proto.overlay_settings"))),o.createElement(cP,{overlayPositionType:x,onOverlayPositionTypeChange:k,recordingKey:t}),!("ON_HOVER"===e||"ON_PRESS"===e)&&o.createElement(ch,null,o.createElement(ov.S,{label:o.createElement(of.J,null,(0,_.tx)("proto.close_when_clicking_outside")),recordingKey:tD.Pt(t,"closeOnClickOutside"),onChange:N,checked:D})),o.createElement(ch,null,o.createElement(ov.S,{label:o.createElement(of.J,null,m?(0,_.tx)("proto.overlay_panel.background"):(0,_.tx)("proto.add_background")),recordingKey:tD.Pt(t,"addBackgroundBehindOverlay"),onChange:T,checked:R})),R&&(m?o.createElement(oA.cS,{ref:f,label:(0,_.tx)("proto.overlay_panel.background"),input:M}):o.createElement(tJ.fI,{ref:v}," ",M," ")),l&&o.createElement(oP.h3,{disabledVariableIds:new Set,initialPosition:c,color:w,boundVariable:null,onChange:P,onClose:S,recordingKey:tD.Pt(t,"colorPicker")}))}class cf extends oC.l6{}class cS extends oC.c${}class cb extends o.PureComponent{constructor(){super(...arguments),this.titleFormatter=new rT.Cr,this.renderOverlayPositionOption=(e,t)=>o.createElement(cS,{key:t,value:e,recordingKey:tD.Pt(this.props,e)})}render(){let e=["CENTER","TOP_LEFT","TOP_CENTER","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT"].map(this.renderOverlayPositionOption);return o.createElement(cf,{id:this.props.recordingKey??"overlay-position_select",className:this.props.className,chevronClassName:"overlay_panel--chevron--7RTA-",inputClassName:"overlay_panel--input--tGHHB",dropdownWidth:t7.DxS,property:this.props.property,formatter:this.titleFormatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,recordingKey:tD.Pt(this.props,"select")},e,o.createElement(oC.sK,null),this.renderOverlayPositionOption("MANUAL",10))}}cb.displayName="OverlayPositionDropdown";class cT extends o3.I{}class cN extends o3.Y{}class cI extends o.PureComponent{render(){return o.createElement(cT,{className:this.props.className,property:this.props.property,onChange:this.props.onChange,recordingKey:this.props.recordingKey},o.createElement(cN,{value:"CENTER",tooltip:(0,_.t)("proto.tooltip_overlay_position_center"),svg:cy.A,recordingKey:tD.Pt(this.props,"center")}),o.createElement(cN,{value:"TOP_LEFT",tooltip:(0,_.t)("proto.tooltip_overlay_position_top_left"),svg:c_.A,recordingKey:tD.Pt(this.props,"top-left")}),o.createElement(cN,{value:"BOTTOM_CENTER",tooltip:(0,_.t)("proto.tooltip_overlay_position_bottom_center"),svg:cE.A,recordingKey:tD.Pt(this.props,"bottom-center")}))}}function cP({overlayPositionType:e,onOverlayPositionTypeChange:t,recordingKey:n}){let a=(0,j.GS)(),l=(0,r.wA)(),i=(0,nT.Um)(),s=o.createElement(cb,{className:"overlay_panel--overlayPositionDropdown--ZxxSI",property:e,dispatch:l,dropdownShown:i,onChange:t,recordingKey:tD.Pt(n,"overlayPositionDropdown")}),c=o.createElement(cI,{property:e,onChange:t,recordingKey:tD.Pt(n,"overlayPositionControl"),className:"overlay_panel--overlayPositionControl--SWngJ"});return a?o.createElement(oA.cS,{label:(0,_.tx)("proto.overlay_panel.position"),input:s}):o.createElement(tJ.fI,null,s,c)}var cC=n(171447),cA=n(301036),ck=n(112976),cw=n(728587);let cO=e=>`interaction-panel-create-action-${e}`;function cx(e){let t=cO(e.recordingKey);var{showing:n,toggle:a,hide:l}=(0,nT.BK)(t);let i=(0,o.useRef)(null),{recordingKey:s,addButtonPressed:c,presetInteractions:d}=e,{shouldShowAdvancedPrototypingPaywall:p,showAdvancedPrototypinglMultipleActionsModal:m}=(0,rR.zt)(),u=(0,o.useCallback)(()=>{!e.skipPaywall&&p?m():a()},[e.skipPaywall,p,m,a]),E=tD.rf(tD.Pt(s,"createActionDropdown"),"click",u),y=(0,rR.YT)()===rR.Oz.TWO_COL,g=(0,rR.hP)(),h=(0,j.GS)(),v=(0,lO.cJ)(),f=(0,rR.He)({showVideoActions:g,isNestedInConditional:e.isNestedInConditional,isSites:v,isUI3:h,showPresetActions:!!e.presetInteractions}),S=(0,r.wA)(),b=(0,o.useCallback)(e=>{c((0,rR.Bs)(e)),l()},[c,l]),T=t4()({[sY.x1]:e.renderButton,[sY.xm]:!e.renderButton&&!y,[sY.U3]:!e.renderButton&&y}),N=[];return f.forEach(e=>{(0,rR.vc)(e)?N.push(ck.w):e===rR.Xk&&d?.length?N.push(...d,ck.w):N.push(function({actionType:e,clickCb:t,recordingKey:n,isUI3:a}){let r=(0,rN.Yb)(e),l=(0,rN.av)(e),i=new rT.Z6(a),s=e?i.format(e):"Undefined";return{className:sY.BP,callback:()=>t(e),icon:o.createElement(t1.U,{className:sY.QE,svg:r},l),displayText:s,recordingKey:tD.Pt(n,"createActionOption",e)}}({clickCb:b,recordingKey:s,actionType:e,isUI3:h}))}),o.createElement(o.Fragment,null,o.createElement("button",{ref:i,className:T,onClick:E,"aria-label":(0,_.t)("proto.prototype_panel.create_action_button"),"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":e.isNestedInConditional?(0,_.t)("proto.prototype_panel.add_nested_action"):(0,_.t)("proto.prototype_panel.add")},e.renderButton?o.createElement(t1.U,{svg:ni.A},o.createElement(nx.e,null)):(0,_.tx)("fullscreen.properties_panel.click_plus_to_add_new_action")),n&&i.current&&o.createElement(cw.j,{minWidth:130,lean:"center",parentRect:i.current.getBoundingClientRect(),hidePointWhenContentOffScreen:!0,showPoint:!0,items:N,dispatch:S,onSelectItem:e=>e.callback?.(),recordingKey:"actionDropdown"}))}let cD="prototype_conditional_controls--conditionalRowUI3--rQlu6",cR="prototype_conditional_controls--conditionIcon--Npk57";var cM=n(381809),cL=n(527967),cV=n(5068);function cK({onDeleteAction:e,updateMultipleDestinationNodes:t,updateSelectionProperties:n,updateCondition:a,updateActions:r,onAddAction:l,autoOpenVariablePicker:s,isSelected:c,handleMouseDownUI3:d,...p}){let m=p.conditionalActions,u=m?.actions?m?.actions:[],E=m?.condition?m?.condition:void 0,y=(0,rR.YT)()===rR.Oz.TWO_COL,g=y?cD:"prototype_conditional_controls--conditionalRowIf--25FqB prototype_conditional_controls--conditionalRow--u0PaS",h=o.createElement(sP.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:E,updateSelectionProperties:n,recordingKey:p.recordingKey,updateConditionInConditionalAction:a,showVariableThumbnails:!0,isNarrowPanel:!0}),v=o.createElement("div",{className:"prototype_conditional_controls--addButton--vlYLn"},o.createElement(cx,{addButtonPressed:l,recordingKey:tD.Pt(p.recordingKey,"addActionToIfButton"),renderButton:!0,isNestedInConditional:!0})),f=o.createElement(o.Fragment,null,y?o.createElement("span",{className:"prototype_conditional_controls--conditionIconUI3--zcwx0"},(0,_.tx)("proto.else")):o.createElement(rb.B,{className:cR,svg:cM.A}),!y&&u.length>0&&o.createElement("div",{className:"prototype_conditional_controls--addButtonForElse--ogBWu prototype_conditional_controls--addButton--vlYLn"},o.createElement(cx,{addButtonPressed:l,recordingKey:tD.Pt(p.recordingKey,"addActionToElseButton"),renderButton:!y,isNestedInConditional:!0}))),S=y?o.createElement(aR.E,{className:"prototype_conditional_controls--elseBlockRowUI3--VXjmO",onClick:d},f):o.createElement(tJ.fI,{className:y?cD:"prototype_conditional_controls--conditionalRow--u0PaS"},f);return o.createElement(o.Fragment,null,p.ifStatement&&o.createElement("div",{className:g},!y&&o.createElement(sk.Y,{direction:"horizontal",spacing:4},o.createElement("span",{className:y?"prototype_conditional_controls--conditionalRowConditionUI3--M2mOx":"prototype_conditional_controls--conditionalRowCondition--kn-f7"},o.createElement(sk.Y,{direction:"horizontal",spacing:0},o.createElement(rb.B,{className:cR,svg:cL.A}),o.createElement(sk.Y,{direction:"horizontal",spacing:0},(0,tb.hS)(E)&&h),o.createElement(rb.B,{className:"prototype_conditional_controls--icon--JV1i0",svg:cV.default}))),!y&&u.length>0&&v)),!p.ifStatement&&S,u&&u.map((a,r)=>o.createElement(db,{key:r,updateMultipleDestinationNodes:t.appendActionIndex(r),action:a,recordingKey:tD.Pt(p.recordingKey,"conditional-action-row",r),updateSelectionProperties:n.appendActionIndex(r),onDeleteAction:()=>e(r),interactionType:p.interactionType,actionIndexPath:[p.actionIndexPath[0],p.actionIndexPath[1],r],numActions:u.length,isNestedInConditional:!0,stateManagementVersion:p.stateManagementVersion,selectedInteractions:p.selectedInteractions,onDrop:p.onDrop,onSelect:p.onSelect,onExpand:p.onExpand,onAddAction:l,selectedActionIndex:p.selectedActionIndex,expandedRows:p.expandedRows,autoOpenVariablePicker:s})),0===u.length&&o.createElement(db,{key:0,updateMultipleDestinationNodes:t.appendActionIndex(0),action:p.emptyAction,recordingKey:tD.Pt(p.recordingKey,"conditional-action-row",0),updateSelectionProperties:n.appendActionIndex(0),onDeleteAction:()=>e(0),interactionType:p.interactionType,actionIndexPath:[p.actionIndexPath[0],p.actionIndexPath[1],0],numActions:u.length,isNestedInConditional:!0,stateManagementVersion:p.stateManagementVersion,selectedInteractions:p.selectedInteractions,onDrop:p.onDrop,onSelect:p.onSelect,onExpand:p.onExpand,onAddAction:l,selectedActionIndex:p.selectedActionIndex,expandedRows:p.expandedRows,autoOpenVariablePicker:s}))}function cF(e,t,n){return function(a){var o=[...t];o.length>e?o[e].condition=a:o.push({condition:0===e?a:void 0,actions:[]},{condition:1===e?a:void 0,actions:[]}),n({conditionalActions:o})}}function cU({onDrop:e,onSelect:t,onExpand:n,action:a,updateMultipleDestinationNodes:l,updateSelectionProperties:i,interactionType:s,recordingKey:c,stateManagementVersion:d,selectedInteractions:p,actionIndexPath:m,selectedActionIndex:u,expandedRows:E,autoOpenVariablePicker:y,onNewActionAdded:g,handleMouseDownUI3:h}){let v=(0,r.wA)(),f=(0,C.p8)("currentPage"),S=(0,rR.YT)()===rR.Oz.TWO_COL,b=S?u.equals(m):void 0,{shouldShowAdvancedPrototypingPaywall:T,showAdvancedPrototypingConditionalActionsModal:N}=(0,rR.zt)(),I=(0,tb.hS)(a.conditionalActions)&&a.conditionalActions?a.conditionalActions:[],P=e=>function(t){var n=[...I];n.length>e?n[e].actions=[...t]:n.push({actions:t}),i({conditionalActions:n})},A=e=>function(t){var n=[...I],a=0;if(n.length>e){var o=n[e].actions;o?o.push(t):o=[t],a=o.length}else n.push({actions:0===e?[t]:[]},{actions:1===e?[t]:[]}),a=1;"SET_VARIABLE"===t.connectionType&&(y.current=!0),i({conditionalActions:n}),g&&g(new cA.Op([m[0],e,a-1])),v((0,oQ._P)({name:"Prototype add action",params:{action:t.connectionType?t.connectionType:"NONE",source:"panel",page_id:f,actionInConditionalAction:!0}}))},k=e=>function(t){if(T)N();else{var n=[...I];let a=I[e],o=[];if(a&&a.actions)for(let e=0;e<a.actions.length;e++){let n=a.actions[e];e!==t?o.push(n):v((0,oQ._P)({name:"Prototype delete action",params:{action:n.connectionType?n.connectionType:"NONE",source:"panel",page_id:f,actionInConditionalAction:!0}}))}n[e].actions=o,i({conditionalActions:n})}},w=I.length>0?I[0]:void 0,O=I.length>1?I[1]:void 0;return o.createElement("div",{style:S?{position:"relative"}:void 0},(0,tb.gl)(a.conditionalActions)&&o.createElement(sF.Y1,null,o.createElement(aR.E,{className:"prototype_conditional_controls--mixedConditionalText--6O32b",onClick:()=>{var e=[];e.push({},{}),i({conditionalActions:e})}},(0,_.t)("fullscreen.properties_panel.click_to_replace_mixed_content"))),(0,tb.hS)(a.conditionalActions)&&o.createElement(o.Fragment,null,o.createElement(cK,{key:0,conditionalActions:w,recordingKey:tD.Pt(c,"conditional-block",0),updateCondition:cF(0,I,i),updateActions:P(0),onAddAction:A(0),updateMultipleDestinationNodes:l.appendActionIndex(0),onDeleteAction:k(0),interactionType:s,updateSelectionProperties:i.appendActionIndex(0),ifStatement:!0,stateManagementVersion:d,selectedInteractions:p,actionIndexPath:[m[0],0],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:u,autoOpenVariablePicker:y,expandedRows:E,emptyAction:{ifStatement:!0,action:a},isSelected:b,handleMouseDownUI3:h}),o.createElement(cK,{key:1,conditionalActions:O,recordingKey:tD.Pt(c,"conditional-block",1),updateCondition:cF(1,I,i),updateActions:P(1),onAddAction:A(1),updateMultipleDestinationNodes:l.appendActionIndex(1),onDeleteAction:k(1),interactionType:s,updateSelectionProperties:i.appendActionIndex(1),ifStatement:!1,stateManagementVersion:d,selectedInteractions:p,actionIndexPath:[m[0],1],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:u,autoOpenVariablePicker:y,expandedRows:E,emptyAction:{ifStatement:!1,action:a},isSelected:b,handleMouseDownUI3:h})))}function cB({updateSelectionProperties:e,conditionalActions:t,autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,...r}){let l=t.length>0?t[0]:void 0,s=l?.condition?l?.condition:void 0,c=t4()({"prototype_conditional_controls--standaloneIfConditional--GLFDU":!0,"prototype_conditional_controls--placeholderText--esG0u":!s});return o.createElement(o.Fragment,null,o.createElement(oA.cS,{input:null,label:(0,_.tx)("proto.condition")}),o.createElement(aJ.Ad,{appendedClassName:"prototype_conditional_controls--conditionalActionRightPadding--xpK6Z",label:null,input:(0,tb.hS)(s)?o.createElement("div",{className:c},o.createElement(sP.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:s,updateSelectionProperties:e.appendActionIndex(0),recordingKey:r.recordingKey,updateConditionInConditionalAction:cF(0,t,e),autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,showVariableThumbnails:!0,isNarrowPanel:!0})):null}))}var cG=n(510879),cz=n(830002),cY=n(731262);class cW extends oC.c${}class cH extends oC.l6{}class c$ extends o.PureComponent{constructor(e){super(e),this.loadDestinationsFromFullscreen=()=>{let e=i.baT.ALL;"SCROLL_TO"===this.props.action?e=i.baT.SCROLL_TO:"SWAP_STATE_TO"===this.props.action&&(e=i.baT.STATES);let{viableIds:t,disabledIds:n}=i.X3B.getTransitionDestinationsOnActiveCanvas(e);return new Promise((e,a)=>{this.setState({viableIds:t,disabledIds:n},e)})},this.onOptionFocus=e=>{F.Uc(e??"")},this.renderGroupedScrollableNodes=(e,t)=>{let n=s0()(e.filter(e=>this.nodeNameFormatter.hasNameForNode(e)),e=>e===t&&(0,tb.hS)(t)?rh.Ql(this.props.scene,e)?.guid:this.props.scene.get(e)?.parentGuid),a=Object.keys(n);(0,rh.X4)(a,this.nodeNameFormatter.format.bind(this.nodeNameFormatter));let{tlfId:r,index:l}=(0,rh.H_)(this.props.scene,a);return r&&l&&(a.splice(l,1),a=[r,...a]),a.reduce((e,t,a)=>(0!==a&&e.push(o.createElement(oC.sK,{key:a})),e.push(o.createElement(cW,{key:`disabled-${t}`,value:t+" ",recordingKey:tD.Pt(this.props,`disabled-option-${t}`),disabled:!0})),n[t].forEach((t,n)=>{e.push(o.createElement(cW,{key:`enabled-${t+n}`,value:t,recordingKey:tD.Pt(this.props,`viable-option-${n}`),disabled:!1}))}),e),[])},this.state={viableIds:[],disabledIds:[]},this.nodeNameFormatter=new rT.cP(e.scene)}render(){let e=this.props.nodeId===tb.oV?tb.oV:oX.dI(this.props.nodeId),t=this.state.viableIds;(0,tb.hS)(e)&&e!==oX.AD&&-1===t.indexOf(e)&&(t=t.concat([e]));let n=this.state.disabledIds,a=`prototype-destination-select-${this.props.recordingKey}`,r="SCROLL_TO"!==this.props.action?t.filter(e=>this.nodeNameFormatter.hasNameForNode(e)).map((e,t)=>o.createElement(cW,{key:`enabled-${e}`,value:e,recordingKey:tD.Pt(this.props,`viable-option-${t}`),disabled:!1})):this.renderGroupedScrollableNodes(t,e),l=n.filter(e=>this.nodeNameFormatter.hasNameForNode(e)).map((e,t)=>o.createElement(cW,{key:`disabled-${e}`,value:e,recordingKey:tD.Pt(this.props,`disabled-option-${t}`),disabled:!0})),i=this.props.isUI3?o.Fragment:tJ.fI;return o.createElement(i,null,o.createElement(cH,{id:a,dataTestId:"destination-select",className:this.props.className,chevronClassName:"prototype_destination_dropdown--chevron--pmWtI",inputClassName:"prototype_destination_dropdown--input--rzglN",dropdownWidth:t7.DxS,property:e,formatter:this.nodeNameFormatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,recordingKey:tD.Pt(this.props,"select"),willShowDropdown:this.loadDestinationsFromFullscreen,onOptionFocus:this.onOptionFocus,hideDropdownWhenContainerMoves:!(0,e9.nl)()},r,0!==n.length&&0!==t.length&&o.createElement(oC.sK,null),l))}}let cX=o.memo(function(e){let t=(0,ee.tS)(),n=(0,ee._G)(),a=(0,r.d4)(cQ),l=(0,r.d4)(rP.qd),s=(0,r.d4)(rP.dK),c=(0,cG.D)(l,s),d=(0,r.d4)(cJ),p=o.useMemo(()=>(0,cY.cP)(d,t,n,e.actionIndexPath),[d,t,n,e.actionIndexPath]),m=o.useMemo(()=>(0,cY.cP)(a,t,n),[a,t,n]),u=p||m;if(!u||u.mode!==i.iCO.STATE_OR_STATE_INSTANCE_SUBLAYER)return null;let{allStates:E,stateGroupModel:y,selectedStates:_,selectedStatesPropertyValues:g}=u,h=y.propertySortOrder||[],v=y.propertyValues;return v?o.createElement(cz.lS,{sortedProperties:h,stateGroupPropertyValues:v,selectedStatesPropertyValues:g,selectedStates:_,allStates:E,onSelectProperty:t=>{let n={};for(let e of Object.keys(t)){let a=t[e].symbol.node_id;for(let t of(n[e]=a,c[e]||[]))n[t]=a;for(let e of l)n[e]||(n[e]=a)}e.onChange(n)},recordingKey:e.recordingKey,hideErrorsPanel:!0,shouldIndent:!0,extended:!0}):null});function cQ(e){return e.mirror.selectionProperties.stateGroupSelectionInfo}function cJ(e){return e.mirror.selectionProperties.prototypeDestinationStateGroupSelectionInfo}var cq=n(169231),cj=n(511787),cZ=n(939143),c0=n(720531);let c1="prototype_set_variable_controls--dropdownAndIconContainer--6m3Tw",c2="prototype_set_variable_controls--icon---HzDt",c8="prototype_set_variable_controls--placeholderText--PBIqf";function c4({targetVariableData:e,targetVariable:t,updateSelectionProperties:n,autoOpenVariablePicker:a,...l}){let c=o.useRef(null),d=(0,r.wA)(),p=(0,j.GS)(),m=(0,r.d4)(e=>e.variablePickerShown),u=(0,ad.tZ)((0,tb.hS)(t)&&"id"in t?t.id:void 0),E=(0,ad.u)((0,tb.hS)(t)&&"id"in t?t.id:void 0),[y,g]=o.useState("");(0,iO.h)(()=>{a&&!0===a.current&&(v(),a.current=!1)});let h=(0,ad.BQ)((0,tb.hS)(t)&&"id"in t?t.id:void 0)??(0,sU.m9)((0,tb.hS)(t)&&"nodeFieldAlias"in t?t.nodeFieldAlias:void 0);o.useEffect(()=>{void 0!==e&&h&&"MIXED"!==h&&(0,tb.hS)(e)&&e.resolvedType!==h.resolvedType&&!((0,sU.tz)(e.resolvedType)&&(0,sU.tz)(h.resolvedType))&&n({targetVariableData:void 0})},[h,n,e]);let v=()=>{let e=c.current.getBoundingClientRect();d((0,cq.C)({type:"variable-picker-set-variable-action",isShown:!0,resolvedType:i.rXF.STRING,initialPosition:new ob.Mi(e.left-20,e.top),key:l.recordingKey,onVariableSelected:T}))},f=o.useCallback(()=>{d((0,cq.B)())},[d]),[S,b]=o.useState(!1),T=o.useCallback(t=>{if(void 0!==t&&t.node_id){let a={targetVariable:{id:t.node_id}},o=i.CWU.getVariableResolvedValue(t.node_id,new Map);!e&&t.resolvedType===i.rXF.COLOR&&o&&(a.targetVariableData=o??void 0),n(a),d((0,oQ.Zh)({name:"prototype.variable_selected",params:{collectionId:t.variableSetId,variableId:t.node_id,variableType:t.resolvedType}})),b(!0)}},[d,e,n]),N=o.useCallback(e=>{e.value.stablePath.map(e=>oX.sH(e))&&(n({targetVariable:{nodeFieldAlias:{stablePathToNode:e.value.stablePath,nodeField:"COMPONENT_PROP_ASSIGNMENTS",indexOrKey:e.value.explicitDefId}}}),b(!0))},[n]),I=o.useMemo(()=>({type:"LOCAL_VARIABLES",layout:"list"}),[]);o.useEffect(()=>{let e=i.Ez5.prototypingEditorState().colorPickerEyedropperVarData;return(0,A.lu)(e,{onChangeImmediate(){let t=e.getCopy();t&&n({targetVariableData:t})}})},[n]);let P="nodeFieldAlias"in t?(0,sU.aA)(t.nodeFieldAlias.stablePathToNode,t.nodeFieldAlias.indexOrKey):void 0,C=P?(0,sU.Xx)(P.varValue.resolvedType):null,k=null;if((0,tb.gl)(t))k=null;else if(h?.resolvedType===i.rXF.COLOR)k=(0,tb.gl)(e)?o.createElement("div",{className:"prototype_set_variable_controls--targetVariableDataMixedContainer--H6uGu"},(0,_.t)("fullscreen.mixed")):o.createElement(o.Fragment,null,o.createElement(c0.gJ,{variableValue:e??h,onChange:e=>{n({targetVariableData:e})},recordingKey:tD.Pt(l.recordingKey,"variableValueInput"),setVariableAction:!0,innerContainerClassName:"prototype_set_variable_controls--variableColorInputContainer--NaOmp"}));else{let t=l.isNestedInConditional?"prototype_set_variable_controls--absoluteIconInConditional--BbEmW":"prototype_set_variable_controls--absoluteIcon--1XpBF",a=i.rXF.BOOLEAN;E?a=E.resolvedType:P&&(a=P.varValue.resolvedType===i.rXF.TEXT_DATA?i.rXF.STRING:P.varValue.resolvedType),k=o.createElement("div",{className:p?void 0:aG.cx.ml12.$},o.createElement("div",{className:c1},o.createElement(sP.KN,{resolvedType:a,targetVariableData:e,autoOpenExpressionBuilder:S,setAutoOpenExpressionBuilder:b,updateSelectionProperties:n,recordingKey:l.recordingKey,isNarrowPanel:l.isNarrowPanel,showVariableThumbnails:!0}),!p&&o.createElement(rb.B,{className:t4()(c2,t),svg:cV.default})))}let w=t4()({"prototype_set_variable_controls--targetVariableDropdown--IZwoF":!p&&!l.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownNarrow--WWi-t prototype_set_variable_controls--targetVariableDropdown--IZwoF":!p&&l.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownUI3--Pz71q":p,[c8]:p&&!(u||P)}),O=(0,r.d4)(rk.ZM),x=(0,s.kc)().ds_variable_props_unified_ui&&O?(0,_.t)("proto.select_variable_unified"):p?(0,_.t)("proto.select_variable.short"):(0,_.t)("proto.select_variable"),D=o.createElement(nv.D8,{recordingKey:tD.Pt(l.recordingKey,"selectTargetVariable"),onClick:v},o.createElement("div",{className:p?void 0:(0,tb.hS)(t)?"prototype_set_variable_controls--targetVariableLabel--AFCqK":"prototype_set_variable_controls--targetVariableLabelInactive--zHWCC prototype_set_variable_controls--targetVariableLabel--AFCqK",ref:c},o.createElement(sk.Y,null,o.createElement("div",{className:w},o.createElement("div",{className:c1},(0,tb.gl)(t)?o.createElement("div",{className:t4()(aG.cx.pt2.$,aG.cx.pb2.$)},(0,_.t)("fullscreen.mixed")):u?o.createElement(sz.wG,{text:u,thumbnailValue:h,isDeleted:!!E&&(0,sG.eF)(E)}):P?o.createElement(sz.wG,{text:P.name,thumbnailValue:C,isDeleted:!1,colorTheme:sz.J2.COMPONENT}):o.createElement("div",{className:t4()(aG.cx.pt2.$,aG.cx.pb2.$,p?"prototype_set_variable_controls--placeholderTextColorUI3--Pc-4N":void 0)},x),!p&&o.createElement(rb.B,{className:c2,svg:cV.default})))))),R=p?o.createElement(oA.cS,{input:D,label:(0,s.kc)().ds_variable_props_unified_ui?(0,_.tx)("proto.target"):(0,_.tx)("proto.variable")}):D,M=t4()({"prototype_set_variable_controls--setVariableToContainerNarrow--HHbHQ prototype_set_variable_controls--setVariableToContainer--kxsCZ":!p&&l.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainer--kxsCZ":!p&&!l.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainerUI3--pGbDe":p,[c8]:p&&!e&&h?.resolvedType!==i.rXF.COLOR}),L=o.createElement("div",{className:M,"data-testid":"set-variable-container"},k),V=p?null!==k?o.createElement(oA.cS,{label:(0,_.tx)("proto.variable.value"),input:L}):null:L;return o.createElement("div",{className:p?void 0:aG.cx.relative.$},R,m.isShown&&"variable-picker-set-variable-action"===m.type&&m.key===l.recordingKey?o.createElement(o.Fragment,null,o.createElement(or.vx,{title:"",headerSize:"hidden",initialPosition:m.initialPosition,onClose:f,dragHeaderOnly:!1,initialWidth:216,canRenderBelowViewport:!0},o.createElement(cZ.YK,{selectedItem:E,disabledVariableIds:new Set,currentView:I,toggleLayout:rS.lQ,pickerType:"set-variable",setControlRightButtons:o.createElement(cj.f,{resolvedTypes:[i.rXF.BOOLEAN,i.rXF.STRING,i.rXF.FLOAT,i.rXF.COLOR]}),onVariableSelected:T,onClose:f,recordingKey:tD.Pt(l.recordingKey,"variablePickerForSelection"),searchQuery:y,onSearchInputChange:g,onComponentPropSelected:(0,s.kc)().ds_variable_props_proto?N:void 0})),o.createElement(cZ.$3,{onClose:f})):null,V)}var c3=n(896474),c5=n(394781);let c7=(0,r$.ex)("prototype_state_management_info",function(){let e=o.createElement("a",{className:aG.cx.cursorPointer.colorTextTooltipSecondary.$,href:"https://help.figma.com/hc/articles/14397859494295",rel:"noopener noreferrer",target:"_blank",onMouseDown:e=>{e.stopPropagation(),e.preventDefault()}},(0,_.tx)("proto.state_management.info_tooltip_learn_more")),t=o.createElement("span",null,o.createElement("strong",null,(0,_.tx)("proto.animation_panel.preserve_scroll_position")));return o.createElement("div",{className:"prototype_state_management_info_tooltip--stateManagementMoreInfo---gER1 tooltip--text--Ll1mS"},(0,_.tx)("proto.state_management.info_tooltip",{PreserveScrollPositionBold:t,LearnMoreLink:e}))}),c6="prototype_state_management_panel--checkboxRow--2u02e checkbox--_checkboxRow--oEhow",c9="prototype_state_management_panel--expandCaret--uuDge";function de({transition:e,navigationType:t,recordingKey:n,showPreserveScrollPosition:a,showResetVideoState:l,showResetInteractiveComponentState:i,updateSelectionProperties:s,stateManagementVersion:c,selectedInteractions:d}){let p=(0,r.wA)(),m=(0,j.GS)(),[u,E]=o.useState(!m),y=o.useContext(sB.c);if((0,rR.YT)()===rR.Oz.TWO_COL&&y===sB.P.LEFT)return null;let g=(0,rR.LH)(c),h=o.createElement(ov.S,{onChange:t=>{p((0,oQ._P)({name:"Preserve Scroll Changed",params:{newValue:t}})),s({...function(e){if((0,tb.hS)(e.preserveScroll))return{transitionPreserveScroll:e.preserveScroll}}({...e,preserveScroll:t})})},checked:!0===e.preserveScroll,mixed:(0,tb.gl)(e.preserveScroll),recordingKey:tD.Pt(n,"preserve-scroll-check"),label:o.createElement(of.J,null,(0,_.tx)("proto.animation_panel.preserve_scroll_position"))}),v=m?o.createElement(oA.TN,null,h):o.createElement(tJ.fI,{className:c6},h),f=o.createElement(ov.S,{onChange:t=>{p((0,oQ._P)({name:"Reset Scroll Position Changed",params:{newValue:t,noodleUpgradedThisSession:c5.zZ.haveAnyInteractionsBeenUpgraded(d)}})),s({...function(e){if((0,tb.hS)(e.resetScrollPosition))return{transitionResetScrollPosition:e.resetScrollPosition}}({...e,resetScrollPosition:t})})},checked:!0===e.resetScrollPosition,mixed:(0,tb.gl)(e.resetScrollPosition),recordingKey:tD.Pt(n,"reset-scroll-position-check"),label:o.createElement(of.J,null,(0,_.tx)("proto.animation_panel.reset_scroll_position"))}),S=o.createElement("div",{"data-tooltip-type":t2.Ib.SPECIAL,"data-tooltip":c7,"data-tooltip-interactive":!0,"data-tooltip-show-immediately":!0,"data-tooltip-max-width":240,className:m?"prototype_state_management_panel--stateManagementPanelTooltipUI3--x5MQ3":void 0},o.createElement(c3.In,{icon:"info-16"})),b=m?o.createElement(oA.TN,null,f," ",S):o.createElement(tJ.fI,{className:c6},f),T=o.createElement(ov.S,{onChange:t=>{p((0,oQ._P)({name:"Reset Component State Changed",params:{newValue:t,noodleUpgradedThisSession:c5.zZ.haveAnyInteractionsBeenUpgraded(d)}})),s({...function(e){if((0,tb.hS)(e.resetInteractiveComponents))return{transitionResetInteractiveComponents:e.resetInteractiveComponents}}({...e,resetInteractiveComponents:t})})},checked:!0===e.resetInteractiveComponents,mixed:(0,tb.gl)(e.resetInteractiveComponents),recordingKey:tD.Pt(n,"reset-component-state-check"),label:o.createElement(of.J,null,(0,_.tx)("proto.animation_panel.reset_component_state"))}),N=m?o.createElement(oA.TN,null,T):o.createElement(tJ.fI,{className:c6},T),I=o.createElement(ov.S,{onChange:t=>{p((0,oQ._P)({name:"Reset Video Position Changed",params:{newValue:t}})),s({...function(e){if((0,tb.hS)(e.resetVideoPosition))return{transitionResetVideoPosition:e.resetVideoPosition}}({...e,resetVideoPosition:t})})},checked:!0===e.resetVideoPosition,mixed:(0,tb.gl)(e.resetVideoPosition),recordingKey:tD.Pt(n,"reset-video-position-check"),label:o.createElement(of.J,null,(0,rR.LH)(c)?(0,_.tx)("proto.state_management.reset_video_state"):(0,_.tx)("proto.animation_panel.reset_video_state"))}),P=m?o.createElement(oA.TN,null,I):o.createElement(tJ.fI,{className:c6},I),C=o.createElement(tJ.Zk,{className:`prototype_state_management_panel--stateManagementPanel--sYaaj ${(0,rR.kM)(c)&&"prototype_state_management_panel--stateManagementPanelWithVersion--AovOP"}`},!m&&o.createElement(tJ.fI,null,o.createElement(tJ.xw,{className:"prototype_state_management_panel--panelTitle--Nr4Eh",faded:!0},(0,_.tx)("proto.state_management")),!(0,rR.kM)(c)&&S),(0,rR.uU)(c)&&a&&v,l&&(0,rR.uU)(c)&&P,g&&b,g&&i&&N,g&&l&&P,(0,tb.gl)(c)&&o.createElement(sk.Y,{direction:"horizontal",padding:{horizontal:12,vertical:12}},o.createElement(tJ.UZ,null,(0,_.tx)("proto.state_management.mixed_state_update")))),A=o.createElement(t1.U,{svg:u?nr.A:nl.A},u?o.createElement(tZ.O,{className:c9}):o.createElement(tj.k,{className:c9})),k=o.createElement(aR.E,{key:"expand-caret",recordingKey:tD.Pt(n,"expand-caret"),onClick:()=>{E(!u)},actionOnPointerDown:!0,className:"prototype_state_management_panel--expandRow--RVDCp"},A,o.createElement("span",null,(0,_.tx)("proto.state")));return o.createElement(tL.k,{name:"prototype_state_management_panel"},m&&k,(u||!m)&&C)}class dt extends oC.c${}class dn extends oC.l6{}let da=oX.AD;class dr extends rT.cP{format(e){return e===da||null===e?(0,_.t)("proto.target_video_node_name_formatter.this_video"):super.format(e)}}function dl(e){let{viableSameFrameVideoIds:t,disabledSameFrameVideoIds:n,scene:a,dropdownShown:l,targetVideoNodeID:i,isVideoSelected:s,onChange:c}=e,d=(0,r.wA)(),[p,m]=o.useState(()=>s?new dr(a):new rT.cP(a));t.sort((e,t)=>{let n=p.format(e),a=p.format(t);return n.localeCompare(a)}),s&&t.unshift(da);let u=t.length>0&&n.length>0,E=`prototype-target-video-select-${e.recordingKey}`,y=(0,j.GS)(),g=o.createElement(dn,{id:E,dataTestId:"target-video-select",className:"prototype_target_video_dropdown--targetVideoDropdown--6hKF-",chevronClassName:"prototype_target_video_dropdown--chevron--jgz53",inputClassName:"prototype_target_video_dropdown--input--infAK",property:(0,tb.gl)(i)?i:oX.dI(i),formatter:p,onChange:c,dispatch:d,dropdownShown:l,recordingKey:tD.Pt(e,"select"),onOptionFocus:e=>{F.Uc(e??"")},dropdownAlignment:"left"},t.filter(e=>p.hasNameForNode(e)).map((t,n)=>o.createElement(dt,{key:`enabled-${n}`,value:t,recordingKey:tD.Pt(e,`viable-option-${n}`),disabled:!1})),u&&o.createElement(oC.sK,null),n.filter(e=>p.hasNameForNode(e)).map((t,n)=>o.createElement(dt,{key:`disabled-${n}`,value:t,recordingKey:tD.Pt(e,`viable-option-${n}`),disabled:!0})));return y?o.createElement(oA.cS,{input:g,label:(0,_.tx)("proto.video_dropdown.label")}):g}var di=n(946689);function ds({action:e,recordingKey:t,onURLChange:n,onOpenInNewTabChange:a}){let r=(0,j.GS)(),l=o.createElement(di.ks,{className:r?"prototype_open_url_action_options--urlInputUI3--H-JfT":"prototype_open_url_action_options--urlInput--T-tGT",dataTestId:"url-input",placeholder:(0,_.t)("proto.interaction.example_com"),value:(0,tb.gl)(e.connectionURL)?(0,_.t)("fullscreen.mixed"):(0,tb._W)(e.connectionURL,""),onChange:n,recordingKey:tD.Pt(t,"urlTextInput"),autoFocus:!1}),i=o.createElement(ov.S,{label:o.createElement(of.J,null,(0,_.tx)("proto.action_open_url_in_new_tab")),onChange:a,recordingKey:tD.Pt(t,"open-url-in-new-tab-check"),checked:void 0===e.openUrlInNewTab||!0===e.openUrlInNewTab});return o.createElement(o.Fragment,null,r?o.createElement(oA.cS,{label:(0,_.tx)("proto.open_url.text_input_label"),input:l}):l,r?o.createElement(oA.TN,null,i):o.createElement(tJ.fI,{className:"prototype_open_url_action_options--checkboxRow--mu17T checkbox--_checkboxRow--oEhow"},i))}var dc=n(588599);function dd({updateSelectionProperties:e,action:t,extraScrollOffset:n,showScrollToOptions:a,recordingKey:l}){let{smallNudgeAmount:i,bigNudgeAmount:s}=(0,to.sT)(),c=(0,r.wA)(),d=(0,j.GS)(),p=(t,n)=>(a,o)=>{t&&e({extraScrollOffset:{...t,[n]:a}},{shouldCommit:o})},m=(0,tb._W)(n,{x:0,y:0});if(!a||"SCROLL_TO"!==t)return null;let u=o.createElement(aW.gq,{className:d?void 0:sY.U,inputClassName:d?sY.oM:sY.hF,value:m.y,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:p(m,"y"),dispatch:c,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("proto.trigger.y_offset"),tooltipForScreenReadersOnly:!1,recordingKey:tD.Pt(l,"extraScrollOffsetY")},d?o.createElement("span",{className:sY.QK},(0,_.tx)("proto.scroll_options.scroll_offset.y")):o.createElement(rb.B,{className:sY.QK,svg:dc.A})),E=o.createElement(aW.gq,{className:d?void 0:sY.sC,inputClassName:d?sY.oM:sY.hF,value:m.x,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:p(m,"x"),dispatch:c,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("proto.trigger.x_offset"),tooltipForScreenReadersOnly:!1,recordingKey:tD.Pt(l,"extraScrollOffsetX")},d?o.createElement("span",{className:sY.QK},(0,_.tx)("proto.scroll_options.scroll_offset.x")):o.createElement(rb.B,{className:sY.Kh,svg:dc.A}));return d?o.createElement(oA.Cm,{label:(0,_.tx)("proto.scroll_options.offset"),leftInput:E,rightInput:u}):o.createElement(tJ.fI,null,u,E)}let dp=(0,o.memo)(function(e){return o.createElement("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e},o.createElement("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M18 12a6 6 0 1 1-12 0 6 6 0 0 1 12 0m1 0a7 7 0 1 1-14 0 7 7 0 0 1 14 0m-6.5-3.5a.5.5 0 0 0-1 0V12a.5.5 0 0 0 .146.354l2 2a.5.5 0 0 0 .708-.708L12.5 11.793z",clipRule:"evenodd"}))}),dm="prototype_video_action_options--chevron--mkNyv",du="prototype_video_action_options--input--3-cEi",dE=new rT.js,dy=new rT.Z6;function d_({action:e,onChange:t,updateSelectionProperties:n,dropdownShown:a,recordingKey:l}){let i=(0,j.GS)(),s=(0,rT.Od)(e),c=(0,tb.E7)(e.mediaAction),d="UPDATE_MEDIA_RUNTIME"===(0,tb.E7)(e.connectionType),p="SKIP_TO"===c,m="SKIP_FORWARD"===c||"SKIP_BACKWARD"===c,u="PLAY"===c||"PAUSE"===c||"TOGGLE_PLAY_PAUSE"===c,E="MUTE"===c||"UNMUTE"===c||"TOGGLE_MUTE_UNMUTE"===c,y=(0,r.wA)(),g=(0,to.RU)(),h=o.useCallback(e=>{n({mediaSkipToTime:e}),y((0,oQ._P)({name:"Media skip to time changed",params:{value:e}}))},[y,n]),v=`prototype-media-action-select-${l}`,f="prototype_video_action_options--shortDropdown--NOXXv",S=a&&a.type===v?dE:dy,b=o.createElement(sM,{id:v,dataTestId:"media-play-pause-select",className:f,chevronClassName:dm,inputClassName:du,property:s,formatter:S,onChange:t,dispatch:y,dropdownShown:a,recordingKey:tD.Pt(l,"select")},o.createElement(sR,{key:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",value:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",recordingKey:tD.Pt(l,"toggle-play-pause-option"),disabled:!1}),o.createElement(sR,{key:"UPDATE_MEDIA_PLAY",value:"UPDATE_MEDIA_PLAY",recordingKey:tD.Pt(l,"play-option"),disabled:!1}),o.createElement(sR,{key:"UPDATE_MEDIA_PAUSE",value:"UPDATE_MEDIA_PAUSE",recordingKey:tD.Pt(l,"pause-option"),disabled:!1})),T=o.createElement(sM,{id:v,dataTestId:"media-mute-unmute-select",className:f,chevronClassName:dm,inputClassName:du,property:s,formatter:S,onChange:t,dispatch:y,dropdownShown:a,recordingKey:tD.Pt(l,"select")},o.createElement(sR,{key:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",value:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",recordingKey:tD.Pt(l,"toggle-mute-unmute-option"),disabled:!1}),o.createElement(sR,{key:"UPDATE_MEDIA_MUTE",value:"UPDATE_MEDIA_MUTE",recordingKey:tD.Pt(l,"mute-option"),disabled:!1}),o.createElement(sR,{key:"UPDATE_MEDIA_UNMUTE",value:"UPDATE_MEDIA_UNMUTE",recordingKey:tD.Pt(l,"unmute-option"),disabled:!1})),N=o.createElement(sM,{id:v,dataTestId:"media-skip-by-select",className:f,chevronClassName:dm,inputClassName:du,property:s,formatter:S,onChange:t,dispatch:y,dropdownShown:a,recordingKey:tD.Pt(l,"select"),dropdownWidth:160},o.createElement(sR,{key:"UPDATE_MEDIA_SKIP_FORWARD",value:"UPDATE_MEDIA_SKIP_FORWARD",recordingKey:tD.Pt(l,"skip-forward-option"),disabled:!1}),o.createElement(sR,{key:"UPDATE_MEDIA_SKIP_BACKWARD",value:"UPDATE_MEDIA_SKIP_BACKWARD",recordingKey:tD.Pt(l,"skip-backward-option"),disabled:!1})),I=o.createElement(aW.qd,{className:"prototype_video_action_options--timestampContainer---DdaI",inputClassName:"prototype_video_action_options--timestamp--luOrs",dataTestId:"mediaSkipToTime-input",dispatch:y,value:e.mediaSkipToTime||0,onValueChange:h,wheelMultiplier:g/1e3,scrubMultiplier:g/1e3,max:3600,displayFractions:!0,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("proto.trigger.timestamp_to_set_to"),tooltipForScreenReadersOnly:!0,recordingKey:tD.Pt(l,"mediaSkipToTimeInput")},i?o.createElement(dp,null):void 0),P="SKIP_BACKWARD"===c?(0,_.t)("proto.trigger.duration_to_jump_backward"):(0,_.t)("proto.trigger.duration_to_jump_forward"),C=o.createElement(aW.dE,{className:"prototype_video_action_options--timeAmountContainer--5kpHn",dataTestId:"mediaSkipByAmount-input",dispatch:y,value:e.mediaSkipByAmount||5,onValueChange:e=>{n({mediaSkipByAmount:e}),y((0,oQ._P)({name:"Media skip by amount changed",params:{value:e}}))},wheelMultiplier:g/1e3,scrubMultiplier:g/1e3,max:3600,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":P,tooltipForScreenReadersOnly:!0,recordingKey:tD.Pt(l,"mediaSkipByAmountInput")});if(!d)return null;if(i){if(u)return o.createElement(oA.cS,{input:b,label:(0,_.tx)("proto.video_options.behavior")});if(E)return o.createElement(oA.cS,{input:T,label:(0,_.tx)("proto.video_options.behavior")});if(m)return o.createElement(o.Fragment,null,o.createElement(oA.cS,{input:N,label:(0,_.tx)("proto.video_options.direction")}),o.createElement(oA.cS,{input:C,label:(0,_.tx)("proto.video_options.offset")}));if(p)return o.createElement(oA.cS,{input:I,label:(0,_.tx)("proto.video_options.timestamp")})}return o.createElement(tJ.fI,null,u&&b,E&&T,m&&N,m&&C,p&&I)}function dg({action:e,recordingKey:t,interactionType:n,onActionChange:a,updateMultipleDestinationNodes:l,updateSelectionProperties:s,stateManagementVersion:c,autoOpenVariablePicker:d,autoOpenExpressionBuilder:p,setAutoOpenExpressionBuilder:m,...u}){let E=(0,r.wA)(),y=(0,nT.Um)(),{scene:g,selectionProperties:h}=(0,lN.R)(e=>({scene:e.mirror.sceneGraph,selectionProperties:e.mirror.selectionProperties})),v=(0,j.GS)(),f=(0,rR.YT)(),S=f===rR.Oz.SINGLE_COL,b=f===rR.Oz.TWO_COL,T=o.useContext(sB.c),N=b&&T===sB.P.RIGHT,I="SET_VARIABLE"===(0,tb.E7)(e.connectionType),P="SET_VARIABLE_MODE"===(0,tb.E7)(e.connectionType),C="CONDITIONAL"===(0,tb.E7)(e.connectionType),A="INTERNAL_NODE"===(0,tb.E7)(e.connectionType),k="INTERNAL_NODE"===(0,tb.E7)(e.connectionType)&&"SWAP_STATE"===(0,tb.E7)(e.navigationType),w="URL"===(0,tb.E7)(e.connectionType),O=A||"BACK"===(0,tb.E7)(e.connectionType)||"CLOSE"===(0,tb.E7)(e.connectionType),x="UPDATE_MEDIA_RUNTIME"===(0,tb.E7)(e.connectionType),D=(0,rN.dq)(h),R=(0,oa.uQ)(),M=[],L=[];if(R){let{viableIds:e,disabledIds:t}=i.X3B.getVideoNodesOnSameTlfAsNode(R);M=e,L=t}let V=oX.dI((0,tb.E7)(e.transitionNodeID)),K=null!=V&&V!==oX.AD,F=A&&(!(0,tb.hS)(e.transitionNodeID)||K),U=(0,tb.E7)(e.navigationType),B=A&&"OVERLAY"===(0,tb.E7)(U),G=(0,rR.hU)(e.transitionType,e.easingType,e.easingFunction,e.transitionDuration,e.transitionShouldSmartAnimate,e.transitionPreserveScroll,e.transitionResetVideoPosition,e.openUrlInNewTab,e.transitionResetScrollPosition,e.transitionResetInteractiveComponents),z=O&&!B&&("INSTANT"===G.behavior||"DISSOLVE"===G.behavior),Y=A&&"OVERLAY"===(0,tb.E7)(e.navigationType)&&K,W=A&&(B||"SWAP"===(0,tb.E7)(U)),H=!x&&(0,rR.oc)(e),$=(0,rR.GB)(e),X=(0,rR.uU)(c)?z||H:(0,rR.Fp)(c,e.connectionType,e.navigationType),{selectedInteractions:Q}=(0,rL.Ay)(rA.J.NORMAL),J=Q.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>rf.d({nodeID:e.sourceNodeID,interactionID:e.id})),q=o.useCallback(e=>{let t=oX.sH(e);t&&s({transitionNodeID:t}),E((0,oQ._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(J),destinationTlfId:e}}))},[E,s,J]),Z=o.useCallback(e=>{l(e),E((0,oQ._P)({name:"Variant based prototyping UI changed",params:{source:"panel"}})),E((0,oQ._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(J)}}))},[l,E,J]),ee=o.useCallback(e=>{s({connectionURL:e.target.value})},[s]),et=(0,rT.Od)(e),en=t4()({[sY.Ph]:!v,[sY.Ti]:u.isNestedInConditional&&!S&&!N}),ea=A&&!k,eo=o.createElement(c$,{className:sY.iR,dispatch:E,dropdownShown:y,onChange:q,nodeId:e.transitionNodeID||oX.Hr,scene:g,recordingKey:tD.Pt(t,"destinationDropdown"),action:et,isUI3:v}),er=o.createElement(dd,{action:et,showScrollToOptions:"SCROLL_TO"===et,extraScrollOffset:e.extraScrollOffset,updateSelectionProperties:s,recordingKey:tD.Pt(t,"scrollOptionsPanel")}),el=o.createElement(cv,{interactionType:n,updateSelectionProperties:s,recordingKey:tD.Pt(t,"overlaySettings"),actionIndexPath:u.actionIndexPath,nodeId:e.transitionNodeID||oX.Hr});return o.createElement("div",{className:en},ea&&(v?o.createElement(o.Fragment,null,o.createElement(oA.cS,{label:W?(0,_.tx)("proto.overlay"):(0,_.tx)("proto.destination"),input:eo}),er,Y&&el):eo),w&&o.createElement(ds,{action:e,recordingKey:t,onOpenInNewTabChange:e=>{s({openUrlInNewTab:e}),E((0,oQ._P)({name:"Open Url In New Tab Changed",params:{value:e}}))},onURLChange:ee}),x&&o.createElement(dl,{dropdownShown:y,scene:g,targetVideoNodeID:e.transitionNodeID||oX.Hr,recordingKey:tD.Pt(t,"targetVideoDropdown"),viableSameFrameVideoIds:M,disabledSameFrameVideoIds:L,isVideoSelected:D,onChange:q}),o.createElement(d_,{dropdownShown:y,action:e,onChange:a,updateSelectionProperties:s,recordingKey:t}),!v&&er,I&&o.createElement("div",{className:v?void 0:aG.cx.ml4.$},o.createElement(c4,{className:sY.PB,dispatch:E,onChange:q,nodeId:e.transitionNodeID||oX.Hr,targetVariable:e.targetVariable||{id:""},targetVariableData:e.targetVariableData,updateSelectionProperties:s,recordingKey:tD.Pt(t,"setVariableControls"),action:et,isNestedInConditional:u.isNestedInConditional,isNarrowPanel:u.isNestedInConditional||u.isNarrowPanel,autoOpenVariablePicker:d})),P&&o.createElement("div",{className:v?void 0:aG.cx.ml4.$},o.createElement(ci,{dispatch:E,targetVariableSetID:e.targetVariableSetID,targetVariableModeID:e.targetVariableModeID,deprecatedTargetVariableSetKey:e.targetVariableSetKey,updateSelectionProperties:s,recordingKey:tD.Pt(t,"setVariableControls"),actionIndexPath:u.actionIndexPath.join(",")})),C&&(N?o.createElement(cB,{recordingKey:tD.Pt(t,"conditionalActionSection","conditional-block",0),autoOpenExpressionBuilder:p,setAutoOpenExpressionBuilder:m,updateSelectionProperties:s,conditionalActions:(0,tb.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]}):o.createElement(cU,{updateSelectionProperties:s,recordingKey:tD.Pt(t,"conditionalActionSection"),action:e,updateMultipleDestinationNodes:l,interactionType:n,stateManagementVersion:c,selectedInteractions:u.selectedInteractions,actionIndexPath:u.actionIndexPath,onDrop:u.onDrop,onSelect:u.onSelect,onExpand:u.onExpand,onNewActionAdded:u.onNewActionAdded,selectedActionIndex:u.selectedActionIndex,expandedRows:u.expandedRows,autoOpenVariablePicker:d,handleMouseDownUI3:u.handleMouseDownUI3})),k&&o.createElement("div",{className:aG.cx.ml0.$},o.createElement(cX,{onChange:Z,nodeId:e.transitionNodeID||oX.Hr,recordingKey:tD.Pt(t,"consumption"),actionIndexPath:u.actionIndexPath})),F&&o.createElement(o.Fragment,null,v&&o.createElement("div",{className:sY.x}),o.createElement(cC.X7,{transition:G,interactionType:n,navigationType:e.navigationType,recordingKey:tD.Pt(t,"animationPanel"),updateSelectionProperties:s,isNarrowPanel:u.isNestedInConditional||u.isNarrowPanel,stateManagementVersion:c})),Y&&!v&&el,X&&o.createElement(o.Fragment,null,v&&o.createElement("div",{className:sY.x}),o.createElement(de,{connectionType:e.connectionType,transition:G,navigationType:e.navigationType,recordingKey:tD.Pt(t,"stateManagementPanel"),updateSelectionProperties:s,showPreserveScrollPosition:z,showResetVideoState:!!H,showResetInteractiveComponentState:!!$,stateManagementVersion:c,selectedInteractions:u.selectedInteractions})))}var dh=n(584999),dv=n(323110),df=n(482725);let dS=Symbol("ACTION_ROW");function db({updateMultipleDestinationNodes:e,updateSelectionProperties:t,onDeleteAction:n,stateManagementVersion:a,selectedInteractions:l,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,...d}){let p=(0,r.wA)(),{shouldShowAdvancedPrototypingPaywall:m,showAdvancedPrototypingVariablesModal:u,showAdvancedPrototypingConditionalActionsModal:E}=(0,rR.zt)(),g=(0,nT.Um)(),h=(0,rR.hP)(),{firstVariableSetMode:v,firstVariableSetID:f}=cl(),S=d.action,b=d.isNestedInConditional&&(0,cA.qQ)(d.action),T=!!S.connectionType&&"CONDITIONAL"===S.connectionType,N=(0,j.GS)(),I=(0,rR.YT)(),P=I===rR.Oz.SINGLE_COL,C=I===rR.Oz.TWO_COL,A=o.useContext(sB.c),k=C&&A===sB.P.RIGHT,w=C&&A===sB.P.LEFT,O=!((0,tb.gl)(d.action)||["CLOSE","NONE"].includes(S.connectionType))&&!N;var x=d.selectedActionIndex.equals(d.actionIndexPath);let D=1===d.selectedActionIndex.path.length&&d.isNestedInConditional&&d.actionIndexPath[0]===d.selectedActionIndex.path[0];var R=void 0===d.expandedRows||void 0!==d.expandedRows.find(e=>e.equals(d.actionIndexPath));N&&(R=!!P||!w||T);let M=o.useCallback(()=>{(O||P)&&d.onExpand(d.actionIndexPath)},[O,P,d]),[L,V]=o.useState(!1);o.useEffect(()=>{if(T){let e=setTimeout(()=>{V(!0)},0);return()=>clearTimeout(e)}V(!0)},[T]);let K=T&&!R,F=T&&R,U=o.useRef(null),[B,G]=(0,y.fp)(rR.hV),{position:z,dragItem:Y}=(0,sA.h4)(()=>({type:dS,element:U,item:d.action,dropPositionThreshold:F?.2:K?1/3:.5,getDeepestTargetOnly:!0,canDrag:!!w||!R,onDrop(e){d.onDrop(e),G(!0)}})),W=o.useMemo(()=>{let e=U.current;if(!e||!z||k)return;if(Y&&"CONDITIONAL"===Y.connectionType&&d.isNestedInConditional||(0,cA.qQ)(Y)){G(!1);return}let t=b?sA.Nz.BEFORE:z;var n=void 0;let a=e.offsetParent?.firstElementChild?.scrollTop??0;return t===sA.Nz.BEFORE?n=e.offsetTop-a:t===sA.Nz.AFTER&&(n=e.offsetTop+e.offsetHeight-a),G(!0),n},[z,k,Y,d.isNestedInConditional,b,G]),H=z&&T&&!R&&z===sA.Nz.INSIDE&&"CONDITIONAL"!==Y.connectionType,$=tD.rf(d.recordingKey,"mousedown",e=>{R||(x=!0,d.onSelect(d.actionIndexPath,!0))}),X=tD.rf(d.recordingKey,"mousedown",e=>{x=!1,d.onSelect(d.actionIndexPath,!1)}),Q=tD.rf(d.recordingKey,"click",e=>{d.onSelect(d.actionIndexPath,!0)}),J=tD.rf(d.recordingKey,"mousedown",e=>{(0,cA.qQ)(d.action)||d.onSelect(d.actionIndexPath,!0)}),q=e=>{var n=!0,a=!1;switch(e){case"NONE":t({connectionType:"NONE"});break;case"NAVIGATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"NAVIGATE"});break;case"OPEN_OVERLAY":t({connectionType:"INTERNAL_NODE",navigationType:"OVERLAY"});break;case"SCROLL_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SCROLL_TO"});break;case"SWAP_WITH":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP"});break;case"SWAP_STATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP_STATE"});break;case"GO_BACK":t({connectionType:"BACK"});break;case"CLOSE_OVERLAY":t({connectionType:"CLOSE"});break;case"OPEN_URL":t({connectionType:"URL"});break;case"SET_VARIABLE":m?(n=!1,u()):(t({connectionType:"SET_VARIABLE"}),i.current=!0);break;case"SET_VARIABLE_MODE":m?(n=!1,u()):t({connectionType:"SET_VARIABLE_MODE",targetVariableSetID:f,targetVariableModeID:v});break;case"UPDATE_MEDIA_PLAY":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PLAY"});break;case"UPDATE_MEDIA_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PAUSE"});break;case"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_PLAY_PAUSE"});break;case"UPDATE_MEDIA_MUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"MUTE"});break;case"UPDATE_MEDIA_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"UNMUTE"});break;case"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_MUTE_UNMUTE"});break;case"UPDATE_MEDIA_SKIP_BY_OPTIONS":case"UPDATE_MEDIA_SKIP_FORWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_FORWARD"});break;case"UPDATE_MEDIA_SKIP_BACKWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_BACKWARD"});break;case"UPDATE_MEDIA_SKIP_TO":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_TO"});break;case"CONDITIONAL":a=!0,m?(n=!1,E()):(t({connectionType:"CONDITIONAL"}),N&&c&&c(!0))}if(N||R||M(),C&&d.onExpand(d.actionIndexPath,a),n){let t=l.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>rf.d({nodeID:e.sourceNodeID,interactionID:e.id}));p((0,oQ._P)({name:"Prototype action changed",params:{action:e,source:"panel",connectorIds:JSON.stringify(t)}}))}},Z=d.isNestedInConditional?sY.It:sY.ft,ee=t4()({[sY.wu]:!w,[sY.zX]:w&&B}),et=o.createElement(t1.U,{svg:dv.A},o.createElement(sx,{className:sY._2}));if(b&&d.onAddAction)return o.createElement("div",{className:w?sY.LW:void 0},W&&o.createElement("hr",{className:Z,style:{transform:`translateY(${W}px)`}}),w&&d.isNestedInConditional&&et,o.createElement("div",{className:ee,ref:U},o.createElement(cx,{addButtonPressed:d.onAddAction,recordingKey:tD.Pt(d.recordingKey,"addAction"),isNestedInConditional:!0})));let en=(0,rT._X)(S),ea="NONE"!==en,eo=(R||!ea)&&!w,er=d.numActions>1,el=(d.numActions>1||d.isNestedInConditional)&&!w,ei=t4()({[sY.$l]:!0,[sY.KY]:w&&!d.isNestedInConditional,[sY.Iw]:w&&!d.isNestedInConditional&&B,[sY.DM]:w&&d.isNestedInConditional,[sY.vs]:w&&d.isNestedInConditional&&B,[sY.M9]:w&&d.isNestedInConditional&&D&&B,[sY.I_]:w&&T&&!x&&B,[sY.Cu]:x&&!N,[sY.PE]:x&&w&&!d.isNestedInConditional,[sY.Ze]:H,[sY.Op]:d.isNestedInConditional&&!N}),es=t4()({[sY.rn]:!0,[sY.Gu]:w,[sY.Ti]:d.isNestedInConditional&&!N&&!k,[sY.Yo]:d.isNestedInConditional&&N&&!k}),ec=o.createElement(rb.B,{key:"expand-caret",className:sY.GE,svg:R?nr.A:nl.A,recordingKey:tD.Pt(d.recordingKey,"expandCaret"),onClick:M}),ed=o.createElement(sQ,{action:S,isNestedInConditional:d.isNestedInConditional,isNarrowPanel:d.isNarrowPanel&&er,onClick:N?Q:void 0}),ep=o.createElement(sV,{className:"NONE"===en||N?void 0:dh.fH,dispatch:p,dropdownShown:g,onChange:q,action:en,recordingKey:tD.Pt(d.recordingKey,"actionDropdown"),showVideoActions:h,isNestedInConditional:d.isNestedInConditional}),em=o.createElement(tJ.K0,{className:N?sY.gG:sY.hH,onClick:n,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("proto.prototype_panel.delete"),"aria-label":(0,_.t)("proto.prototype_panel.delete"),recordingKey:tD.Pt(d.recordingKey,"actionDeleteButton")},o.createElement(t1.U,{svg:df.A},o.createElement(rg.O,null))),eu=o.createElement(tJ.fI,{className:es,onDoubleClick:M},O&&ec,eo?o.createElement("span",{className:sY.P2},ep):ed,el&&em),eE=eo?ep:ed,ey=o.createElement(nv.D8,{className:es,onDoubleClick:M},O&&ec,el?o.createElement(aJ.DE,{appendedClassName:sY.Jw,label:null,input:eE,icon:em}):o.createElement(aJ.Ad,{appendedClassName:sY.Jw,label:null,input:eE})),e_=(0,_.tx)("proto.action"),eg=o.createElement(nv.D8,{className:es},P||k?o.createElement(oA.cS,{label:e_,input:eE}):eE),eh=N?eg:ey,ev=t4()({[sY.Oe]:!0,[sY.h2]:x,[sY.Ob]:T});return o.createElement("div",{className:ei,ref:U,role:"button",tabIndex:0,onMouseDown:N?void 0:$,onMouseUp:N?void 0:X},void 0!==W&&o.createElement("hr",{className:Z,style:{transform:`translateY(${W}px)`}}),w?o.createElement("div",{className:ev,role:"button",tabIndex:0,onMouseDown:N?J:void 0},d.isNestedInConditional&&et,eh):N?eh:eu,R&&L&&o.createElement(dg,{updateMultipleDestinationNodes:e,action:S,onActionChange:q,recordingKey:d.recordingKey,updateSelectionProperties:t,interactionType:d.interactionType,stateManagementVersion:a,selectedInteractions:l,isNestedInConditional:d.isNestedInConditional,isNarrowPanel:d.isNarrowPanel,actionIndexPath:d.actionIndexPath,onDrop:d.onDrop,onSelect:d.onSelect,onExpand:d.onExpand,onNewActionAdded:d.onNewActionAdded,selectedActionIndex:d.selectedActionIndex,expandedRows:d.expandedRows,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,handleMouseDownUI3:J}))}var dT=n(427113),dN=n(682331);function dI({onChange:e,value:t,shouldFocusKeyCaptureField:n,setShouldFocusKeyCaptureField:a}){let r;let l=(0,rM._i)(t?.keyCodes),i=t=>e({keyCodes:t,triggerDevice:"KEYBOARD"}),[s,c]=o.useState(!1),d=o.useRef(null);o.useEffect(()=>{(!t||!t.keyCodes||0===t.keyCodes.length)&&n&&d.current&&(a(!1),d.current.focus(),c(!0))},[a,n,t]),o.useEffect(()=>{if(!s)return()=>{};let t=new dN.L,n=t.onPress(t=>{e({keyCodes:[t.buttons[0]],triggerDevice:t.controllerType}),requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})});return t.start(),()=>{n.release(),t.end()}},[e,s]);let p=null,m=(0,rM.E8)(t),u=(0,j.GS)();return s?r=o.createElement(dP,null,u?(0,_.tx)("proto.keyCapture.press_key_lowercase"):(0,_.tx)("proto.keyCapture.press_key")):t?.triggerDevice==="KEYBOARD"&&l?p=(0,rM.U8)(l):m?p=m:r=o.createElement(dP,null,u?(0,_.tx)("proto.keyCapture.click_to_set_key"):(0,_.tx)("proto.keyCapture.click_to_select")),o.createElement(tJ.rp,{ref:d,className:"prototype_key_capture_field--root--bD21s","data-tooltip-type":t2.Ib.TEXT,"data-tooltip":p&&p.length>10?p:null,onFocus:()=>c(!0),onBlur:()=>c(!1),onKeyDown:e=>{e.preventDefault(),e.stopPropagation();let t=e.which||e.keyCode;!rM.RI.has(t)&&rM.pu[t]&&(t===l?.keyCode&&e.repeat?i((0,rM.wb)({keyCode:t,metaKey:e.metaKey||l.metaKey,shiftKey:e.shiftKey||l.shiftKey,ctrlKey:e.ctrlKey||l.ctrlKey,altKey:e.altKey||l.altKey})):i((0,rM.wb)({...e,keyCode:t})),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},recordingKey:"keycapture"},p??r)}function dP({children:e}){return o.createElement("span",{className:"prototype_key_capture_field--placeholder--gWUKF"},e)}class dC extends oC.l6{}class dA extends oC.c${}let dk=new rT.VG,dw=new rT.EX,dO=new rT.JV,dx=new rT.Eq;function dD(e){let t=(0,r.wA)(),n=(0,nT.Um)(),a=(0,j.GS)(),l=(0,lO.cJ)(),{showVideoV2Triggers:s}=(0,lN.R)(e=>({allStatesInSelection:e.mirror.selectionProperties.stateGroupSelectionInfo?.mode===i.iCO.STATE,allTopLevelFramesInSelection:!!e.mirror.selectionProperties.allTopLevelFramesInSelection,showVideoV2Triggers:(0,rN.dq)(e.mirror.selectionProperties)})),c=(0,y.md)(rI.NE),d=(t,n)=>{let r=o.createElement("div",{className:"transition_interaction_dropdown--prototypeInteractionIcon---njby"},(0,rN.e7)(t));return o.createElement(dA,{key:n,value:t,icon:a?r:void 0,recordingKey:tD.Pt(e,t),disabled:!function(t){if("NONE"===t)return!0;let n=!!e.interactionsOnSelectedNodes&&e.interactionsOnSelectedNodes.every(t=>e.interactionsOnSelectedNodes&&oX.aI(t.sourceNodeID,e.interactionsOnSelectedNodes[0].sourceNodeID))&&!(0,tb.hS)(e.property),a=(function(){if(e.interactionsOnSelectedNodes)return new Set(e.interactionsOnSelectedNodes.map(e=>e?.event?.interactionType).filter(e=>void 0!==e))})()?.has(t)&&(0,tb.hS)(e.property)&&e.property!==t;return(!n&&!a||!!["ON_KEY_DOWN","DRAG","ON_VOICE","ON_MEDIA_HIT"].includes(t))&&("AFTER_TIMEOUT"===t?!e.interactionContainsOpenLinkAction:"ON_MEDIA_HIT"===t||"ON_MEDIA_END"===t?s:(!e.interactionContainsOpenLinkAction||"ON_CLICK"===t||"MOUSE_UP"===t)&&(!e.interactionContainsUpdateMediaRuntime||"ON_HOVER"!==t&&"ON_PRESS"!==t&&"DRAG"!==t)&&(!e.interactionOnlyContainsBack||"ON_HOVER"!==t&&"ON_PRESS"!==t))}(t)})},p=(l?[]:["NONE"]).map(d),m=["ON_CLICK",...l?[]:["DRAG"],"ON_HOVER","ON_PRESS","ON_KEY_DOWN"].map(d),u=["MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].map(d),E=(l?[]:["ON_MEDIA_HIT","ON_MEDIA_END"]).map(d),_=["AFTER_TIMEOUT"].map(d),g=c?"ON_MEDIA_HIT"!==e.property?dw:dx:"ON_MEDIA_HIT"!==e.property?dk:dO,h=o.useCallback(e=>e-24,[]),v=(0,tb.E7)(e.property);return o.createElement(dC,{id:"interaction-type-select",className:e.className,chevronClassName:"transition_interaction_dropdown--chevron--pyzhq",dataTestId:"interaction-select",property:e.property,formatter:g,icon:a&&v?(0,rN.e7)(v):void 0,onChange:e.onChange,dispatch:t,dropdownShown:n,recordingKey:tD.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,e9.nl)(),dropdownAlignment:h,dropdownWidth:160},p,!l&&o.createElement(oC.sK,null),m,o.createElement(oC.sK,null),u,!l&&o.createElement(oC.sK,null),_,!l&&s&&[o.createElement(oC.sK,{key:""}),...E])}let dR={keyCodes:[],triggerDevice:"KEYBOARD"};function dM(e,t,n,a){return n?o.createElement(oA.cS,{label:e,input:t,appendedClassName:a?void 0:sY.dU}):o.createElement(tJ.fI,null,t)}function dL(e){let{detailPropsMultipleActions:t,interactionsOnSelectedNodesAndComponents:n,updateSelectionProperties:a}=(0,rL.Ay)(e.category),{interactionType:l="NONE",transitionTimeout:i=.8,mediaHitTime:s=0,interactionMaintained:c=!1,interactionDuration:d=.3,keyTrigger:p=dR}=t.interactionEvent,m=(e,t)=>{if(e.connectionType===t)return e;if("CONDITIONAL"===e.connectionType)for(let n of(0,tb.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]){let e=n.actions?n.actions.find(e=>e.connectionType===t):void 0;if(void 0!==e)return e}return null},u=void 0!==t.interactionActions.find(e=>m(e,"URL")),E=void 0!==t.interactionActions.find(e=>m(e,"UPDATE_MEDIA_RUNTIME")),y=1===t.interactionActions.length&&"BACK"===t.interactionActions[0].connectionType,g=void 0!==t.interactionActions.find(e=>m(e,"CONDITIONAL"));return function(e){let t=(0,r.wA)(),n=e.updateSelectionProperties,a=(0,to.RU)(),[l,i]=o.useState(!1),s=(0,j.GS)(),c=(0,rR.YT)(),d=c===rR.Oz.SINGLE_COL,p=c===rR.Oz.TWO_COL,m=!0===(0,tb.E7)(e.maintained),u=(0,tb.E7)(e.keyTrigger),E="ON_KEY_DOWN"===(0,tb.E7)(e.interactionType),y="AFTER_TIMEOUT"===(0,tb.E7)(e.interactionType),g="ON_MEDIA_HIT"===(0,tb.E7)(e.interactionType),h=["MOUSE_IN","MOUSE_OUT","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].indexOf((0,tb.E7)(e.interactionType)||"")>-1,v=o.createElement(dD,{className:sY.sQ,property:e.interactionType,onChange:a=>{sC.sn.start("interaction_details_changed"),n({interactionType:a}),t((0,oQ._P)({name:"Prototype Interaction Type Changed",params:{newType:a,oldType:(0,tb._W)(e.interactionType,"MIXED")}})),"ON_KEY_DOWN"===a&&i(!0)},interactionContainsOpenLinkAction:e.interactionContainsOpenLinkAction,interactionContainsUpdateMediaRuntime:e.interactionContainsUpdateMediaRuntime,interactionOnlyContainsBack:e.interactionOnlyContainsBack,recordingKey:tD.Pt(e,"interactionDropdown"),interactionsOnSelectedNodes:e.interactionsOnSelectedNodes}),f=s?d?o.createElement(oA.cS,{label:(0,_.tx)("proto.trigger"),input:v}):o.createElement("div",{className:sY.BX},v):o.createElement(tJ.fI,{className:t4()(sY.SG,sY.QT)},v,o.createElement("div",{className:sY.LY},e.headerButtons)),S=o.createElement(o.Fragment,null,y&&dM((0,_.tx)("proto.delay"),o.createElement(aW.W4,{className:s?sY.Lp:sY.Zp,inputClassName:s?sY.Gl:void 0,dataTestId:"timeout-input",dispatch:t,value:e.timeout,onValueChange:e=>{n({transitionTimeout:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:20,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:tD.Pt(e,"timeoutInput")},s?o.createElement(dT.A,null):void 0),s,d),E&&dM((0,_.tx)("proto.key"),o.createElement(dI,{onChange:e=>{n({keyTrigger:e})},value:u,shouldFocusKeyCaptureField:l,setShouldFocusKeyCaptureField:i}),s,d),g&&dM((0,_.tx)("proto.time"),o.createElement(aW.qd,{displayFractions:!0,className:sY.Ym,inputClassName:sY.vE,dataTestId:"mediaHitTime-input",dispatch:t,value:e.mediaHitTime,onValueChange:e=>{n({mediaHitTime:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:3600,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("proto.trigger.video_hit_time"),tooltipForScreenReadersOnly:!0,recordingKey:tD.Pt(e,"mediaHitTimeInput")},s?o.createElement(dp,null):void 0),s,d),h&&dM((0,_.tx)("proto.delay"),o.createElement(aW.W4,{className:s?sY.Lp:sY.aq,inputClassName:s?sY.Gl:sY.p0,dataTestId:"duration-input",dispatch:t,value:m?e.interactionDuration:void 0,onValueChange:e=>{n(e&&e>0?{interactionMaintained:!0,interactionDuration:e}:{interactionMaintained:!1})},min:0,allowEmpty:!0,placeholder:(0,_.t)("proto.trigger.add_delay_placeholder"),wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,"data-tooltip-type":t2.Ib.TEXT,"data-tooltip":(0,_.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:tD.Pt(e,"delayInput")},s?o.createElement(dT.A,null):void 0),s,d));return s?o.createElement("div",{className:p?sY.eU:void 0},f,S):o.createElement("div",{className:sY.cF},f,S)}({...e,updateSelectionProperties:a,interactionType:l,interactionContainsOpenLinkAction:u,interactionContainsUpdateMediaRuntime:E,interactionOnlyContainsBack:y,interactionContainsConditionalAction:g,timeout:i,maintained:c,interactionDuration:d,mediaHitTime:s,keyTrigger:p,interactionsOnSelectedNodes:n,recordingKey:tD.Pt(e.recordingKey,rR.Qe)})}let dV="prototype_interaction_edit_modal--contentContainer--bo2b4",dK="prototype_interaction_edit_modal--ui3TwoColContentContainer--x9vrG",dF="prototype_interaction_edit_modal--ui3SingleColContentContainer--uF-ir",dU="prototype_interaction_edit_modal--dividerHorizontal--3wvnB",dB="prototype_interaction_edit_modal--ui3InteractionsPanelContentRight--bVfG8";function dG(e){let{selectedInteractions:t,makeUpdateSelectionPropertiesForActionIndex:n,makeUpdateMultipleDestinationNodesForActionIndex:a,differentLengthActions:r,mergedActions:l}=(0,rL.Ay)(e.category),i="NONE"!==(0,tb.E7)(e.interactionType),s=void 0!==l.find(e=>"CONDITIONAL"===e.connectionType),{selectedActionIndex:c,onSelect:d}=e,p=(0,j.GS)(),m=(0,rR.YT)(),u=m===rR.Oz.SINGLE_COL,E=m===rR.Oz.TWO_COL,{expandedRows:y,setExpandedRows:g,deleteButtonPressed:h,newActionIndexPath:v,resetNewActionIndexPath:f}=e;o.useEffect(()=>{v&&!v?.equals([])&&(p?d(v.path,!0):(g([...y,v]),d([],!1)),f())},[y,g,v,f,d,p]);let S=o.useCallback(e=>{y.find(t=>t.equals(e))?g(y.filter(t=>!t.equals(e))):g([...y,new cA.Op(e)])},[y,g]),b=o.useCallback(n=>{var a=n.dropItem;if((0,tb.gl)(a)||(0,cA.qQ)(n.dragItem))return;let o=e.interactionsOnSelectedNodes;if(!o||!t)return;for(var r=0;r<t?.length;r++){let e=t[r];if(e&&e.actions){let o=e.actions,l=(0,cA.Vp)(o,c,y,a,n.position);if(l.newSelectedActionIndex&&E&&d(l.newSelectedActionIndex.path,!0),l.newActions&&(t[r].actions=l.newActions,p||d([],!1)),l.newExpandedRows){if(E){let e=[];l.newActions?.forEach((t,n)=>{"CONDITIONAL"===t.connectionType&&e.push(new cA.Op([n]))}),g(e)}else g(l.newExpandedRows)}}}let l=o.map(e=>t.find(t=>t.id===e.id)??e);tG.Y5.updateSelectionProperties({prototypeInteractions:l})},[y,g,e.interactionsOnSelectedNodes,c,t,d,p,E]),T=t4()({"prototype_interaction_edit_modal--panelUI3--WK3CN":p,"prototype_interaction_edit_modal--panelUI3TwoColumn--V5gi4":E});return o.createElement(sA.hh,null,o.createElement(tJ.Zk,{className:T},e.shouldHideTitle?null:o.createElement(tJ.fI,null,o.createElement(tJ.U8,{title:(0,_.t)("proto.interaction.interaction"),dataTooltipContentKey:sO,dataTooltipTimeoutDelay:50})),o.createElement("div",null,(i||p)&&o.createElement(o.Fragment,null,u&&o.createElement(o.Fragment,null,o.createElement(dL,{category:e.category,recordingKey:rR.dJ,headerButtons:o.createElement(o.Fragment,null)}),o.createElement("div",{className:"prototype_interaction_edit_modal--dividerHorizontalUI3--HMCeE"})),r&&o.createElement(sk.Y,{direction:"horizontal",padding:{horizontal:16,vertical:12}},o.createElement(tJ.UZ,null,(0,_.tx)("fullscreen.properties_panel.click_plus_to_replace_mixed_content"))),!r&&o.createElement(o.Fragment,null,l?.map((r,i)=>o.createElement(db,{key:i,updateMultipleDestinationNodes:a(i),action:r,recordingKey:tD.Pt(e.recordingKey,rR.eG,i),updateSelectionProperties:n(i),onDeleteAction:()=>h(i),interactionType:e.interactionType,actionIndexPath:[i],numActions:l.length,isNestedInConditional:!1,isNarrowPanel:!s,stateManagementVersion:e.stateManagementVersion,selectedInteractions:t,onDrop:b,onSelect:e.onSelect,onExpand:S,selectedActionIndex:c,autoOpenVariablePicker:e.autoOpenVariablePicker,expandedRows:y,onNewActionAdded:e.onNewActionAdded,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder})))))))}function dz({transition:e,recordingKey:t,updateSelectionProperties:n,stateManagementVersion:a,selectedInteractions:l}){let i=(0,r.wA)(),s=(0,j.GS)(),c=(0,rR.YT)()===rR.Oz.SINGLE_COL,p=()=>{for(let t of(eE.az.trackDefinedEvent("prototype.state_management_noodle_upgraded",{num_interactions:l.length,preserve_scroll_position_value:!!e.preserveScroll}),l))(0,rR.uU)(t.stateManagementVersion)&&t.id&&t.sourceNodeID&&c5.zZ.recordInteractionUpgraded(t.id,t.sourceNodeID);n({...(0,tb.hS)(e.preserveScroll)&&(0,tb.hS)(a)?{transitionResetScrollPosition:!e.preserveScroll}:{},stateManagementVersion:1}),i(d.F.enqueue({type:"state-management-updated",message:(0,_.t)("proto.state_management.visual_bell_updated_message"),button:{text:(0,_.t)("proto.state_management.visual_bell_update_all"),action:()=>{tG.Y5.triggerActionInUserEditScope("update-interactions-state-management-on-page"),i(d.F.enqueue({type:"state-management-updated-all",message:(0,_.t)("proto.state_management.visual_bell_update_all_message")}))}}}))},m=()=>{eE.az.trackDefinedEvent("prototype.state_management_noodle_reverted",{num_interactions:l.length}),n({stateManagementVersion:0})},E=1===a?o.createElement(u.$n,{variant:"link",recordingKey:tD.Pt(t,"revert-state-management-version"),onClick:m,htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,_.tx)("proto.state_management.revert_controls")):o.createElement(u.$n,{variant:"secondary",recordingKey:tD.Pt(t,"update-state-management-version"),onClick:p},(0,_.tx)("proto.state_management.update_controls")),y=c?u.IK:u.$n,g=1===a?o.createElement(y,{variant:"secondary",onClick:m,recordingKey:tD.Pt(t,"revert-state-management-version"),htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,_.tx)("proto.state_management.revert_controls")):o.createElement(y,{variant:"primary",onClick:p,recordingKey:tD.Pt(t,"update-state-management-version")},(0,_.tx)("proto.state_management.update_controls")),h=1===a?(0,_.tx)("proto.state_management.new_controls"):(0,_.tx)("proto.state_management.old_controls"),v=o.createElement("a",{target:"_blank",rel:"noopener",href:"https://help.figma.com/hc/articles/14397859494295",className:s?void 0:"prototype_state_management_version_panel--link--i5iDD blue_link--blueLink--9rlnd"},s?(0,_.tx)("proto.state_management.controls_help_link_new"):(0,_.tx)("proto.state_management.controls_help_link")),f=o.createElement("div",{className:"prototype_state_management_version_panel--versionControls--siAOf"},o.createElement(tJ.JU,{className:"prototype_state_management_version_panel--label--vvYMX"},h,v),o.createElement("div",{className:"prototype_state_management_version_panel--buttonContainer--rJZ-y"},E)),S=o.createElement("div",{className:"prototype_state_management_version_panel--containerUI3--V5tpG"},o.createElement(of.J,null,h),v,g),b=o.createElement("div",{className:"prototype_state_management_version_panel--containerUI3TwoCol--AAp8u"},o.createElement("span",{className:"prototype_state_management_version_panel--labelWrapperUI3--37g5A"},o.createElement(of.J,null,h)),o.createElement("span",{className:"prototype_state_management_version_panel--helpLinkWrapperUI3--BttuC"},v),g);return o.createElement(tL.k,{name:"prototype_state_management_version_panel"},o.createElement(tJ.Zk,{className:s?"prototype_state_management_version_panel--panelUI3--8-Db5":void 0},s?c?S:b:f))}let dY="created_noodle";function dW(e){let{shouldHideTitle:t=!1,category:n,newActionIndexPath:a}=e,r=(0,rR.YT)()===rR.Oz.TWO_COL,{detailProps:l,detailPropsMultipleActions:i,interactionsOnSelectedNodesAndComponents:s,updateSelectionProperties:c,selectedInteractions:d}=(0,rL.Ay)(e.category);(0,iO.h)(()=>{if(void 0!==sC.sn.get(dY)){let e=sC.sn.stop(dY);(0,eE.sx)(dY,{elapsedMs:e,numConnectors:d.length},{forwardToDatadog:!0})}});let{showPanel:p,transition:m}=(0,rR.n6)(l,i,d),{interactionType:u="NONE",interactionMaintained:E=!1,interactionDuration:y=.3,keyTrigger:_=dR,transitionTimeout:g=.8,mediaHitTime:h=0}=i.interactionEvent,v=(0,rR.iC)(d),f=o.createElement(dG,{interactionType:u,timeout:g,mediaHitTime:h,maintained:E,interactionDuration:y,keyTrigger:_,recordingKey:tD.Pt(e,rR.Qe),shouldHideTitle:t,interactionsOnSelectedNodes:s,category:n,stateManagementVersion:v,autoOpenVariablePicker:e.autoOpenVariablePicker,newActionIndexPath:a,resetNewActionIndexPath:e.resetNewActionIndexPath,onNewActionAdded:e.onNewActionAdded,onSelect:e.onSelect,selectedActionIndex:e.selectedActionIndex,expandedRows:e.expandedRows,setExpandedRows:e.setExpandedRows,deleteButtonPressed:e.deleteButtonPressed,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder});return o.createElement("div",null,f,!r&&p&&o.createElement(dz,{transition:m,recordingKey:tD.Pt(e,"stateManagementVersionPanel"),updateSelectionProperties:c,stateManagementVersion:v,selectedInteractions:d}))}var dH=n(360803),d$=n(102165);function dX(e,t,n){let[a,o,r]=e.path,l=t[a].conditionalActions;if((0,tb.hS)(l)){let e=l?.[o].actions?.length??0;if(r>=e){if(0===e){n([a],!0);return}n([a,o,r-1],!0);return}}}function dQ(e,t,n){let a=e.path[0]>=t.length,o=0===e.path.length;if(a){n([t.length-1],!0);return}if(o){n([0],!0);return}}var dJ=n(277687);let dq=()=>{i.glU.setSelectedInteractions([]),(0,s.kc)().prototype_ai_magic_link_show_suggestion_toast&&tG.Y5.showMagicLinkSuggestedVisualBell("create_node_transition"),tG.Y5.deselectProperty()},dj=(0,np.jz)("197px"),dZ=(0,np.c8)("50%");function d0(e){var t;return e&&a?.height<369?a=t={...a,height:369}:a??={width:440,height:e?369:320,leftWidthPct:45}}let d1=o.memo(function(){let e=(0,r.d4)(d3),t=(0,rL.HS)(),{selectedInteractions:n}=(0,rL.Ay)(t),a=n.length>0,[l,i]=o.useState(!1),s=tD.v_(rR.dJ,"keydown",t=>"Shift"!==t.key?tD.aH:(i(!0),e&&a)?void 0:tD.aH),c=tD.v_(rR.dJ,"keyup",t=>"Shift"!==t.key?tD.aH:(i(!1),e&&a)?void 0:tD.aH);if(o.useEffect(()=>(document.addEventListener("keydown",s),document.addEventListener("keyup",c),()=>{document.removeEventListener("keydown",s),document.removeEventListener("keyup",c)}),[s,c]),!e||!a)return null;let d=n.some(e=>e.actions?.some(e=>"CONDITIONAL"===e.connectionType));return o.createElement(d2,{category:t,containsConditional:d,pressingShiftKey:l,initialX:e.initialX,initialY:e.initialY,shouldPin:e.shouldPin,setPressingShiftKey:i})}),d2=o.memo(function({category:e,containsConditional:t,pressingShiftKey:n,initialX:l,initialY:s,shouldPin:c,setPressingShiftKey:d}){let p=(0,r.wA)(),[m,u]=o.useState(!1),[,E]=(0,y.fp)(d$.x),g=(0,o.useRef)(null),[h,v]=o.useState(!1),f=c||m,S=(0,j.GS)(),b=(0,rR.YT)(),T=b===rR.Oz.SINGLE_COL,N=b===rR.Oz.TWO_COL,[I,P]=o.useState(new cA.Op(S?[0]:[])),{selectedInteractions:A,differentLengthActions:k,interactionsOnSelectedNodesAndComponents:w,mergedActions:O,detailProps:x,detailPropsMultipleActions:D,updateSelectionProperties:R}=(0,rL.Ay)(e);var M=I.path.length>0?I:new cA.Op([0]);let L=M.isConditional(),V=(e,t)=>M=new cA.Op(e);S&&M.path[0]>=O.length&&!L?dQ(I,O,V):S&&L&&dX(I,O,V);let K=o.useCallback((e,t)=>{t?P(new cA.Op(e)):P(new cA.Op([]))},[]);o.useEffect(()=>{if((0,sT.vA)(O.length>0,"the interactions panel should always have actions if rendered"),!S)return;let e=I.isConditional();if(e){if(e){dX(I,O,K);return}}else{dQ(I,O,K);return}},[O,I,S,K]);let{shouldShowAdvancedPrototypingPaywall:F,showAdvancedPrototypinglMultipleActionsModal:U}=(0,rR.zt)(),{showPanel:B,transition:G}=(0,rR.n6)(x,D,A),z=(0,rR.iC)(A);var Y=[];N?O.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&Y.push(new cA.Op([t]))}):O.length<4&&O.forEach((e,t)=>{Y.push(new cA.Op([t]))});let[W,H]=o.useState(Y),$=o.useRef(null),X=n&&!f&&!h,Q=(0,np.jz)(rq.prototypeInteractionModalWidth),J=(0,np.jz)(rq.prototypeInteractionModalExpandedWidth),q=d0(B).width,Z=t?J:Q;N&&(Z=q);let[et,en]=o.useState(c),ea=(0,sI._X)({subscribeToUpdates_expensive:!c}),eo=o.useCallback(()=>{m||(p((0,oQ._P)({name:"prototype_interaction_details_modal_dragged"})),u(!0))},[p,m,u]),er=o.useMemo(()=>{let e=new ob.Mi(l,s);if(c)return N?new ob.Mi(e.x-(q-Q),e.y):t?new ob.Mi(e.x-(J-Q),e.y):e;{let t=(0,sI.$g)(ea,e);return new ob.Mi(t.x-Z/2,t.y+30)}},[Z,l,s,t,c,ea,N,J,Q,q]);o.useEffect(()=>{if(!n)return;let e=e=>{!e.shiftKey&&n&&d(!1)};return document.addEventListener("mousemove",e),()=>{document.removeEventListener("mousemove",e)}},[n,d]),o.useEffect(()=>{E(X)},[E,X]),o.useEffect(()=>{en(c)},[c]),o.useEffect(()=>()=>{p((0,oQ._P)({name:"prototype_interaction_details_modal_closed"}))},[p]);let el=o.useRef(null),[ei,es]=o.useState(!1);o.useEffect(()=>{ei&&(es(!1),el.current?.scrollToBottom())},[ei,es,el]);let[ec,ed]=o.useState(new cA.Op([])),ep=(0,ee.q5)(),em=o.useCallback((e,t)=>{let n=e.event.clipboardData||window.clipboardData;switch(t){case tH.zy.COPY:case tH.zy.CUT:{let a=JSON.parse(JSON.stringify(A)),o=(0,dH.l)(a),r=io.fG(ep?.key||null,{prototypeInteractions:o});if(io.C4(n,r,""),t===tH.zy.CUT){let e=[];for(let t of A){let{sourceNodeID:n,id:a}=t;n&&a&&e.push(rf.d({nodeID:n,interactionID:a}))}tk.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(e)),tG.Y5.deselectProperty()}e.accept()}}},[ep?.key,A]),eu=o.useRef(!1),[eE,ey]=o.useState(!1),{firstVariableSetMode:e_,firstVariableSetID:eg}=cl(),eh=(0,C.p8)("currentPage"),ev=o.useCallback((e,t,n,a)=>{p((0,oQ._P)({name:"Prototype delete action",params:{action:e,source:"panel",connector_id:t,page_id:n,actionInConditionalAction:a}}))},[p]),ef=o.useCallback(e=>{if(w&&A){var t=!1,n=!1;if(F)U();else{for(let r=0;r<A?.length;r++){let l=A[r],i=[];if(l&&l.actions){var a=0,o=[];for(let r=0;r<l.actions.length;r++){let s=l.actions[r];if(r!==e)void 0!==W.find(e=>e.equals([r]))&&o.push(new cA.Op([a])),i.push(s),a++;else{let e=l.id?l.id:oX.Hr;ev(s.connectionType?s.connectionType:"NONE",(0,oX.dI)(e),eh),r===l.actions.length-1&&(t=!0),2===l.actions.length&&(n=!0)}H(o)}A[r].actions=i}}let r=w.map(e=>A.find(t=>t.id===e.id)??e);tG.Y5.updateSelectionProperties({prototypeInteractions:r}),n&&S&&H([new cA.Op([0])]),t&&N&&P(new cA.Op([e-1]))}}},[w,A,F,U,W,eh,ev,N,S]),eS=o.useCallback(e=>{if(!w||!A||!e.path.length||void 0===e.path[0])return;let[t,n,a]=e.path,o=e.isConditional();if(F)U();else if(o){let e=!1,o=!1,r=A.map(r=>{let l=r.actions;if(!l)return r;let i=l.map((l,i)=>{if(i!==t||"CONDITIONAL"!==l.connectionType)return l;let s=l.conditionalActions;if(!s)return l;let c=s.map((t,l)=>{if(l!==n)return t;let i=t.actions;if(!i)return t;let s=i[a];s&&ev(s.connectionType?s.connectionType:"NONE",(0,oX.dI)(r.id??oX.Hr),eh,!0);let c=i.filter((e,t)=>t!==a);return e=a===i.length-1,o=0===c.length,{...t,actions:c}});return{...l,conditionalActions:c}});return{...r,actions:i}}),l=w.map(e=>r.find(t=>t.id===e.id)??e);tG.Y5.updateSelectionProperties({prototypeInteractions:l}),o?P(new cA.Op([t])):!o&&e&&P(new cA.Op([t,n,a-1]))}else ef(t);document.activeElement?.blur()},[w,A,F,U,ef,eh,ev]),eb=o.createElement(sN.P,{className:N?"prototype_interaction_edit_modal--ui3TwoColScrollContainer--IWuQ4":dV,useBottomPinning:!N,ref:el,allowScrollAndZoomOver:!0,"data-not-draggable":!0},o.createElement(dW,{shouldHideTitle:!0,recordingKey:N?tD.Pt("leftCol",rR.dJ):rR.dJ,category:e,autoOpenVariablePicker:eu,newActionIndexPath:ec,resetNewActionIndexPath:()=>{ed(new cA.Op([]))},onNewActionAdded:e=>{ed(e)},selectedActionIndex:I,onSelect:K,expandedRows:W,setExpandedRows:H,deleteButtonPressed:ef,autoOpenExpressionBuilder:eE,setAutoOpenExpressionBuilder:ey})),eT=1===A.length,eN=A[0],eI=eN.actions&&eN.actions.length<2,eP=eN.actions&&1===eN.actions.length&&eN.actions[0],eC=!eP||"NONE"===eP.connectionType,eA=eT&&eI&&eC;var ek=oX.Hr;let ew=o.createElement(cx,{skipPaywall:eA,addButtonPressed:e=>{if(!A)return;if(("CONDITIONAL"===e.connectionType||"SET_VARIABLE"===e.connectionType||"SET_VARIABLE_MODE"===e.connectionType)&&F){U();return}"SET_VARIABLE_MODE"===e.connectionType&&(e.targetVariableSetID=eg,e.targetVariableModeID=e_),"SET_VARIABLE"===e.connectionType&&eu&&(eu.current=!0),S&&"CONDITIONAL"===e.connectionType&&ey(!0);let t=!1;var n=null,a=S&&!k&&!eA&&A[0].actions&&1===A[0].actions.length;if(k||eA)for(var o=0;o<A.length;o++){let t=A[o];t.actions=[e];let n=t.id,a=t.sourceNodeID;(0,rR.uU)(t.stateManagementVersion)&&n&&a&&c5.zZ.recordInteractionUpgraded(n,a),t.stateManagementVersion=1}else for(var o=0;o<A.length;o++){let a=A[o];if(a.actions){if((0,rR.uU)(a.stateManagementVersion)&&(a.id&&a.sourceNodeID&&c5.zZ.recordInteractionUpgraded(a.id,a.sourceNodeID),a.actions?.forEach(e=>{e.transitionResetScrollPosition=!e.transitionPreserveScroll})),N){if(I.isConditional()){let n=I.path[0],o=I.path[1],r=I.path[2],l=a.actions?.[n],i=l.conditionalActions?.[o].actions?.length??0;n===a.actions.length-1&&r===i-1&&(t=!0),l.conditionalActions?.[o].actions?.splice(r+1,0,e)}else{let n=I.path[0]+1;n===a.actions.length&&(t=!0),a.actions?.splice(n,0,e)}}else a.actions?.push(e);ek=a.id?a.id:oX.Hr}else a.actions=[e],ek=a.id?a.id:oX.Hr;if(a.stateManagementVersion=1,N){let e=[...I.path];e[e.length-1]+=1,n=new cA.Op([...e])}else n=new cA.Op([a.actions.length-1])}let r=w.map(e=>A.find(t=>t.id===e.id)??e);if(tG.Y5.updateSelectionProperties({prototypeInteractions:r}),a||N){var l=[];r[0].actions?.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&l.push(new cA.Op([t]))}),H(l)}es&&(!N||t)&&es(!0),ed&&ed(n),p((0,oQ._P)({name:"Prototype add action",params:{action:e.connectionType?e.connectionType:"NONE",source:"panel",connector_id:(0,oX.dI)(ek),page_id:eh}}))},renderButton:!0,recordingKey:rR.dJ,isNestedInConditional:N&&I.isConditional()}),eO=A.some(e=>void 0!==e.actions&&e.actions?.length>1),ex=!I.isConditional()&&!eO,eD=o.createElement(a9.K,{onClick:()=>eS(I),"aria-label":(0,_.t)("proto.prototype_panel.delete"),disabled:ex,recordingKey:tD.Pt(rR.dJ,"actionDeleteButton"),htmlAttributes:{"data-tooltip":(0,_.t)("proto.prototype_panel.delete"),"data-tooltip-type":t2.Ib.TEXT}},o.createElement(t1.U,{svg:df.A},o.createElement(rg.O,null))),eR=o.createElement("div",{className:"prototype_interaction_edit_modal--ui3FooterContainer--oYsXM"},ew," ",eD),eM=o.createElement(sB.c.Provider,{value:sB.P.LEFT},o.createElement("div",{className:N?"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeftResizable--16pLu":"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeft--UYWSG",ref:$,style:N?{width:`${d0(B).leftWidthPct}%`}:void 0},o.createElement(dL,{category:e,recordingKey:rR.dJ,headerButtons:o.createElement(o.Fragment,null)}),o.createElement("div",{className:dU}),eb,o.createElement("div",{className:dU}),o.createElement(o.Fragment,null,eR))),eL=O.length>0?o.createElement(sB.c.Provider,{value:sB.P.RIGHT},o.createElement(sN.P,{allowScrollAndZoomOver:!0,"data-not-draggable":!0,className:N?"prototype_interaction_edit_modal--ui3ScrollContainerRight--LJr-n":void 0},o.createElement(d8,{selectedActionIndex:M,handleExpandUI3:(e,t)=>{!t&&O.length>1?H(W.filter(t=>!t.equals(e))):W.find(t=>t.equals(e))||H([...W,new cA.Op(e)])},autoOpenVariablePicker:eu,autoOpenExpressionBuilder:eE,setAutoOpenExpressionBuilder:ey}))):null,eV=o.useRef(dj),[,eK]=(0,sS.i)({disabled:!N,onDragStart(){$.current&&(eV.current=$.current.getBoundingClientRect().width)},onDrag(e){if($.current&&eV.current){let t=d0(B),n=eV.current+e.delta.x,o=n/t.width*100;n<dj?o=dj/t.width*100:o>dZ&&(o=dZ),$.current.style.width=`${o}%`,a={...t,leftWidthPct:o}}}}),eF=N?o.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColPanelContainer--e8MK8"},o.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColInnerContainer--ZvJj2"},eM,o.createElement("div",{className:"prototype_interaction_edit_modal--dividerVertical--Noi1C"},o.createElement("div",{...eK({className:"prototype_interaction_edit_modal--verticalResizeHandle--xkc8V"})})),eL),B&&o.createElement(dz,{transition:G,recordingKey:tD.Pt(rR.dJ,"stateManagementVersionPanel"),updateSelectionProperties:R,stateManagementVersion:z,selectedInteractions:A})):eb;return o.createElement(sP.ht.Provider,{value:o.useMemo(()=>({autoCloseOnScroll:!f}),[f])},o.createElement(tX.vL,{name:"Prototype Draggable modal",className:"prototype_interaction_edit_modal--prototypeDraggableModal--njJ6A",handleClipboard:em},o.createElement(or.vx,{ref:g,dataTestId:"in-context-prototype-interaction-edit-modal",title:t=>o.createElement("div",{className:"prototype_interaction_edit_modal--onboardingRow--UlvE0"},o.createElement(d4,{category:e,recordingKey:rR.dJ,createActionTrigger:ew,closeButton:t})),containerClassName:t4()({[dV]:!N,[dK]:N,[dF]:T,"prototype_interaction_edit_modal--abovePropertiesPanel--hFejC":et,"prototype_interaction_edit_modal--belowPropertiesPanel--f1Jfl":!et,"prototype_interaction_edit_modal--modalExpandedWidth--IDl6k":t&&!S,"prototype_interaction_edit_modal--modalWidth--cCH7B":!t&&!S,"prototype_interaction_edit_modal--hideModal--RSp-R":X}),contentContainerClassName:t4()({[dV]:!N,[dK]:N,[dF]:T}),headerClassName:"prototype_interaction_edit_modal--multilineInteractionDetailsHeader--OE8Wr",allowWheelPassthrough:!0,initialPosition:er,headerSize:"small",onClose:dq,recordingKey:"interactionDetailsModal",arrowPosition:c?void 0:or.F_.TOP,arrowRelativeX:c?void 0:Z/2,onDragStart:()=>{en(!0),eo()},canRenderBelowViewport:!0,allowAutoExpanding:!0,dragHeaderOnly:!0,onFocus:()=>v(!0),allowResizeHeight:N,allowResizeWidth:N,fullFrame:N,minWidth:N?440:void 0,minHeight:N?B?369:320:void 0,maxWidth:N?800:void 0,maxHeight:N?800:void 0,initialHeight:N?d0(B).height-or.uF:void 0,initialWidth:N?d0(B).width:void 0,onResize:N?e=>{a={...d0(B),height:e.height,width:e.width}}:void 0},S?eF:eb)))});function d8({selectedActionIndex:e,autoOpenVariablePicker:t,handleExpandUI3:n,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:r}){let l=(0,rL.HS)(),{selectedInteractions:i,mergedActions:s,makeUpdateSelectionPropertiesForActionIndex:c,makeUpdateMultipleDestinationNodesForActionIndex:d,detailPropsMultipleActions:p}=(0,rL.Ay)(l),m=e.path[0],u=d(m),E=c(m),y=(0,rR.iC)(i),_=p.interactionEvent.interactionType??"NONE";if(e.isConditional()){let n=e.path[1],l=e.path[2],c=s[m],d=((0,tb.hS)(c.conditionalActions)&&c.conditionalActions?c.conditionalActions:[])[n],p=d?.actions?.[l];return p?o.createElement("div",{className:dB},o.createElement(db,{key:l,updateMultipleDestinationNodes:u.appendActionIndex(n).appendActionIndex(l),action:p,recordingKey:tD.Pt(rR.dJ,rR.Qe,rR.eG,m),updateSelectionProperties:E.appendActionIndex(n).appendActionIndex(l),onDeleteAction:rS.lQ,interactionType:_,actionIndexPath:e.path,numActions:s.length,isNestedInConditional:!0,stateManagementVersion:y,selectedInteractions:i,onDrop:rS.lQ,onSelect:rS.lQ,onExpand:rS.lQ,selectedActionIndex:e,expandedRows:[e],autoOpenVariablePicker:t,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:r,isNarrowPanel:!0})):null}return o.createElement("div",{className:dB},o.createElement(db,{key:m,updateMultipleDestinationNodes:u,action:s[m],recordingKey:tD.Pt(rR.dJ,rR.Qe,rR.eG,m),updateSelectionProperties:E,onDeleteAction:rS.lQ,interactionType:_,actionIndexPath:[m],numActions:s.length,isNestedInConditional:!1,stateManagementVersion:y,selectedInteractions:i,onDrop:rS.lQ,onSelect:rS.lQ,onExpand:n,selectedActionIndex:e,autoOpenVariablePicker:t,expandedRows:[e],autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:r,isNarrowPanel:!0}))}function d4({category:e,recordingKey:t,closeButton:n,createActionTrigger:a}){let l=(0,r.wA)(),{selectedInteractions:c}=(0,rL.Ay)(e),d=(0,rR.YT)(),p=d===rR.Oz.TWO_COL,m=d===rR.Oz.SINGLE_COL,u=(()=>{if(1!==c.length)return 0;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id};return i.X3B.getMatchingInteractions(rf.d(t)).length})(),E=(0,s.kc)().prototype_hide_matching_noodles&&1===c.length&&u>1&&o.createElement(a9.K,{actionOnPointerDown:!0,onClick:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(rf.d(t));i.glU.selectInteractionsAndSourceNodes(n);let a=(0,_.t)("proto.interaction_details.visual_bell.selected_n_matching_interactions",{total_num_interactions:n.length});tG.Y5.showVisualBellWithUndo("selected-matching-noodles",a,!1),l((0,oQ._P)({name:"prototype_select_matching_interactions",params:{num_connectors:n.length}}))},"aria-label":(0,_.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:u}),htmlAttributes:{tabIndex:-1,onMouseEnter:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(rf.d(t));i.glU.hoverInteractions(n)},onMouseLeave:()=>i.glU.hoverInteractions([]),"data-tooltip":(0,_.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:u}),"data-tooltip-type":t2.Ib.TEXT}},o.createElement(t1.U,{svg:dJ.A},o.createElement(sb.A,null))),y=o.createElement(dL,{category:e,recordingKey:t,headerButtons:o.createElement(o.Fragment,null,E,a,n)}),g=o.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeader--Ka7aM"},(0,_.tx)("proto.interaction_details.header"),o.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeaderButtons--UqykU"},E,n)),h=o.createElement(o.Fragment,null,(0,_.tx)("proto.interaction_details.header"),o.createElement("div",{className:"prototype_interaction_edit_modal--ui3CollapsedModalHeaderButtons--7yPuD"},E,a,n));return p?g:m?h:y}let d3=e=>e.pickerShown?.id===oj.o$?e.pickerShown:null;var d5=n(671350),d7=n(229831),d6=n(889185),d9=n(304657),pe=n(625693),pt=n(347240),pn=n(509734),pa=n(82963),po=n(606319),pr=n(506599),pl=n(433861),pi=n(593392);let ps="offscreen_indicators--indicatorGraphicBlue---nYr-",pc="offscreen_indicators--indicatorGraphicPurple--FAz-M",pd=(0,np.jz)(t7.J4v),pp=(0,np.jz)(t7.v5y),pm=(0,np.jz)(t7.M$q),pu=(0,np.jz)(t7.y9S);function pE(){let e=[],t=(0,lI.kl)("selectionRegions"),n=(0,tb.E7)(t);n&&(e=n);let a=(0,r.d4)(e=>e.mirror.appModel.hoveredNode);if(a&&(0,s.kc)().ce_offscreen_indicators_for_hovered_nodes){let t=eU.q.instance.get(a);if(t){let n=t.absoluteBoundingBox;e=[...e,{bounds:{height:n.h,width:n.w,x:n.x,y:n.y},regionType:t.isPrimaryInstance||t.isInstanceSublayer||t.isSymbolSublayer||t.isSymbolPublishable?rC.fV.SYMBOLS_ONLY:rC.fV.MIXED_OR_NO_SYMBOLS}]}}let l=!!e&&e.length>=1,i=(0,sI._X)({subscribeToUpdates_expensive:l});return i&&e?o.createElement(py,{viewportInfo:i,regions:e}):null}function py({viewportInfo:e,regions:t}){let n=(0,o.useContext)(pl.kw),a=(0,o.useMemo)(()=>n.getCommentsWrapperOffset(e),[n,e]),l=a.x,i=a.y,s={transform:`translate(${l}px, ${i}px)`},c=(0,j.GS)(),d=(0,ta.b)(),p=c&&!d,m=(0,r.d4)(e=>e.mirror?.appModel.showUi),u=(0,to.dP)()+(p?pm:pd),E=(0,to.qw)()+u+(p?pm:pp),y=(0,sa.Ye)(),{isPropertiesPanelCollapsed:_}=(0,pr.iT)(),g=(p&&m&&!y?u:0)-3.5,h=(p&&m&&!_?E:0)-7,v=(0,A.J2)((0,to.UK)().renderRulers)&&m?pu:0,f={x:g+v,y:-3.5+v,width:e.width-h-v,height:e.height- -7-v},S={x:g+v,y:-3.5+v,width:e.width-h-v,height:e.height- -7-v};return o.createElement(o.Fragment,null,o.createElement(pi.p,null,o.createElement("div",{"aria-hidden":!0,"data-forward-events-to-fullscreen":!0,className:"offscreen_indicators--overlay--pNOlw",style:s},!!t?.length&&o.createElement("div",null,t.map((t,n)=>{let a=(0,sI.Z0)(e,{x:t.bounds.x,y:t.bounds.y}),r=(0,sI.Z0)(e,{x:t.bounds.x+t.bounds.width,y:t.bounds.y+t.bounds.height}),l={x:a.x,y:a.y,width:r.x-a.x,height:r.y-a.y};return l.x<f.x+f.width&&l.x+l.width>f.x&&l.y+l.height>f.y&&l.y<f.y+f.height?null:o.createElement(p_,{key:n,viewportBounds:S,viewportInfo:e,indicatorViewportBounds:l,selectionBoundsScaledWidth:function(e,t){let n=Math.max(e.x,t.x);return Math.max(Math.min(e.x+e.width,t.x+t.width)-n,10)}(l,S),selectionBoundsScaledHeight:function(e,t){let n=Math.max(e.y,t.y);return Math.max(Math.min(e.y+e.height,t.y+t.height)-n,10)}(l,S),selectionRegionType:t.regionType})})))))}function p_({viewportBounds:e,viewportInfo:t,indicatorViewportBounds:n,selectionBoundsScaledWidth:a,selectionBoundsScaledHeight:l,selectionRegionType:i}){let s=function(e,t){let n=0-t.x,a=0+e.width-t.x,o=0-t.y,r=0+e.height-t.y,l=Math.abs(n)<a?n:a,i=Math.abs(o)<r?o:r,s=n<0!=a<0,c=o<0!=r<0;return s&&c?Math.abs(l)<Math.abs(i)?{x:t.x+l,y:t.y}:{x:t.x,y:t.y+i}:!s&&c?{x:t.x+l,y:t.y}:s&&!c?{x:t.x,y:t.y+i}:{x:t.x+l,y:t.y+i}}(t,{x:n.x+n.width/2,y:n.y+n.height/2});s.x-=a/2,s.y-=l/2;let c=(0,r.d4)(e=>e.mirror?.appModel.showUi),d=(0,A.J2)((0,to.UK)().renderRulers)&&c?pu:0,p=(0,j.GS)(),m=(0,ta.b)(),u=p&&!m,E=u?pm:pd,y=u?pm:pp,_=(0,to.dP)()+E,g=(0,to.qw)()+y,h=(0,sa.Ye)(),{isPropertiesPanelCollapsed:v}=(0,pr.iT)(),f=1+(c&&u&&!h?_+1:0)+d,S=Math.max(f,t.width-1-a-(c&&u&&!v?g+1:0)),b=1+d,T=Math.max(b,t.height-1-l-1),N=ob.Mi.bound(s,{min:{x:f,y:b},max:{x:S,y:T}}),I=n.y+n.height<e.y,P=n.y>e.y+e.height,C=n.x+n.width<e.x,k=n.x>e.x+e.width;N.x+=t.x,N.y+=t.y;let w=Math.min(t.width-2-(c&&u?g+_:0),a),O=Math.min(t.height-2,l);return o.createElement("div",{className:"offscreen_indicators--indicator---T9xk",style:{transform:`translate3D(${N.x}px, ${N.y}px, 0)`}},(I||P)&&o.createElement("div",{style:{position:"absolute",height:1.5,width:w,marginTop:P?O-1.5:0},className:t4()({[ps]:i===rC.fV.MIXED_OR_NO_SYMBOLS,[pc]:i===rC.fV.SYMBOLS_ONLY})}),(C||k)&&o.createElement("div",{style:{position:"absolute",left:0,height:O,width:1.5,marginLeft:k?w-1.5:0},className:t4()({[ps]:i===rC.fV.MIXED_OR_NO_SYMBOLS,[pc]:i===rC.fV.SYMBOLS_ONLY})}))}var pg=n(109176);let ph=o.memo(({shouldShowDragAndDropBorder:e})=>{let t=(0,C.p8)("isReadOnly"),n=(0,r.d4)(e=>e.progressBarState),a=(0,C.p8)("loadingEmbeds"),m=(0,A.ut)(i.Ez5?.uiState().showCanvasSearch,!1),u=(0,H.Lk)(),E=(0,o.useRef)(null),y=(0,r.d4)(e=>e.userFlags),_=!!(0,s.kc)().internal_only_debug_tools||!!y.has_cursor_bot_onboarding_v2,g=(0,r.d4)(e=>e.openFile),h=g?g.key:"",v=(0,r.d4)(e=>e.universalInsertModal),f=(0,r.wA)();(0,V.Gb)(h),(0,W.W)(),function(){let e=o.useRef(document.activeElement),t=(0,G.j)("Focus changed"),n=o.useCallback(()=>{let n=document.activeElement;n!==e.current&&(t({previousActiveElement:z(e.current?.outerHTML||""),newActiveElement:z(n?.outerHTML||"")}),e.current=n)},[t]);o.useEffect(()=>{if((0,s.kc)().eu_focus_logging)return document.addEventListener("focusin",n),()=>{document.removeEventListener("focusin",n)}},[n])}(),function(){let e=(0,az.VW)(),t=(0,tO.ZC)(e?.guid),n=(0,C.p8)("activeUserAction");o.useEffect(()=>{(0,s.kc)().fragment_search_selection_suggest&&[i.QOV.DEFAULT,i.QOV.CLICKING_TO_CHANGE_SELECTION].includes(n)&&e?.guid!==t&&e&&(e.hasEnabledAnimatedPaint||e.isTopLevelFrame()||e.fills.some(e=>"IMAGE"===e.type))?(0,rz.iP)(rU.JT.FIND_INSPIRATION):e?.guid===t&&[i.QOV.DEFAULT,i.QOV.CLICKING_TO_CHANGE_SELECTION].includes(n)||(0,rz.KY)({actionToClear:rU.JT.FIND_INSPIRATION})},[e,n,t])}();let S=(0,B.BI)(),b=(0,L.l7)(),T=b?o.createElement(c.tH,{boundaryKey:"DevModeLeftPanel",fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING,sentryTags:{area:l.eBU.DEVELOPER_TOOLS}},o.createElement(p.O,null)):o.createElement(sr,null);return o.createElement(e6,null,o.createElement(K.ED,null),o.createElement(l5.sk,null,n.mode!==i.Oin.OFF&&o.createElement("div",{className:pg._q}),o.createElement(e1.pO,{initialFilterState:{currentPage:!1}},a.map(e=>o.createElement(e3._,{key:`loading-embed-${e}`,nodeId:e})),o.createElement(l7.qn,null),o.createElement(pa.u,null),m&&o.createElement(sd.n,null),(0,s.kc)().ce_al_experiments_on&&o.createElement(sd.n,null),o.createElement(e4.GR,null),o.createElement(e4.bu,null),o.createElement(d7.J,null),o.createElement(l7.XI,{commentsDetailContainerRef:E}),o.createElement(pE,null),(0,s.kc)().cursor_bot&&_&&o.createElement(ss.S,null),o.createElement(iv,null),o.createElement(e2.J,null),o.createElement(si.Nz,null),o.createElement("div",{ref:E}),!(0,U.T)()&&T,!t&&o.createElement(d1,null),o.createElement(e8.G,null,b?null:o.createElement(o.Fragment,null,o.createElement(pv,null),!!S?.shouldOptimizeForIpadApp&&o.createElement(pt.K,null),!!S?.shouldOptimizeForIpadApp&&o.createElement(pn.t,null))),e&&o.createElement(si.X5,null)),o.createElement($.A,{isFigjamEditor:!1,isDesignEditor:!0,isSlidesEditor:!1,openFile:g}),o.createElement(d5.l,{defaultViewTabsAvailable:!0,defaultViewAssetsTabVisible:!0}),v.showing&&o.createElement(c.tH,{boundaryKey:"FdBrowseResourceModal",onError:()=>{f(d.F.enqueue({message:"Unable to open inserts menu",type:"react-error"}))},fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING},o.createElement(d9.k,null))),u&&o.createElement(sc.K,{className:pg.PA},o.createElement(pe.s,null)))}),pv=o.memo(function(){let e=(0,r.d4)(e=>e.mirror.appModel),t=(0,C.ax)(),{topLevelMode:n}=e,a=(0,C.dH)();return(0,Y.z)({topLevelMode:i.lyf.PREVIEW,eventName:"Preview Mode Selection Changed",teamFilesOnly:!0}),o.useEffect(()=>{t&&n===i.lyf.PREVIEW&&a!==i.NLJ.COMMENTS&&(0,F.NT)(i.FAf.INSPECT)},[t,n,a]),o.createElement(o.Fragment,null,o.createElement(l3,null),o.createElement(pf,null))}),pf=o.memo(function(){return o.createElement(o.Fragment,null,o.createElement(X.p,null,o.createElement(Q.L,null)),o.createElement(X.p,{featureFlag:"starting_points_modal"},o.createElement(eF,null)),o.createElement(X.p,null,o.createElement(M,null)),o.createElement(X.p,null,o.createElement(d6.e,null)),o.createElement(X.p,null,o.createElement(eX,null)),o.createElement(X.p,null,o.createElement(e0,null)),o.createElement(X.p,{featureFlag:"mobile_prompt_sidebar_modal"},o.createElement(sv,null)),o.createElement(X.p,null,o.createElement(ei,null)),o.createElement(X.p,null,o.createElement(m.S,null)))});function pS(){let[e,t]=(0,o.useState)(!1);return o.createElement(e5.c,{loadedCommentsProvider:!1},o.createElement(po.v,{setShouldShowDragAndDropBorder:t,isDragTarget:!1},o.createElement(ph,{shouldShowDragAndDropBorder:e})))}},511787:(e,t,n)=>{n.d(t,{f:()=>y});var a=n(411855),o=n(153234),r=n(572206),l=n(268537),i=n(163023),s=n(318812),c=n(298543),d=n(983092),p=n(820396),m=n(1715),u=n(590685),E=n(501191);function y({resolvedTypes:e,recordingKey:t}){let{showing:n,toggle:l,hide:p}=(0,s.BK)("expression-builder-create-variable"),m=a.useRef(null),y=o.rf(o.Pt(t,"createVariableDropdown"),"click",a.useCallback(()=>{1===e.length?f(e[0]):l()},[e,l])),[g,h]=a.useState(!1),v=a.useRef(null),f=e=>{let t=m.current?.getBoundingClientRect();t&&(v.current={initialPosition:new r.Mi(t.left,t.top),resolvedType:e},h(!0))},S=()=>{h(!1)};return a.createElement(a.Fragment,null,a.createElement("button",{ref:m,className:u.ZS,onClick:y},a.createElement(i.B,{svg:E.A})),g&&(g&&v.current?a.createElement(d.IU,{initialPosition:v.current.initialPosition,resolvedType:v.current.resolvedType,onCreateVariable:S,onClose:S}):null),n&&m.current&&a.createElement(c.Cf,{arrowOffsetFromRectLeft:14,leanPadding:0,lean:"right",targetRect:m.current.getBoundingClientRect()},e.map(e=>a.createElement(_,{key:e,resolvedType:e,onClose:p,showCreationModal:f,recordingKey:t}))))}function _({resolvedType:e,onClose:t,showCreationModal:n,recordingKey:r}){let i=(0,m.F)(e),s=o.rf(o.Pt(r,"createVariableOption",i.name),"click",a.useCallback(()=>{n(e),t()},[t,e,n]));return a.createElement(l.c$,{className:u.Fs,onClick:s},a.createElement(p.i,{type:e,showTooltip:!1}),i.name)}}}]);

//# debugId=4452aa52-0f65-5656-86bd-6905d0a6e027

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/1b4b9e0e5b5c15cad01e3d9c8334f0ab409523d8/fullscreen_design-0db59ffb5f9cc5b0.min.js.map